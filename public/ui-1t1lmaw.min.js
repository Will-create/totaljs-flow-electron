/*
Component: j-Animation
Version: 1
Updated: 2023-01-23T09:12:35.000Z
Author: Peter Širka


Component: j-Approve
Version: 1
Updated: 2023-01-23T09:15:01.000Z
Author: Peter Širka


Component: j-Audio
Version: 1
Updated: 2023-01-23T09:21:04.000Z
Author: Peter Širka


Component: j-AutoExec
Version: 1
Updated: 2023-01-23T09:25:01.000Z
Author: Peter Širka


Component: j-AutoFill
Version: 1
Updated: 2023-01-23T09:26:00.000Z
Author: Peter Širka


Component: j-Box
Version: 1
Updated: 2023-02-03T21:15:00.000Z
Author: Peter Širka


Component: j-Checkbox
Version: 1
Updated: 2023-01-31T10:50:00.000Z
Author: Peter Širka


Component: j-Choose
Version: 1
Updated: 2023-01-31T11:08:00.000Z
Author: Peter Širka


Component: j-Clipboard
Version: 1
Updated: 2023-01-23T10:55:00.000Z
Author: Peter Širka


Component: j-ColorPicker
Version: 1
Updated: 2023-01-23T11:00:01.000Z
Author: Denis Granec


Component: j-Configuration
Version: 1
Updated: 2023-01-24T10:55:00.000Z
Author: Peter Širka


Component: j-Console
Version: 1
Updated: 2023-01-24T11:03:00.000Z
Author: Peter Širka


Component: j-DatePicker
Version: 1
Updated: 2023-01-25T10:03:24.000Z
Author: Peter Širka


Component: j-Directory
Version: 1
Updated: 2023-02-28T16:32:00.000Z
Author: Peter Širka


Component: j-Edit
Version: 1
Updated: 2023-01-25T12:11:00.000Z
Author: Peter Širka


Component: j-Empty
Version: 1
Updated: 2023-02-07T18:31:00.000Z
Author: Peter Širka


Component: j-Enter
Version: 1
Updated: 2023-01-25T13:05:01.000Z
Author: Peter Širka


Component: j-Exec
Version: 1
Updated: 2023-02-16T13:56:00.000Z
Author: Peter Širka


Component: j-FileReader
Version: 1
Updated: 2023-01-31T09:10:00.000Z
Author: Peter Širka


Component: j-FileUploader
Version: 1
Updated: 2023-01-27T18:23:00.000Z
Author: Peter Širka


Component: j-FloatingBox
Version: 1
Updated: 2023-02-23T11:32:00.000Z
Author: Peter Širka


Component: j-FloatingInput
Version: 1
Updated: 2023-01-31T09:20:02.000Z
Author: Peter Širka


Component: j-FloatingSearch
Version: 1
Updated: 2023-01-31T09:29:03.000Z
Author: Peter Širka


Component: j-Flow
Version: 1
Updated: 2023-01-31T09:34:01.000Z
Author: Peter Širka


Component: j-Form
Version: 2
Updated: 2023-01-18T11:37:01.000Z
Author: Peter Širka


Component: j-Icons
Version: 1
Updated: 2023-02-24T18:13:05.000Z
Author: Peter Širka


Component: j-Importer
Version: 1
Updated: 2023-01-07T18:16:00.000Z
Author: Peter Širka


Component: j-InlineDatePicker
Version: 1
Updated: 2023-01-31T12:08:00.000Z
Author: Peter Širka


Component: j-Input
Version: 1
Updated: 2023-02-24T17:28:06.000Z
Author: Peter Širka


Component: Intranet CSS
Version: 5
Updated: 2023-01-13T17:13:02.000Z
Author: Peter Širka


Component: j-Intro
Version: 1
Updated: 2023-01-31T12:17:00.000Z
Author: Peter Širka


Component: j-KeyValue
Version: 1
Updated: 2023-01-31T14:18:00.000Z
Author: Peter Širka


Component: j-Layout
Version: 1
Updated: 2023-01-31T14:24:50.000Z
Author: Peter Širka


Component: j-ListForm
Version: 1
Updated: 2023-01-31T15:26:04.000Z
Author: Peter Širka


Component: j-LoadContent
Version: 1
Updated: 2023-01-31T14:50:00.000Z
Author: Peter Širka


Component: j-Loading
Version: 1
Updated: 2023-01-31T14:55:00.000Z
Author: Peter Širka


Component: j-Locale
Version: 1
Updated: 2023-02-09T19:56:00.000Z
Author: Peter Širka


Component: j-Markdown
Version: 1
Updated: 2023-01-31T15:04:00.000Z
Author: Peter Širka


Component: j-Menu
Version: 1
Updated: 2023-01-31T15:51:00.000Z
Author: Peter Širka


Component: j-Message
Version: 1
Updated: 2023-01-31T15:54:01.000Z
Author: Peter Širka


Component: j-MiniForm
Version: 2
Updated: 2023-01-18T11:16:01.000Z
Author: Peter Širka


Component: j-NoScrollbar
Version: 1
Updated: 2023-02-01T08:35:00.000Z
Author: Peter Širka


Component: j-Notify
Version: 1
Updated: 2023-02-01T08:50:00.000Z
Author: Peter Širka


Component: j-NotifyBar
Version: 1
Updated: 2023-02-01T09:02:01.000Z
Author: Peter Širka


Component: j-ObjectTree
Version: 1
Updated: 2023-02-01T09:10:01.000Z
Author: Martin Smola


Component: j-Page
Version: 1
Updated: 2023-02-01T09:23:01.000Z
Author: Peter Širka


Component: j-Part
Version: 1
Updated: 2023-02-01T18:16:03.000Z
Author: Peter Širka


Component: j-Parts
Version: 1
Updated: 2023-02-01T09:46:04.000Z
Author: Peter Širka


Component: j-Paste
Version: 1
Updated: 2023-02-01T09:47:00.000Z
Author: Peter Širka


Component: j-Progress
Version: 1
Updated: 2023-02-01T10:07:00.000Z
Author: Peter Širka


Component: j-Properties2
Version: 1
Updated: 2023-02-01T10:11:01.000Z
Author: Peter Širka


Component: j-Ready
Version: 1
Updated: 2023-02-01T10:38:00.000Z
Author: Peter Širka


Component: j-Search
Version: 1
Updated: 2023-02-01T11:16:02.000Z
Author: Peter Širka


Component: j-SearchInput
Version: 1
Updated: 2023-02-01T11:21:03.000Z
Author: Peter Širka


Component: j-Selected
Version: 1
Updated: 2023-02-01T12:03:00.000Z
Author: Peter Širka


Component: j-Selection
Version: 1
Updated: 2023-02-03T20:40:00.000Z
Author: Peter Širka


Component: j-Shortcuts
Version: 1
Updated: 2023-02-01T12:12:00.000Z
Author: Peter Širka


Component: j-TabMenu
Version: 1
Updated: 2023-01-31T11:35:01.000Z
Author: Peter Širka


Component: Tangular-Counter
Version: 1
Updated: 2021-04-06T10:52:00.000Z
Author: Peter Širka


Component: Tangular-FileSize
Version: 1
Updated: {dateupdated}
Author: Peter Širka


Component: Tangular-JsonFormat
Version: 1
Updated: 2022-04-29T11:29:00.000Z
Author: Peter Širka


Component: j-Textarea
Version: 1
Updated: 2023-01-21T22:27:00.000Z
Author: Peter Širka


Component: j-TextboxList
Version: 1
Updated: 2023-01-21T22:20:00.000Z
Author: Peter Širka


Component: j-TimePicker
Version: 1
Updated: 2023-01-21T22:21:02.000Z
Author: Peter Širka


Component: j-ToggleButton
Version: 1
Updated: 2023-01-21T22:07:01.000Z
Author: Peter Širka


Component: Tooltip
Version: 1
Updated: {dateupdated}
Author: Peter Širka


Component: j-UIBuilder
Version: 1
Updated: 2023-02-08T13:50:05.000Z
Author: Peter Širka


Component: j-Validate
Version: 1
Updated: 2023-01-21T21:48:01.000Z
Author: Peter Širka


Component: j-Validation
Version: 1
Updated: 2023-01-21T21:38:00.000Z
Author: Peter Širka


Component: j-ViewBox
Version: 1
Updated: 2023-01-21T21:38:00.000Z
Author: Peter Širka


Component: j-VirtualWire
Version: 1
Updated: 2022-06-07T19:11:01.000Z
Author: Peter Širka


Component: j-Watcher
Version: 1
Updated: 2023-01-21T21:20:01.000Z
Author: Peter Širka


Component: j-WebSocket
Version: 1
Updated: 2023-01-21T21:17:00.000Z
Author: Peter Širka


Component: j-Windows
Version: 1
Updated: 2023-01-17T22:59:00.000Z
Author: Peter Širka


Component: j-Wysiwyg
Version: 1
Updated: 2023-01-17T22:48:04.000Z
Author: Peter Širka
*/

CSS(`.animation{visibility:hidden}.ui-animation-1-init{transition:all 0.2s;opacity:0}.ui-animation-1-run{opacity:1}.ui-animation-2-init{transition:all 0.2s;transform:scale(1.5)}.ui-animation-2-run{transform:scale(1)}.ui-animation-3-init{transition:all 0.2s;transform:scale(0.5)}.ui-animation-3-run{transform:scale(1)}.ui-animation-4-init{transition:all 0.2s;transform:rotateY(-90deg)}.ui-animation-4-run{transform:rotateY(-1deg)}.ui-animation-5-init{transition:all 0.2s;transform:translate(-100px);opacity:0}.ui-animation-5-run{transform:translate(0);opacity:1}.ui-animation-6-init{transition:all 0.2s;transform:translate(0,-100px);opacity:0}.ui-animation-6-run{transform:translate(0,0);opacity:1}

.ui-approve-noscroll,.ui-approve-noscroll body{overflow:hidden}.ui-approve{background-color:rgba(255,255,255,0.9);position:fixed;left:0;right:0;bottom:0;top:0;z-index:100;width:100%;display:table;height:100%;transition:0.5s all;opacity:0}.ui-approve > div{display:table-cell;vertical-align:middle;text-align:center;color:#FFF;padding:15px}.ui-approve-body{color:#000;padding:0;position:relative;display:inline-block;max-width:300px;text-align:left;transform:scale(0.8);transition:0.15s all;border:0;background-color:#FFF;box-shadow:0 0 30px rgba(0,0,0,0.1)}.ui-approve-content{padding:50px 30px;text-align:center}.ui-approve-content > i{font-size:50px;display:block;margin-bottom:10px}.ui-approve-buttons{height:40px}.ui-approve button{font-size:12px;float:left;cursor:pointer;outline:0;background-color:#E0E0E0;border:0;border-radius:0;color:gray;padding:0;width:50%;height:40px;font-weight:normal;margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ui-approve button i{margin-right:5px}.ui-approve button:hover{opacity:0.9}.ui-approve-close{position:absolute;color:#C0C0C0;font-size:11px;right:8px;top:5px;cursor:pointer}.ui-approve-close:hover{color:#A0A0A0}.ui-approve-visible{opacity:1}.ui-approve-visible .ui-approve-body{-webkit-transform:scale(1);transform:scale(1)}.ui-approve-click{transform:scale(1.07) !important}.ui-dark .ui-approve{background-color:rgba(0,0,0,0.9)}.ui-dark .ui-approve-body{background-color:#202020}.ui-dark .ui-approve-content{border-bottom-color:#303030;color:#FFF}.ui-dark .ui-approve button{background-color:#505050;color:#C0C0C0}.ui-dark .ui-approve-close{color:#505050}.ui-dark .ui-approve-close:hover{color:#888}.ui-approve button[data-index='0']{color:#FFF;font-weight:bold;font-weight:bold;background-color:#EC2C28}@media(max-width:340px){.ui-approve button{display:block;margin:8px 0 0;display:block;width:100%;height:34px;font-size:13px}}

.ui-box-noscroll,.ui-box-noscroll body{overflow:hidden}.ui-box-container{width:100%;position:fixed;left:0;top:0;bottom:0;right:0;z-index:5;overflow:hidden;transform-style:preserve-3d}.ui-box-bg{background-color:rgba(230,233,237,0.8)}.ui-box-nobg .ui-box{border:1px solid #E9E9E9}.ui-box-transparent{pointer-events:none}.ui-box{background-color:#FFF;border-radius:3px;box-shadow:0 10px 30px rgba(0,0,0,0.1);transform:scale(0);transition:all 0.15s;opacity:0;text-align:left;position:relative;margin:0 auto;pointer-events:all}.ui-box-animate{transform:scale(1);opacity:1}.ui-box-title{padding:0 10px 0 var(--gap);line-height:57px;font-size:16px;user-select:none;color:#000;background-color:#FFF;border-bottom:1px solid #E0E0E0;height:58px;border-radius:3px 3px 0 0}.ui-box-title .ui-box-button-close{float:right;cursor:pointer;font-size:18px;margin:1px 0 0;background:none;border:0;outline:0;height:auto;color:red;text-align:right !important;width:20px;padding:0}.ui-box-title .ui-box-button-close i{font-weight:bold}.ui-box-title .ui-box-button-close:hover{transform:scale(1.1)}.ui-box-title > nav{float:right;margin-right:18px;font-size:14px}.ui-box-title > span{font-weight:bold}.ui-box-title > nav button{border:0;margin:15px 0 0;background-color:#F0F0F0;height:28px;padding:0 10px;color:#000;cursor:pointer;font-family:Arial;line-height:23px;vertical-align:middle;outline:0;font-size:12px;text-decoration:none;transition:all 0.3s;float:left;border-left:1px solid #E0E0E0}.ui-box-title > nav button i{width:12px;text-align:center;margin-right:5px}.ui-box-title > nav button:hover{opacity:0.8}.ui-box-title > nav button:active{background-color:#D0D0D0}.ui-box-title > nav button:disabled{background-color:#F5F5F5 !important;border-color:#E0E0E0 !important;color:silver !important;cursor:not-allowed;box-shadow:none}.ui-box-title > nav button:disabled i{color:silver !important}.ui-box-title > nav button:first-child{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius);border-left:0}.ui-box-title > nav button:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-box-title i{margin-right:7px}.ui-box > nav{padding:0 15px 0;border-top:1px solid #E0E0E0;background-color:#FFF;border-radius:0 0 3px 3px;line-height:65px;height:65px;display:block;float:none;width:100%}.ui-box > nav button{border:0;margin:15px 0 0;background-color:#F0F0F0;height:34px;padding:0 20px;color:#000;cursor:pointer;font-family:Arial;line-height:34px;vertical-align:middle;outline:0;font-size:14px;text-decoration:none;transition:all 0.3s;float:left;width:50%}.ui-box > nav button i{width:15px;text-align:center;margin-right:5px}.ui-box > nav button:hover{opacity:0.8}.ui-box > nav button:active{background-color:#D0D0D0}.ui-box > nav button:disabled{background-color:#F5F5F5 !important;border-color:#E0E0E0 !important;color:silver !important;cursor:not-allowed;box-shadow:none}.ui-box > nav button:disabled i{color:silver !important}.ui-box > nav button:first-child{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.ui-box > nav button:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-box > nav button[name='submit']{font-weight:bold;background-color:var(--color);color:#FFF}.ui-box-style-2 .ui-box{border-bottom-right-radius:0;border-bottom-left-radius:0}.ui-box-style-3 .ui-box{border-top-right-radius:0;border-top-left-radius:0}.ui-box-align-left{margin:0 auto 0 0}.ui-box-align-right{margin:0 0 0 auto}.ui-dark .ui-box{background-color:#202020}.ui-dark .ui-box-bg{background-color:rgba(50,50,50,0.9)}.ui-dark .ui-box-nobg .ui-box{border-color:#333}.ui-dark .ui-box-title{background-color:#202020;border-bottom-color:#303030;color:#FFF}.ui-dark .ui-box-title > nav{background-color:#202020;border-top-color:#303030}.ui-dark .ui-box-title > nav button{border-color:#404040;background-color:#505050;color:#E0E0E0}.ui-dark .ui-box-title > nav button:active{background-color:#404040}.ui-dark .ui-box-title > nav button:disabled i{color:#606060 !important}.ui-dark .ui-box-title > nav button:disabled{background-color:#303030 !important;color:#606060 !important;border-color:#202020 !important}.ui-dark .ui-box > nav{background-color:#202020;border-top-color:#303030}.ui-dark .ui-box > nav button{border-color:#202020;background-color:#505050;color:#F0F0F0}.ui-dark .ui-box > nav button[name='submit']{background-color:var(--color)}.ui-dark .ui-box > nav button:active{background-color:#404040}.ui-dark .ui-box > nav button:disabled i{color:#606060 !important}.ui-dark .ui-box > nav button:disabled{background-color:#303030 !important;color:#606060 !important;border-color:#202020 !important}@media(max-width:767px){.ui-box-container{background:none;padding:0 !important}.ui-box{border-radius:0;max-width:none !important;width:100% !important}}

.ui-checkbox{position:relative;font-size:13px;margin-bottom:5px}.ui-checkbox *{height:25px;cursor:pointer}.ui-checkbox span{width:20px;height:20px;line-height:19px;font-size:11px;margin:0 7px 0 0;text-align:center;float:left;border:1px solid #D0D0D0;border-radius:var(--radius);background:#FFF}.ui-checkbox span i{display:none}.ui-checkbox.ui-checkbox-checked span i{display:inline-block}.ui-checkbox label{line-height:19px}.ui-checkbox.ui-disabled *{cursor:not-allowed}.ui-checkbox.ui-disabled{color:#A0A0A0}.ui-checkbox.ui-disabled span{background-color:#F0F0F0;color:#B0B0B0;border-color:#E0E0E0}.ui-dark .ui-checkbox span{border-color:#404040;background:#252525}.ui-dark .ui-checkbox.ui-disabled span{background-color:#282828;color:#999;border-color:#303003}.ui-dark .ui-checkbox.ui-disabled{color:#666}

.ui-clipboard{position:absolute;left:-100px;top:-100px;height:1px;width:1px}

.ui-colorpicker-container{position:absolute;z-index:109}.ui-colorpicker{border:1px solid #E0E0E0;font-size:14px;color:#000;width:254px;background-color:#FFF;box-shadow:0 5px 10px rgba(0,0,0,0.08);border-radius:var(--radius);overflow:hidden;margin:0;padding:7px 0 3px}.ui-colorpicker-body{text-align:center}.ui-colorpicker-body div:nth-child(1){margin-bottom:0}.ui-colorpicker-body div:nth-child(2){margin-bottom:8px;padding-bottom:2px;border-bottom:1px solid #E0E0E0}.ui-colorpicker-cell{cursor:pointer;width:20px;height:16px;display:inline-block;vertical-align:top}.ui-colorpicker-cell span{display:block;height:16px;margin:0 2px;border-radius:2px;border:1px solid rgba(0,0,0,0.1);font-size:9px;line-height:15px;color:red}.ui-colorpicker-body span:hover{border-color:rgba(0,0,0,0.3)}.ui-dark .ui-colorpicker{background-color:#252525;border-color:#404040}.ui-dark .ui-colorpicker-cell span{border-color:rgba(255,255,255,0.1)}.ui-dark .ui-colorpicker-cell span:hover{border-color:rgba(255,255,255,0.5)}.ui-dark .ui-colorpicker-body div:nth-child(2){border-bottom-color:#404040}

.ui-configuration-group{font-size:16px;font-weight:bold;margin:20px 0 10px;padding:5px 0;border-bottom:2px solid #E0E0E0}.ui-configuration-group i{margin-right:7px}.ui-configuration-group-summary{font-size:12px;color:#777;line-height:15px;margin:5px 0 25px}.ui-configuration-group:first-child{margin-top:0}.ui-configuration-items{margin:0 0 15px 3px;padding-left:20px;border-left:2px solid #F0F0F0}.ui-configuration-items:before{content:' ';width:10px;height:10px;background-color:#F0F0F0;display:block;border-radius:100px;margin:-15px 0 0 -26px}.ui-configuration-items:after{content:' ';width:10px;height:10px;background-color:#F0F0F0;display:block;border-radius:100px;margin:-15px 0 0 -26px}.ui-configuration-button{margin-top:8px}.ui-configuration-button button{font-size:11px;border:1px solid #E0E0E0;border-radius:var(--radius);background-color:#FFF;color:#333;padding:2px 5px;min-width:50px}.ui-configuration-button button:hover{border-color:#D0D0D0}.ui-configuration-button button:disabled{color:#B0B0B0;cursor:not-allowed;border-color:#F0F0F0;background-color:#F8F8F8}.ui-configuration-button i{margin-right:5px}.ui-configuration-item{padding:15px 0 15px;border-bottom:1px solid #E0E0E0}.ui-configuration-monospace{font-family:Menlo, Consolas, monospace}.ui-configuration-item-label{font-size:13px;font-weight:bold}.ui-configuration-item-label i{width:14px;text-align:center;margin-right:5px}.ui-configuration-item-summary{font-size:12px;color:#777;line-height:15px;margin:5px 0}.ui-configuration-item-note{font-size:11px;color:#A0A0A0;line-height:12px;margin:2px 0 0}.ui-configuration-item-control{margin:7px 0}.ui-configuration-noborder{border:0}.ui-configuration-type-string input{border:0;width:100%;height:34px;padding:0 8px;margin:0;outline:0;background-color:transparent;border:1px solid #D0D0D0;border-radius:var(--radius);font-size:12px}.ui-configuration-type-string input:disabled, .ui-configuration-type-number input:disabled{background-color:#F0F0F0;color:#A0A0A0}.ui-configuration-type-multiline textarea{border:0;width:100%;height:34px;padding:8px;margin:0;outline:0;background-color:transparent;border:1px solid #D0D0D0;border-radius:var(--radius);font-size:12px;resize:none;height:100px}.ui-configuration-type-multiline textarea:disabled{background-color:#F0F0F0;color:#A0A0A0}.ui-configuration-type-number input{border:0;width:100%;height:32px;padding:0 8px;margin:0;outline:0;background-color:transparent;border:0;font-size:12px;border-radius:var(--radius)}.ui-configuration-type-number{max-width:200px;width:100%;border-radius:var(--radius);border:1px solid #D0D0D0}.ui-configuration-type-number > div{margin-right:33px}.ui-configuration-type-number > span{float:right;border-left:1px solid #D0D0D0;width:33px;height:32px;text-align:center;padding:4px 0 0}.ui-configuration-type-number > span i{display:block;line-height:12px;cursor:pointer}.ui-configuration-type-number input{text-align:center}.ui-configuration-disabled .ui-configuration-type-number{background-color:#F0F0F0;color:#A0A0A0}.ui-configuration-disabled .ui-configuration-type-number > span i{cursor:not-allowed}.ui-configuration-type-boolean{height:28px;position:relative}.ui-configuration-type-boolean div{width:48px;height:24px;border-radius:100px;float:left;border:1px solid #D0D0D0;margin:0;padding:0;line-height:0;cursor:pointer}.ui-configuration-type-boolean span{border-radius:100px;border:1px solid #D0D0D0;position:absolute;top:0;left:0;height:24px;width:24px;text-align:center;background-color:#F0F0F0;transition:all 0.2s}.ui-configuration-type-boolean i{display:none}.ui-configuration-disabled .ui-configuration-type-boolean div{cursor:not-allowed;background-color:#F0F0F0}.ui-configuration-required .ui-configuration-item-label:before{content:'*';margin-right:5px;color:red}.ui-configuration-checked .ui-configuration-type-boolean div{background-color:var(--color);border-color:var(--color)}.ui-configuration-checked span{left:26px;top:2px;border:0;height:20px;width:20px;line-height:22px;font-size:11px;background-color:#FFF}.ui-configuration-checked i{display:inline-block;color:var(--color)}.ui-configuration-type-color{width:50px;border:1px solid #D0D0D0;border-radius:var(--radius);padding:2px;cursor:pointer}.ui-configuration-type-color div{height:44px;border-radius:var(--radius)}.ui-configuration-disabled .ui-configuration-type-color{cursor:not-allowed}.ui-configuration-type-icon{width:50px;height:50px;border:1px solid #D0D0D0;border-radius:var(--radius);text-align:center;cursor:pointer;line-height:49px;font-size:28px}.ui-configuration-disabled .ui-configuration-type-icon{cursor:not-allowed;color:#A0A0A0}.ui-configuration-type-date{height:28px;position:relative;cursor:pointer;max-width:200px}.ui-configuration-type-date label{position:absolute;font-size:12px;line-height:34px;pointer-events:none;color:#A0A0A0;padding-left:10px}.ui-configuration-type-date div{height:34px;border:1px solid #D0D0D0;margin:0;padding:0;border-radius:var(--radius);font-size:12px;line-height:34px;padding:0 8px;text-align:center}.ui-configuration-type-date span{float:right;width:34px;height:34px;border-left:1px solid #D0D0D0;line-height:34px;text-align:center}.ui-configuration-disabled .ui-configuration-type-date{cursor:not-allowed;color:#A0A0A0}.ui-configuration-disabled .ui-configuration-type-date div{background-color:#F0F0F0}.ui-configuration-type-dropdown{height:28px;position:relative;cursor:pointer}.ui-configuration-type-dropdown label{position:absolute;font-size:12px;line-height:34px;padding:0 10px;pointer-events:none;color:#A0A0A0}.ui-configuration-type-dropdown div{height:34px;border:1px solid #D0D0D0;margin:0;padding:0;border-radius:var(--radius);font-size:12px;line-height:34px;padding:0 8px}.ui-configuration-type-dropdown span{float:right;width:34px;height:34px;border-left:1px solid #D0D0D0;line-height:34px;text-align:center}.ui-configuration-disabled .ui-configuration-type-dropdown{cursor:not-allowed;color:#A0A0A0}.ui-configuration-disabled .ui-configuration-type-dropdown div{background-color:#F0F0F0}.ui-configuration-type-selectable-item{position:relative;display:inline-block;width:80px;height:60px;text-align:center;border:1px solid #D0D0D0;padding:11px 0 0;font-size:11px;margin:5px 5px 0 0;border-radius:var(--radius);cursor:pointer}.ui-configuration-type-selectable-item:hover{background-color:#F8F8F8}.ui-configuration-selected.ui-configuration-type-selectable-item{background-color:var(--color);border-color:var(--color);color:#FFF}.ui-configuration-type-selectable-item i{display:block;font-size:20px;margin-bottom:5px}.ui-configuration-type-selectable-item span{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 5px}.ui-configuration-last{border-bottom:0}.ui-configuration-align-1 input{text-align:center}.ui-configuration-align-2 input{text-align:right}.ui-dark .ui-configuration-group{border-bottom-color:#404040}.ui-dark .ui-configuration-group-summary{color:#777}.ui-dark .ui-configuration-items{border-left-color:#303030}.ui-dark .ui-configuration-items:before{background-color:#303030}.ui-dark .ui-configuration-items:after{background-color:#303030}.ui-dark .ui-configuration-button button{border-color:#404040;background-color:#202020;color:#F0F0F0}.ui-dark .ui-configuration-button button:hover{border-color:#454545}.ui-dark .ui-configuration-button button:disabled{color:#777;border-color:#303030;background-color:#383838}.ui-dark .ui-configuration-item{border-bottom-color:#404040}.ui-dark .ui-configuration-item-summary{color:#777}.ui-dark .ui-configuration-item-note{color:#666}.ui-dark .ui-configuration-type-string input{background-color:transparent;border-color:#404040}.ui-dark .ui-configuration-type-string input:disabled, .ui-dark .ui-configuration-type-number input:disabled{background-color:#303030;color:#666}.ui-dark .ui-configuration-type-multiline textarea{background-color:transparent;border-color:#404040}.ui-dark .ui-configuration-type-multiline textarea:disabled{background-color:#303030;color:#666}.ui-dark .ui-configuration-type-number input{background-color:transparent}.ui-dark .ui-configuration-type-number{border-color:#404040}.ui-dark .ui-configuration-type-number > span{border-left-color:#404040}.ui-dark .ui-configuration-disabled .ui-configuration-type-number{background-color:#303030;color:#666}.ui-dark .ui-configuration-type-boolean div{border-color:#404040}.ui-dark .ui-configuration-type-boolean span{border-color:#404040;background-color:#303030}.ui-dark .ui-configuration-disabled .ui-configuration-type-boolean div{background-color:#303030}.ui-dark .ui-configuration-required .ui-configuration-item-label:before{color:red}.ui-dark .ui-configuration-checked .ui-configuration-type-boolean div{background-color:var(--color);border-color:var(--color)}.ui-dark .ui-configuration-checked span{background-color:#FFF}.ui-dark .ui-configuration-checked i{color:var(--color)}.ui-dark .ui-configuration-type-color{border-color:#404040}.ui-dark .ui-configuration-type-icon{border-color:#404040}.ui-dark .ui-configuration-disabled .ui-configuration-type-icon{color:#666}.ui-dark .ui-configuration-type-date label{color:#666}.ui-dark .ui-configuration-type-date div{border-color:#404040}.ui-dark .ui-configuration-type-date span{border-left-color:#404040}.ui-dark .ui-configuration-disabled .ui-configuration-type-date{color:#666}.ui-dark .ui-configuration-disabled .ui-configuration-type-date div{background-color:#303030}.ui-dark .ui-configuration-type-dropdown label{color:#666}.ui-dark .ui-configuration-type-dropdown div{border-color:#404040}.ui-dark .ui-configuration-type-dropdown span{border-left-color:#404040}.ui-dark .ui-configuration-disabled .ui-configuration-type-dropdown{color:#666}.ui-dark .ui-configuration-disabled .ui-configuration-type-dropdown div{background-color:#303030}.ui-dark .ui-configuration-type-selectable-item{border-color:#404040}.ui-dark .ui-configuration-type-selectable-item:hover{background-color:#383838}.ui-dark .ui-configuration-selected.ui-configuration-type-selectable-item{background-color:var(--color);border-color:var(--color);color:#FFF}

.ui-console{position:fixed;left:0;right:0;bottom:0;transition:all 0.15s;transform:translate(0,150px);height:150px;z-index:32;border:5px solid rgba(100,100,100,0.1);border-bottom:0}.ui-console-visible{transform:translate(0,0)}.ui-console-tabs{height:26px;padding:0;background-color:rgba(230,230,230,0.8)}.ui-console-tabs span{float:left;min-width:24px;height:26px;line-height:26px;text-align:center;cursor:pointer;color:gray;font-size:12px;padding:0 7px}.ui-console-tabs span i{margin-right:5px}.ui-console-tabs > div{float:left}.ui-console-tabs span:hover{color:#000}.ui-console-selected{background-color:#FFF;color:#000 !important}.ui-console-output{height:120px;background-color:#FFF;overflow:auto;overflow-scrolling:touch}.ui-console-tabs > .ui-console-close{color:red !important;float:right;border-right:0}.ui-console-message{height:24px;font-size:12px;border-bottom:1px solid #F0F0F0;line-height:24px;padding:0 5px 0 6px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:30px}.ui-console-message i{width:12px;margin-right:7px;text-align:center}.ui-console-error{color:red}.ui-console-warning{color:#E8A826}.ui-console-success{color:#8CC152}.ui-console-info{color:#3BAFDA}.ui-console-body{overflow:hidden}.ui-dark .ui-console{border:5px solid rgba(0,0,0,0.8)}.ui-dark .ui-console-tabs{height:26px;padding:0;background-color:rgba(0,0,0,0.8)}.ui-dark .ui-console-output{background-color:#222}.ui-dark .ui-console-selected{background-color:#222;color:#FFF !important}.ui-dark .ui-console-message{border-bottom-color:#303030}.ui-dark .ui-console-tabs span:hover{color:#FFF}

.ui-datepicker-container{position:absolute;left:0;right:0;bottom:0;top:0;z-index:99}.ui-datepicker{font-size:12px;width:247px;height:300px;position:absolute;background-color:#FFF;border:1px solid #E0E0E0;left:100px;top:100px;border-radius:var(--radius);z-index:100;color:gray;box-shadow:0 5px 25px rgba(0,0,0,0.1);opacity:0;transform:scale(0.6);transition:all 0.2s}.ui-datepicker-visible{transform:scale(1);opacity:1}.ui-datepicker-disabled{color:silver !important;cursor:pointer}.ui-datepicker-body,.ui-datepicker-months,.ui-datepicker-years{height:235px}.ui-datepicker-footer{height:28px;border-top:1px solid #E0E0E0;font-size:11px;padding:0 8px;line-height:26px;background-color:#F8F8F8;display:flex;justify-content:space-between}.ui-datepicker-footer > span:hover{text-decoration:underline}.ui-datepicker-now,.ui-datepicker-clear{color:#000;cursor:pointer}.ui-datepicker-today div{background-color:#F0F0F0;font-weight:bold}.ui-datepicker-selected div{background-color:#F8F7DA;font-weight:bold;color:#000}.ui-datepicker-date i{position:absolute;left:15px;top:26px;font-size:6px;color:red}.ui-datepicker-months > div{width:61px;height:78px;line-height:76px;position:relative;display:inline-block;text-align:center;cursor:pointer;text-transform:uppercase;font-weight:bold}.ui-datepicker-months > div > div{width:50px;height:50px;line-height:46px;position:relative;display:inline-block;border-radius:100%;border:2px solid transparent}.ui-datepicker-months > div:hover > div{border-color:#E0E0E0;color:#000}.ui-datepicker-years{padding:5px 0 0}.ui-datepicker-years > div{width:49px;height:46px;line-height:44px;position:relative;display:inline-block;text-align:center;cursor:pointer}.ui-datepicker-years > div > div{width:40px;height:40px;line-height:36px;position:relative;display:inline-block;border-radius:100%;border:2px solid transparent}.ui-datepicker-years > div:hover > div{border-color:#E0E0E0;color:#000}.ui-datepicker-header{height:35px;border-bottom:1px solid #E0E0E0;text-align:center;font-size:14px}.ui-datepicker-prev{float:left;line-height:34px;width:34px;color:#000;cursor:pointer}.ui-datepicker-next{float:right;line-height:34px;width:34px;color:#000;cursor:pointer}.ui-datepicker-prev:hover,.ui-datepicker-next:hover{background-color:#F0F0F0}.ui-datepicker-info{margin:0 34px;line-height:34px}.ui-datepicker-info > span{cursor:pointer}.ui-datepicker-info > span:hover{color:#000}.ui-datepicker-info .ui-datepicker-year{margin-left:5px}.ui-datepicker-week > div,.ui-datepicker-days > div{width:35px;height:35px;line-height:35px;position:relative;display:inline-block;vertical-align:middle;text-align:center}.ui-datepicker-week > div{height:25px;line-height:25px;font-weight:bold;color:#000;border-bottom:1px solid #E0E0E0}.ui-datepicker-days > div{font-size:11px;cursor:pointer}.ui-datepicker-date:hover > div{border-color:#E0E0E0;color:#000}.ui-datepicker-days > div > div{width:28px;height:28px;line-height:24px;border-radius:100%;margin:0 auto;position:relative;display:inline-block;border:2px solid transparent}.ui-dark .ui-datepicker{background-color:#282828;border-color:#404040;color:gray}.ui-dark .ui-datepicker-disabled{color:#505050 !important}.ui-dark .ui-datepicker-footer{border-top-color:#404040;background-color:#303030}.ui-dark .ui-datepicker-now .ui-datepicker-clear{color:#FFF}.ui-dark .ui-datepicker-today div{background-color:#353535}.ui-dark .ui-datepicker-selected div{background-color:#505050;color:#FFF}.ui-dark .ui-datepicker-date i{color:red}.ui-dark .ui-datepicker-months > div:hover > div{border-color:#505050;color:#FFF}.ui-dark .ui-datepicker-years > div:hover > div{border-color:#505050;color:#FFF}.ui-dark .ui-datepicker-header{border-bottom-color:#404040}.ui-dark .ui-datepicker-prev{color:#FFF}.ui-dark .ui-datepicker-next{color:#FFF}.ui-dark .ui-datepicker-prev:hover,.ui-dark .ui-datepicker-next:hover{background-color:#303030}.ui-dark .ui-datepicker-info > span:hover{color:#FFF}.ui-dark .ui-datepicker-week > div{color:#FFF;border-bottom-color:#404040}.ui-dark .ui-datepicker-date:hover > div{border-color:#505050;color:#FFF}

.ui-directory-area{position:absolute;left:0;top:0;right:0;bottom:0;z-index:99}.ui-directory{position:absolute;opacity:0;transition:0.25s transform cubic-bezier(0.23,1,0.32,1);left:-100;top:-100;z-index:100;box-shadow:0 1px 20px rgba(0,0,0,0.1);background-color:#FFF;border-radius:var(--radius);border:1px solid #E0E0E0;overflow:hidden;transition:all 0.2s}.ui-directory-search{height:42px;background:#FFF;border-radius:var(--radius) var(--radius) 0 0;border-bottom:1px solid #E0E0E0;line-height:26px}.ui-directory-search input{width:100%;background-color:#FFF;border:0;font-size:14px;outline:0;padding:0;margin:0;line-height:28px;outline:0}.ui-directory-search > div{margin:0 22px 0 35px;padding:6px 10px 0 0;line-height:24px}.ui-directory-search > span{float:left;width:16px;text-align:center;padding:7px 0 0 12px;font-size:14px}.ui-directory-add{float:right !important;padding-left:0 !important;color:#83c83c;text-align:left !important;font-size:14px !important;cursor:pointer;width:24px !important;font-weight:bold;padding-top:8px}.ui-directory .ui-disabled{color:#A0A0A0 !important;cursor:not-allowed}.ui-directory-search .ti-times{color:red;cursor:pointer}.ui-directory-visible{opacity:1}.ui-directory-container{height:180px;overflow-x:hidden;overflow-y:auto;overflow-scrolling:touch;margin:0 30px 0 0;padding:0}.ui-directory ul{list-style-type:none;margin:0;padding:0}.ui-directory .selected{background-color:#F8F8F8;color:#000}.ui-directory .current{background-color:#F2F2F2;color:#000}.ui-directory-default li{padding:0 40px 0 10px;height:32px;line-height:32px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.ui-directory li{border-bottom:1px solid #F0F0F0;font-size:14px;background-color:#FFF;cursor:pointer;margin:0}.ui-directory-checkbox{width:16px;height:16px;float:left;border:1px solid #D0D0D0;border-radius:var(--radius);font-size:10px;line-height:16px;margin:8px 6px 0 0;text-align:center;background-color:#FFF}.ui-directory-checkbox i{visibility:hidden}.ui-directory .selected .ui-directory-checkbox{background-color:#4285F4;border-color:#4285F4;color:#FFF}.ui-directory .selected .ui-directory-checkbox i{visibility:visible}.ui-directory li:last-child{border-bottom:0}.ui-directory-search-hidden .ui-directory-search{height:0;overflow:hidden;opacity:0}.ui-dark .ui-directory .ui-disabled{color:#666 !important}.ui-dark .ui-directory{background-color:#303030;border-color:#404040;box-shadow:1px 5px 10px rgba(0,0,0,0.2)}.ui-dark .ui-directory-search{background:#303030}.ui-dark .ui-directory li{background-color:#303030;border-color:#404040}.ui-dark .ui-directory-search{border-bottom-color:#404040}.ui-dark .ui-directory-search input{background-color:#303030}.ui-dark .ui-directory-add:hover{color:#FFF}.ui-dark .ui-directory-checkbox{border-color:#484848;background-color:#404040}.ui-dark .ui-directory .selected{background-color:#2D2D2D;color:#FFF}.ui-dark .ui-directory .current{background-color:#373737;color:#FFF}

.ui-edit-window{position:absolute;box-shadow:0 0 10px rgba(0,0,0,0.1);padding:10px;border-radius:var(--radius);width:100px;background-color:#FFF;border:1px solid #EAEAEA;z-index:5;outline:0}.ui-dark .ui-edit-window{box-shadow:0 0 10px rgba(0,0,0,0.2);background-color:#333;border-color:#383838}

.ui-empty-table{display:table;width:100%;height:100%;color:#777;font-size:13px}.ui-empty-cell{display:table-cell;width:100%;height:100%;text-align:center;vertical-align:middle}.ui-empty-cell > i{font-size:40px;width:100px;height:100px;line-height:100px;text-align:center;background-color:#F0F0F0;border-radius:100px;color:#D0D0D0;transform:scale(1)}.ui-empty-cell > div{margin-top:15px}.ui-dark .ui-empty-table{color:#999}.ui-dark .ui-empty-cell > i{background-color:#303030;color:#404040}

.exec{cursor:pointer}

.ui-floatingbox-visible{position:fixed;width:100vw;height:100vw;left:0;top:0;display:block !important}.ui-floatingbox-container{display:none}.floatingbox{position:absolute;z-index:0;visibility:hidden;background-color:#FFF;box-shadow:rgb(15 15 15 / 5%) 0 0 0 1px,rgb(15 15 15 / 10%) 0 3px 6px,rgb(15 15 15 / 20%) 0 9px 24px;border-radius:var(--radius);transition:all 0.08s;transform:scale(0.7);pointer-events:none}.floatingbox-visible{z-index:10;visibility:visible;transform:scale(1);pointer-events:all}.ui-dark .floatingbox{background-color:#303030;box-shadow:rgb(15 15 15 / 5%) 0 0 0 1px,rgb(15 15 15 / 10%) 0 3px 6px,rgb(15 15 15 / 20%) 0 9px 24px}

.ui-floatinginput{position:absolute;opacity:0;transition:0.25s transform cubic-bezier(0.23,1,0.32,1);left:-100;top:-100;z-index:100;box-shadow:0 1px 20px rgba(0,0,0,0.1);background-color:#FFF;border-radius:var(--radius);border:1px solid #E0E0E0;overflow:hidden;transition:all 0.2s}.ui-floatinginput-input{min-height:38px;background:#FFF;border-radius:var(--radius) var(--radius) 0 0;line-height:22px}.ui-floatinginput-input input{width:100%;background-color:#FFF;border:0;font-size:12px;outline:0;padding:0;margin:0;line-height:16px;outline:0;display:block}.ui-floatinginput-input textarea{width:100%;background-color:#FFF;border:0;font-size:12px;outline:0;padding:0;margin:0;line-height:16px;outline:0;resize:none}.ui-floatinginput-input > div{margin:0 30px 0 35px;padding:6px 10px 0 0;line-height:24px}.ui-floatinginput-input > span{float:left;width:16px;text-align:center;padding:8px 0 0 12px;font-size:12px}.ui-floatinginput-control input{margin:4px 0 0}.ui-floatinginput-add{float:right !important;padding-left:0 !important;color:#83c83c;text-align:left !important;font-size:11px !important;cursor:pointer;width:22px !important}.ui-floatinginput-visible{opacity:1}.ui-floatinginput-summary{font-size:11px;color:gray;border-bottom:1px solid #E0E0E0;padding:5px 10px 8px;line-height:14px}.ui-floatinginput-summary code{background-color:#F8F8F8;padding:1px 2px;border-radius:2px}.ui-floatinginput-monospace input,.ui-floatinginput-monospace textarea{font-family:Menlo,Consolas,monospace}.ui-floatinginput-multiline .ui-floatinginput-control{padding:10px 0}.ui-floatinginput ::-webkit-scrollbar{width:10px}.ui-floatinginput ::-webkit-scrollbar-track-piece{background-color:transparent}.ui-floatinginput ::-webkit-scrollbar-thumb{background-color:transparent;outline:2px solid transparent;outline-offset:-2px;border:1px solid transparent}.ui-floatinginput ::-webkit-scrollbar-thumb:hover{background-color:transparent}.ui-dark .ui-floatinginput{background-color:#303030;border-color:#404040;box-shadow:1px 5px 10px rgba(0,0,0,0.2)}.ui-dark .ui-floatinginput-input{background:#303030}.ui-dark .ui-floatinginput-input input,.ui-dark .ui-floatinginput-input textarea{background-color:#303030}.ui-dark .ui-floatinginput-add:hover{color:#FFF}.ui-dark .ui-floatinginput-summary code{background-color:#272727;padding:1px 2px;border-radius:2px}.ui-dark .ui-floatinginput-summary{color:gray;border-bottom-color:#404040}

.ui-floatingsearch{position:absolute;height:46px;left:0;right:0;background-color:#FFF;border:1px solid #E0E0E0;margin-top:-1px;z-index:2}.ui-floatingsearch .input{padding:0;display:block;margin:0 50px 0 35px}.ui-floatingsearch .input input{width:100%;line-height:44px;border:0;padding:0;margin:0;outline:0;background-color:transparent}.ui-floatingsearch .icon{float:left;width:35px;line-height:44px;text-align:center}.ui-floatingsearch i{-webkit-transform:none}.ui-floatingsearch-filled .icon{color:red;cursor:pointer}.ui-floatingsearch .close{float:right;width:46px;color:red;text-align:center;font-size:16px;line-height:44px;border-left:1px solid #E0E0E0;cursor:pointer}.ui-floatingsearch .close:hover{background-color:#F0F0F0}.ui-dark .ui-floatingsearch{background-color:#303030;border-color:#404040}.ui-dark .ui-floatingsearch .close{border-left-color:#404040}.ui-dark .ui-floatingsearch .close:hover{background-color:#353535}

.ui-flow{position:relative;transform-origin:top left;transition:transform 0.3s}.ui-flow .component{position:absolute;left:150px;top:150px;border:2px solid #E0E0E0;background-color:#FFF;border-radius:var(--radius);box-shadow:1px 1px 10px rgba(0,0,0,0.03)}.ui-flow-h .inputs{margin:0;position:relative;top:0;left:0}.ui-flow-h .input{background-color:#FFF;padding:0 8px;font-size:11px;color:gray;border-top:1px solid #E0E0E0;line-height:20px}.ui-flow-h .input > span{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;margin-left:2px}.ui-flow-h .input .component-io{float:left;margin:3px 0 0 -15px}.ui-flow-h .input:last-child{border-radius:0 0 var(--radius) var(--radius)}.ui-flow-h .outputs{margin:0;position:relative}.ui-flow-h .output{background-color:#FFF;padding:0 8px;font-size:11px;color:gray;border-top:1px solid #E0E0E0;line-height:20px}.ui-flow-h .output > span{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.ui-flow-h .output .component-io{float:right;margin:3px -15px 0 0}.ui-flow-h .output:last-child{border-radius:0 0 var(--radius) var(--radius)}.ui-flow .component-io{width:12px;height:12px;line-height:12px;border-radius:var(--radius);background-color:#A0A0A0;text-align:center;float:left;margin-top:1px;font-size:9px}.ui-flow .content{padding:10px 8px;min-width:200px;min-height:24px;cursor:default}.ui-flow-h .output.connected{color:#000}.ui-flow .output.connected .component-io{background-color:#68B25B !important}.ui-flow .input.connected .component-io{background-color:#68B25B !important}.ui-flow .connection{stroke-width:2;stroke:#000;fill:none}.ui-flow .connection-draft{stroke:var(--color)}.ui-flow .component-selected{border-color:var(--color)}.ui-flow .connection-selected{stroke-width:6px !important}.ui-flow .component-focused{z-index:1}.ui-flow .area{position:relative}.ui-flow path.highlight{stroke-width:3.5px !important}.ui-flow > svg{margin:-1px 0 0 -1px;outline:0}.ui-flow-grid{stroke:#F8F8F8;stroke-width:2}.ui-flow .output.connected .component-io.disabled,.ui-flow .input.connected .component-io.disabled,.ui-flow .output .component-io.disabled,.ui-flow .input .component-io.disabled{background-color:red !important;color:#FFF}.ui-flow .traffic{fill:transparent;stroke-width:3px}.ui-flow-connections{position:absolute;pointer-events:none}.ui-flow-connections path{pointer-events:auto}.ui-flow-groups{position:relative}.ui-flow-group{position:absolute;background:rgba(0,0,0,0.05);border-radius:var(--radius);border:2px solid rgba(0,0,0,0.05);color:#000}.ui-flow-group > div{position:relative;width:100%;height:100%}.ui-flow-group > div > span{width:15px;height:15px;position:absolute}.ui-flow-group > div > label{display:block;padding:15px;font-size:18px;font-weight:bold}.ui-flow .group-selected{border-color:var(--color)}.ui-flow-resize-tl{cursor:nwse-resize;top:-2px;left:-2px;border-radius:var(--radius) 0 0 0}.ui-flow-resize-tr{cursor:nesw-resize;right:-2px;top:-2px;border-radius:0 var(--radius) 0 0}.ui-flow-resize-br{cursor:nwse-resize;right:-2px;bottom:-2px;border-radius:0 0 var(--radius) 0}.ui-flow-resize-bl{cursor:nesw-resize;bottom:-2px;left:-2px;border-radius:0 0 0 var(--radius)}.ui-flow-drag{cursor:grab !important}.ui-flow-dragged .ui-flow-groups{pointer-events:none}.ui-flow-selection{background:rgba(0,0,0,0.1);position:absolute;left:0;top:0;width:0;height:0}.ui-flow .connection-type-transform{stroke-dasharray:4}.ui-dark .ui-flow-grid{stroke:#303030}.ui-dark .ui-flow .component{border-color:#404040;background-color:#303030}.ui-dark .ui-flow .output .component-io{color:#606060}.ui-dark .ui-flow .input .component-io{color:#606060}.ui-dark .ui-flow .output,.ui-dark .ui-flow .input{background-color:#303030;color:#FFF;border-color:#404040}.ui-dark .ui-flow .connection{stroke:#999}.ui-dark .ui-flow .connection-draft{stroke:var(--color)}.ui-dark .ui-flow .component-selected{border-color:var(--color)}.ui-dark .ui-flow-group{background:rgba(0,0,0,0.3);border-color:rgba(0,0,0,0.3);color:#FFF}.ui-dark .ui-flow .group-selected{border-color:var(--color)}.ui-dark .ui-flow-selection{background:rgba(255,255,255,0.1)}.ui-dark #ui-flow-arrow{fill:#999}

.ui-form-noscroll,.ui-form-noscroll body{overflow:hidden}.ui-form-container{width:100%;position:fixed;left:0;top:0;bottom:0;right:0;background-color:rgba(230,233,237,0.8);z-index:5;overflow-y:scroll;transform-style:preserve-3d;overflow-scrolling:touch}.ui-form{background-color:#FFF;margin:0 auto 30px;border-radius:var(--radius);box-shadow:0 2px 30px rgba(0,0,0,0.10);transform:translate(0,-500px);transition:all 0.2s;opacity:0}.ui-form-animate{transform:skewX(0deg);opacity:1}.ui-form .padding{padding:15px}.ui-form-title{padding:18px 15px;font-size:16px;user-select:none;color:#000;background-color:#FFF;border-bottom:1px solid #E0E0E0;height:58px}.ui-form-title .ui-form-button-close{float:right;cursor:pointer;font-size:18px;margin:-2px 0 0;transition:all 0.2s;background:none;border:0;outline:0;height:auto;color:red;text-align:right !important;width:20px;padding:0}.ui-form-title .ui-form-button-close i{font-weight:bold}.ui-form-title .ui-form-button-close:hover{transform:scale(1.2)}.ui-form-title > span{font-weight:bold}.ui-form-title > i{margin-right:7px}.ui-form > nav{padding:0 15px 0;border-top:1px solid #E0E0E0;background-color:#FFF;border-radius:0 0 var(--radius) var(--radius);line-height:65px;height:65px;display:block;float:none;position:relative}.ui-form > nav button{border:0;margin:15px 0 0;background-color:#F0F0F0;height:34px;padding:0 20px;color:#000;cursor:pointer;font-family:Arial;line-height:34px;vertical-align:middle;outline:0;font-size:14px;text-decoration:none;transition:all 0.3s;float:left;width:50%}.ui-form > nav button i{width:15px;text-align:center;margin-right:5px}.ui-form > nav button:hover{opacity:0.9}.ui-form > nav button:active{background-color:#D0D0D0}.ui-form > nav button:disabled{background-color:#F5F5F5 !important;border-color:#E0E0E0 !important;color:silver !important;cursor:not-allowed;box-shadow:none}.ui-form > nav button:first-child{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.ui-form > nav button:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-form > nav button[name='submit']{font-weight:bold;background-color:var(--color);color:#FFF}.ui-dark .ui-form-container{background-color:rgba(50,50,50,0.9)}.ui-dark .ui-form{background-color:#202020}.ui-dark .ui-form-title{background-color:#202020;border-bottom-color:#303030;color:#FFF}.ui-dark .ui-form > nav{background-color:#202020;border-top-color:#303030}.ui-dark .ui-form > nav button{border-color:#202020;background-color:#505050;color:#E0E0E0}.ui-dark .ui-form > nav button[name='submit']{background-color:var(--color)}.ui-dark .ui-form > nav button:active{background-color:#404040}.ui-dark .ui-form > nav button:disabled{background-color:#303030 !important;color:#606060 !important;border-color:#202020 !important}@media(max-width:767px){.ui-form-container-padding{padding:0}.ui-form > nav button[name='submit']{max-width:180px}}@media(max-width:350px){.ui-form-container-padding{padding:0}.ui-form > nav button[name='submit']{max-width:150px}}

.ui-icons-container{position:absolute;z-index:110}.ui-icons{border:1px solid #E0E0E0;font-size:14px;color:#000;width:330px;z-index:10;background-color:#FFF;box-shadow:0 5px 10px rgba(0,0,0,0.08);border-radius:var(--radius);z-index:80;overflow:hidden}.ui-icons-header{height:50px;background-color:#fcfcfc;border-bottom:1px solid #e0e0e0;padding:10px 0 0}.ui-icons-nav{padding:13px 5px 6px;text-align:center}.ui-icons-nav span{cursor:pointer;font-size:24px;width:11%;display:inline-block;user-select:none}.ui-icons-search{padding:0 10px}.ui-icons-search span{float:left;width:30px;text-align:center;height:30px;padding:7px 0 0;font-size:12px;background-color:#FFF;border:1px solid #e0e0e0;border-radius:var(--radius) 0 0 var(--radius);color:#A0A0A0;cursor:pointer}.ui-icons-search .ti-times{color:#ff0000}.ui-icons-search div{margin-left:30px}.ui-icons-search-input{margin:0;width:100%;border:1px solid #e0e0e0;padding:0 9px;height:30px;border-radius:0 var(--radius) var(--radius) 0;border-left:0;appearance:none}.ui-icons-search-input:focus{outline:none}.ui-icons-scroll{overflow:auto;height:305px}.ui-icons-content{position:relative;padding:5px}.ui-icons-content span{padding:5px;cursor:pointer;font-size:20px;width:12.5%;height:30px;display:inline-block;text-align:center;user-select:none;color:#404040}.ui-icons-content span:hover{transform:scale(1.15);color:#000}.ui-icons-scrollbar{height:305px}.ui-dark .ui-icons{background-color:#202020;border-color:#303030}.ui-dark .ui-icons-header{background-color:#202020;border-color:#303030}.ui-dark .ui-icons-content{color:#A0A0A0}.ui-dark .ui-icons-search span{background-color:#252525;border-color:#303030;color:#A0A0A0}.ui-dark .ui-icons-search-input{border-color:#303030;background-color:#1f1f1f;color:#FFF}.ui-dark .ui-icons-content span{color:#A0A0A0}.ui-dark .ui-icons-content span:hover{color:#FFF}@media(max-width:767px){.ui-icons .ui-icons-nav span{cursor:pointer;font-size:26px}.ui-icons .ui-icons-content span{min-width:45px}}

.ui-inlinedatepicker{font-size:12px;width:247px;height:300px;background-color:#FFF;border:1px solid #E0E0E0;color:gray}.ui-inlinedatepicker-disabled{color:silver !important;cursor:pointer}.ui-inlinedatepicker-body,.ui-inlinedatepicker-months,.ui-inlinedatepicker-years{height:235px}.ui-inlinedatepicker-footer{height:28px;border-top:1px solid #E0E0E0;font-size:11px;padding:0 8px;line-height:26px;background-color:#F8F8F8}.ui-inlinedatepicker-footer > span:hover{text-decoration:underline}.ui-inlinedatepicker-now{float:left;color:#000;cursor:pointer}.ui-inlinedatepicker-today div{background-color:#F0F0F0;font-weight:bold}.ui-inlinedatepicker-selected div{background-color:#F8F7DA;font-weight:bold;color:#000}.ui-inlinedatepicker-date i{position:absolute;left:15px;top:26px;font-size:6px;color:red}.ui-inlinedatepicker-months > div{width:61px;height:78px;line-height:76px;position:relative;display:inline-block;text-align:center;cursor:pointer;text-transform:uppercase;font-weight:bold}.ui-inlinedatepicker-months > div > div{width:50px;height:50px;line-height:46px;position:relative;display:inline-block;border-radius:100%;border:2px solid transparent}.ui-inlinedatepicker-months > div:hover > div{border-color:#E0E0E0;color:#000}.ui-inlinedatepicker-years{padding:5px 0 0}.ui-inlinedatepicker-years > div{width:49px;height:46px;line-height:44px;position:relative;display:inline-block;text-align:center;cursor:pointer}.ui-inlinedatepicker-years > div > div{width:40px;height:40px;line-height:36px;position:relative;display:inline-block;border-radius:100%;border:2px solid transparent}.ui-inlinedatepicker-years > div:hover > div{border-color:#E0E0E0;color:#000}.ui-inlinedatepicker-header{height:35px;border-bottom:1px solid #E0E0E0;text-align:center;font-size:14px}.ui-inlinedatepicker-prev{float:left;line-height:34px;width:34px;color:#000;cursor:pointer}.ui-inlinedatepicker-next{float:right;line-height:34px;width:34px;color:#000;cursor:pointer}.ui-inlinedatepicker-prev:hover,.ui-inlinedatepicker-next:hover{background-color:#F0F0F0}.ui-inlinedatepicker-info{margin:0 34px;line-height:34px}.ui-inlinedatepicker-info > span{cursor:pointer}.ui-inlinedatepicker-info > span:hover{color:#000}.ui-inlinedatepicker-info .ui-inlinedatepicker-year{margin-left:5px}.ui-inlinedatepicker-week > div,.ui-inlinedatepicker-days > div{width:35px;height:35px;line-height:35px;position:relative;display:inline-block;vertical-align:middle;text-align:center}.ui-inlinedatepicker-week > div{height:25px;line-height:25px;font-weight:bold;color:#000;border-bottom:1px solid #E0E0E0}.ui-inlinedatepicker-days > div{font-size:11px;cursor:pointer}.ui-inlinedatepicker-date:hover > div{border-color:#E0E0E0;color:#000}.ui-inlinedatepicker-days > div > div{width:28px;height:28px;line-height:24px;border-radius:100%;margin:0 auto;position:relative;display:inline-block;border:2px solid transparent}.ui-dark .ui-inlinedatepicker{background-color:#282828;border-color:#404040;color:gray}.ui-dark .ui-inlinedatepicker-disabled{color:#505050 !important}.ui-dark .ui-inlinedatepicker-footer{border-top-color:#404040;background-color:#303030}.ui-dark .ui-inlinedatepicker-now{color:#FFF}.ui-dark .ui-inlinedatepicker-today div{background-color:#353535}.ui-dark .ui-inlinedatepicker-selected div{background-color:#505050;color:#FFF}.ui-dark .ui-inlinedatepicker-date i{color:red}.ui-dark .ui-inlinedatepicker-months > div:hover > div{border-color:#505050;color:#FFF}.ui-dark .ui-inlinedatepicker-years > div:hover > div{border-color:#505050;color:#FFF}.ui-dark .ui-inlinedatepicker-header{border-bottom-color:#404040}.ui-dark .ui-inlinedatepicker-prev{color:#FFF}.ui-dark .ui-inlinedatepicker-next{color:#FFF}.ui-dark .ui-inlinedatepicker-prev:hover,.ui-dark .ui-inlinedatepicker-next:hover{background-color:#303030}.ui-dark .ui-inlinedatepicker-info > span:hover{color:#FFF}.ui-dark .ui-inlinedatepicker-week > div{color:#FFF;border-bottom-color:#404040}.ui-dark .ui-inlinedatepicker-date:hover > div{border-color:#505050;color:#FFF}

.ui-input{position:relative;font-size:13px}.ui-input textarea{tab-size:2;overflow-y:scroll;-ms-overflow-style:none;scrollbar-width:none;background:transparent}.ui-input textarea:::-webkit-scrollbar{display:none}.ui-input-required .ui-input-control{border-color:#D0D0D0}.ui-input-label{margin-bottom:3px;font-size:12px;color:#777}.ui-input-label i{margin-right:4px}.ui-input-required.ui-input-raw .ui-input-label:before{content:'*';color:red;margin-right:3px}.ui-input-control{border:1px solid #E0E0E0;border-radius:var(--radius);min-height:36px;background-color:#FFF}.ui-input-input{padding:6px 8px 0;position:relative;line-height:24px}.ui-input-checkbox{margin-bottom:5px}.ui-input-checkbox *{height:25px;cursor:pointer}.ui-input-checkbox span{width:20px;height:20px;line-height:21px;font-size:11px;margin:0 7px 0 0;text-align:center;float:left;border:1px solid #D0D0D0;border-radius:4px;background:#FFF}.ui-input-checkbox span i{display:none;font-weight:bold}.ui-input-checkbox label{line-height:19px}.ui-input-checked .ui-input-checkbox span i{display:inline-block}.ui-disabled .ui-input-checkbox{color:#A0A0A0}.ui-disabled.ui-input *, .ui-disabled.ui-input{cursor:not-allowed !important}.ui-disabled .ui-input-checkbox span{background-color:#F0F0F0;color:#B0B0B0;border-color:#E0E0E0}.ui-input-placeholder{pointer-events:none;position:absolute;color:gray;margin:0;user-select:none;width:100%;text-align:left;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.ui-input-control input, .ui-input-control textarea{border:0;outline:0;background:transparent !important;width:100%;padding:0;margin:0;line-height:16px;font-size:13px;color:#000;font-family:Arial;resize:none}.ui-input-control textarea{padding:4px 0}.ui-input-control .ui-input-value{line-height:24px;height:22px;cursor:pointer;border-radius:var(--radius);outline:0}.ui-input-control input::-ms-expand{display:none}.ui-input-icon-left{width:34px;height:34px;line-height:33px;float:left;text-align:center;border-right:1px solid #E0E0E0}.ui-input-icon-right{width:34px;height:34px;line-height:33px;float:right;border-left:1px solid #E0E0E0;text-align:center}.ui-input-required .ui-input-icon-left{border-color:#D0D0D0}.ui-input-required .ui-input-icon-right{border-color:#D0D0D0}.ui-input-ricon .ui-input-input{margin-right:37px}.ui-input-licon .ui-input-input{margin-left:34px}.ui-input-ricon .ti-times, .ui-input-licon .ti-times{color:red}.ui-input-value{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.ui-input-click{cursor:pointer}.ui-input-error{margin-top:7px;font-size:11px;color:red}.ui-input .right input{text-align:right}.ui-input .right .ui-input-placeholder{text-align:right;padding-right:15px}.ui-input .center input{text-align:center}.ui-input .center .ui-input-placeholder{text-align:center;padding-right:15px}.ui-input-dropdown, .ui-input-dropdown input, .ui-input-dropdown .ui-input-placeholder{cursor:pointer}.ui-input-invalid .ui-input-control, .ui-input-invalid .ui-input-icon-left, .ui-input-invalid .ui-input-icon-right{border-color:red !important}.ui-input.ui-disabled .ui-input-control{background-color:#F0F0F0;color:#777}.ui-input.ui-disabled input{background-color:#F0F0F0;color:#A0A0A0}.ui-input.ui-disabled .ui-input-placeholder{color:#A0A0A0}.ui-input.ui-disabled .ui-input-icon-left, .ui-input.ui-disabled .ui-input-icon-right{color:gray}.ui-input-dropdown.ui-disabled .ui-input-control{cursor:not-allowed !important}.ui-input-raw .ui-input-increment{padding:6px 0 0 !important}.ui-input-increment i{line-height:10px;font-size:12px;cursor:pointer;display:block}.ui-input-increment i:first-child{margin-left:0}.ui-input-required.ui-input-inner .ui-input-label:after{content:'*';color:red;margin-left:3px}.ui-input-inner{background-color:#F5F5F5;border:1px solid #E5E5E5;padding:10px 5px 10px 10px;width:100%;border-radius:var(--radius)}.ui-input-inner.ui-disabled .ui-input-control{background-color:transparent !important}.ui-input-inner .ui-input-increment{padding-top:2px;color:#777}.ui-input-inner .ui-input-label{height:18px;margin:0;color:#6A7280;font-weight:bold}.ui-input-inner .ui-input-placeholder{color:#9DA4B0}.ui-input-inner input, .ui-input-inner textarea{font-size:14px}.ui-input-inner .ui-input-input{padding:0;font-size:14px}.ui-input-inner .ui-input-control{min-height:24px;border:0;background-color:transparent}.ui-input-inner .ui-input-icon-left, .ui-input-inner .ui-input-icon-right{height:24px;line-height:24px;color:#777;font-size:15px}.ui-input-inner.ui-input-focused{border-color:var(--color);box-shadow:0 0 #0000,0 0 #0000,0px 0px 0px 4px #4AAEFF1A}.ui-input-inner.ui-input-invalid{border-color:#EEB7B7;box-shadow:0 0 #0000,0 0 #0000,0px 0px 0px 4px #D85A5A1A}.ui-input-inner .ui-input-checkbox{margin-bottom:0}.ui-input-inner .ui-input-icon-right{border:0;padding-left:10px}.ui-input-masked input{letter-spacing:1px;font-family:Menlo,Consolas,monospace}.ui-input-monospace input, .ui-input-monospace textarea{font-family:Menlo,Consolas,monospace}.ui-input-icon-custom{font-size:11px}.ui-input-inner .ui-input-value{line-height:24px;height:24px}.ui-input-type-icon .ui-input-value, .ui-input-type-emoji .ui-input-value{font-size:15px}.ui-input-type-icon .ui-input-control, .ui-input-type-color .ui-input-control, .ui-input-type-color .ui-input-emoji{cursor:pointer}.ui-dark .ui-input-required .ui-input-control{border-color:#505050}.ui-dark .ui-input-raw .ui-input-control{border-color:#404040;background-color:#202020 !important;box-shadow:0 1px 4px rgba(0,0,0,0.3)}.ui-dark .ui-input-required .ui-input-icon-left{border-color:#404040}.ui-dark .ui-input-required .ui-input-icon-right{border-color:#404040}.ui-dark .ui-input-control input, .ui-dark .ui-input-control textarea{background-color:transparent;color:#FFF}.ui-dark .ui-input-icon-left, .ui-dark .ui-input-icon-right{border-color:#303030;color:gray}.ui-dark .ui-input.ui-disabled .ui-input-control{background-color:#282828;color:#999}.ui-dark .ui-input.ui-disabled input{background-color:#282828;color:#777}.ui-dark .ui-input.ui-disabled .ui-input-placeholder{color:#777}.ui-dark .ui-input-checkbox span{border-color:#404040;background:#252525}.ui-dark .ui-input-inner{background-color:#252525;border-color:#303030}.ui-dark .ui-input-inner.ui-disabled .ui-input-control{background-color:transparent !important}.ui-dark .ui-input-inner.ui-input-focused{border-color:var(--color);box-shadow:0 0 #0000,0 0 #0000,0px 0px 0px 4px #4AAEFF3F}.ui-dark .ui-input-inner.ui-input-invalid{border-color:#8E3D3D;box-shadow:0 0 #0000,0 0 #0000,0px 0px 0px 4px #D85A5A42}.ui-dark .ui-disabled .ui-input-checkbox span{background-color:#282828;color:#999;border-color:#303003}.ui-dark .ui-disabled .ui-input-checkbox{color:#666}

.bg-smoke{background-color:#F8F8F8}.ui-dark .bg-smoke{background-color:#282828}.panel{background-color:#FFF;border-radius:var(--radius);border:1px solid #E0E0E0}.panel > .toolbar{float:right;margin:15px 20px 0 10px}.panel > .toolbar button{height:30px;line-height:30px;min-width:60px}.panel > label{display:block;padding:18px 20px;border-bottom:1px solid #E0E0E0;font-size:16px;color:#000;font-weight:bold;border-radius:var(--radius) var(--radius) 0 0}.panel > label i{margin-right:7px}.panel .padding{padding:18px var(--gap)}.ui-dark .panel{background-color:#202020;border-color:#404040}.ui-dark .panel > label{border-bottom-color:#404040;color:#FFF}.toolbar{height:26px}.toolbar button{outline:0;background:#FFF;border:1px solid #E0E0E0;border-left:0;font-size:11px;height:26px;padding:0 8px;color:#000;min-width:80px;text-align:center;vertical-align:top;background-color:#FFF;line-height:24px;float:left;text-align:center !important}.toolbar button i{margin-right:5px}.toolbar button .ti-plus-circle,.toolbar button .ti-check-circle{color:#68B25B}.toolbar button:first-child{border-left:1px solid #E0E0E0;border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.toolbar button:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.toolbar button:hover{border-color:#D0D0D0}.toolbar button:active{background:#F0F0F0;color:#888;border-color:#DFDFDF}.toolbar button:disabled{color:silver;cursor:not-allowed;border-color:#E0E0E0 !important;background:#F8F8F8}.toolbar button:disabled i{color:silver !important}.toolbar button.right{float:right;margin-left:5px;margin-right:0;text-align:center}.ui-dark .toolbar button{background:#202020;border-color:#333;color:#C0C0C0}.ui-dark .toolbar button:first-child{border-left-color:#333}.ui-dark .toolbar button:hover{border-color:#404040;color:#FFF}.ui-dark .toolbar button:active{background:#222;color:#A0A0A0;border-color:#333}.ui-dark .toolbar button:disabled{color:#666;border-color:#404040 !important;background:#303030}.ui-dark .toolbar button:disabled i{color:#666 !important}.toolbar-bg{height:44px;background-color:#F0F0F0;padding:10px 10px 0}.ui-dark .toolbar-bg{background-color:#282828}.nav{background-color:#F0F0F0}.nav nav{padding:10px 5px;display:block}.nav nav > div,.nav nav > a{display:block;height:30px;margin:0 5px 2px;line-height:30px;padding:0 10px;border-radius:var(--radius);cursor:pointer;font-size:13px;color:#888;border:0;text-decoration:none !important}.nav nav > div > i,.nav nav > a i{width:14px;text-align:center;margin-right:10px}.nav nav > div:hover,.nav nav > a:hover{background-color:rgba(0,0,0,0.05);color:#000;text-decoration:none !important}.nav nav > div.ui-disabled,.nav nav > a.ui-disabled,.nav nav > div.disabled,.nav nav > a.disabled{cursor:not-allowed;color:#C0C0C0;background-color:transparent !important}.nav nav .selected{background-color:rgba(100,100,100,0.1);color:#000}.nav label{font-size:12px;color:#999;display:block;margin:0 15px 10px;padding:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.nav label i{margin-right:5px}.ui-dark .nav{background-color:#282828}.ui-dark .nav nav > div,.ui-dark .nav nav > a{color:#999}.ui-dark .nav nav > div:hover{background-color:rgba(255,255,255,0.05);color:#FFF}.ui-dark .nav nav > div.ui-disabled,.ui-dark .nav nav > a.ui-disabled,.ui-dark .nav nav > div.disabled,.ui-dark .nav nav > a.disabled{color:#555;background-color:transparent !important}.ui-dark .nav nav .selected{background-color:rgba(255,255,255,0.1);color:#FFF}.ui-dark .nav label{color:#777}.listing{z-index:2;position:relative;overflow:hidden}.listing figure{cursor:pointer}.listing figure > section{margin:-1px 10px 0;border-bottom:1px solid #E0E0E0;padding:10px 0}.listing figure:first-child section{margin-top:0}.listing figure.selected{background-color:#F8F8F8;border-radius:var(--radius)}.listing figure:hover{background-color:#F0F0F0;border-radius:var(--radius)}.listing figure.selected > section,.listing figure:hover > section{border-bottom-color:transparent !important}.listing figure:last-child > section{border-bottom-color:transparent}.ui-dark .listing figure > section{border-color:#303030}.ui-dark .listing figure.selected{background-color:#272727}.ui-dark .listing figure:hover{background-color:#303030}.ui-dark .listing figure:last-child > section{border-bottom-color:transparent}.listing2 figure{cursor:pointer;background-color:rgba(0,0,0,0.05);margin-bottom:2px;border-radius:var(--radius)}.listing2 figure > section{padding:10px}.listing2 figure:first-child section{margin-top:0}.listing2 figure.selected{background-color:rgba(0,0,0,0.09)}.listing2 figure:hover{background-color:rgba(0,0,0,0.08)}.listing2 figure.selected > section,.listing2 figure:hover > section{border-bottom-color:transparent !important}.listing2 figure:last-child > section{border-bottom-color:transparent}.ui-dark .listing2 figure{background-color:rgba(100,100,100,0.1)}.ui-dark .listing2 figure.selected{background-color:rgba(120,120,120,0.2)}.ui-dark .listing2 figure:hover{background-color:rgba(150,150,150,0.2)}.configuration{background-color:#FFF;border-radius:var(--radius);border:1px solid #E0E0E0}.configuration p{margin:0 0 15px;font-size:13px;padding:0;color:#666}.configuration > section > .toolbar{float:right;margin:10px 10px 0}.configuration > section > .toolbar button{height:22px;line-height:20px;min-width:60px}.configuration > section > label{display:block;padding:10px;font-size:15px;color:#000;font-weight:bold;border-top:1px solid #E0E0E0}.configuration > section > label i{margin:3px 6px 0 0;width:15px;text-align:center;float:left}.configuration > section:first-child > label{border-top:0;border-radius:var(--radius) var(--radius) 0 0}.configuration > section > article{border-top:1px solid #E0E0E0}.configuration > section:first-child article:first-child{border-top:0;border-radius:var(--radius) var(--radius) 0 0}.configuration .padding{padding:var(--gap) 15px}.configuration > .toolbar{float:right;margin:10px 10px 0}.configuration > .toolbar button{height:22px;line-height:20px;min-width:60px}.ui-dark .configuration p{color:#A0A0A0}.ui-dark .configuration{background-color:#202020;border-color:#404040}.ui-dark .configuration > section:first-child label{border-top-color:#404040}.ui-dark .configuration > section > article{border-top-color:#404040}.ui-dark .configuration > section label{color:#FFF;border-top-color:#404040}.message{padding:10px;border:2px solid #E0E0E0;border-radius:var(--radius);font-size:12px;margin-bottom:10px}.message i{margin-right:5px}.message-error{border-color:#D63A32;color:#A72C26}.message-alert{border-color:#DEBA31;color:#8c7727}.message-success{border-color:#68B25B;color:#4A7543}.ui-dark .message{border-color:#666;color:#999}.ui-dark .message-error{border-color:#D63A32;color:#DC7772}.ui-dark .message-alert{border-color:#DEBA31;color:#D2BA62}.ui-dark .message-success{border-color:#68B25B;color:#6DAD63}.badge{font-size:12px;padding:4px 6px;border-radius:var(--radius);background-color:var(--color);line-height:12px;vertical-align:middle;position:relative;display:inline-block;color:#FFF}.badge i{margin-right:3px}.badge-blue{background-color:#0E68A6}.badge-red{background-color:#D63B32}.badge-green{background-color:#8CC152}.badge-yellow{background-color:#EFDC05}.badge-orange{background-color:#F49519}.badge-gray{background-color:#606060}.badge-purple{background-color:#967ADC}.badge-pink{background-color:#D770AD}.badge-silver{background-color:#E0E0E0;color:gray}.badge-large,.badge.large{padding:3px 8px;font-size:14px;line-height:16px}.badge-large i,.badge.large i{margin-right:5px}.badge-small,.badge.small{font-size:10px;padding:0px 3px 1px}.badge-medium,.badge.medium{font-size:11px;padding:2px 6px}.badge-medium i,.badge.medium i{margin-right:5px}.ui-dark .badge-silver{background-color:#666;color:#FFF}.caption > .toolbar{float:right;margin:10px 0 0 10px}.caption > .toolbar button{height:22px;line-height:20px;min-width:60px}.caption > label{display:block;padding:10px 0;border-bottom:1px solid #E0E0E0;font-size:15px;color:#000;font-weight:bold}.caption > label i{margin-right:7px}.ui-dark .caption > label{border-bottom-color:#404040;color:#FFF}.keyvalue.small{font-size:11px;min-height:14px;line-height:14px}.keyvalue.small > span i{width:12px}.keyvalue.small > div i{width:12px}.keyvalue.small .badge{padding:2px 4px}.keyvalue.small .badge.small{padding:0 3px 1px}.keyvalue{min-height:20px;font-size:13px;margin-bottom:2px;line-height:17px}.keyvalue > span{width:120px;float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#777}.keyvalue > span i{width:14px;margin-right:5px}.keyvalue > div{margin-left:120px}.keyvalue > div i{width:14px;margin-right:5px}p{font-size:13px;color:#777;margin:0 0 15px}.iconmenu{height:54px;text-align:center}.iconmenu i{font-size:20px;display:block;padding:8px 0 0}.iconmenu span{font-size:11px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:3px 5px 0;color:#777}.iconmenu > div.selected{background-color:rgba(0,0,0,0.07)}.iconmenu > div{height:54px;width:75px;border:1px solid #E0E0E0;border-left-width:0;float:left;cursor:pointer}.iconmenu > div:first-child{border-left-width:1px;border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.iconmenu > div:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-dark .iconmenu > div.selected{background-color:rgba(255,255,255,0.1)}.ui-dark .iconmenu > div{border-color:#404040}.detail figure{min-height:35px;padding:8px 0 5px;border-top:1px solid #E0E0E0;font-size:13px}.detail figure > p{margin:0 0 20px}.detail figure:first-child{border-top:0}.detail figure > span{float:left;width:140px;color:#777;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding-right:5px}.detail figure > span i{width:14px;margin-right:5px;text-align:center}.detail figure > div{margin-left:150px}.ui-dark .detail figure{border-top-color:#404040}.divider{position:relative;margin:25px 0}.divider div{position:absolute;left:0;top:-10px;right:0;text-align:center}.divider span{background-color:#F0F0F0;border-radius:var(--radius);padding:5px 8px;font-size:11px;color:#999}.divider span i{margin-right:5px}.ui-dark .divider span{background-color:#404040;color:#A0A0A0}.btn{border:0;margin:0;background-color:#E7E7E7;height:40px;padding:0 20px;color:#000;cursor:pointer;font-family:Arial;line-height:34px;vertical-align:middle;outline:0;font-size:14px;text-decoration:none;transition:all 0.3s;width:100%}.btn i{width:15px;text-align:center;margin-right:5px}.btn:hover{opacity:0.8}.btn[name='submit']{font-weight:bold;background-color:var(--color);color:#FFF}.btn:disabled{background-color:#F5F5F5 !important;border-color:#E0E0E0 !important;color:#A0A0A0 !important;cursor:not-allowed;box-shadow:none;opacity:1 !important}.btn:disabled i{color:#A0A0A0 !important}.btn:first-child{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.btn:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.btn.small{height:24px;padding:0 8px;line-height:14px;font-size:12px}.ui-dark .btn{background-color:#555;color:#F0F0F0}.ui-dark .btn[name='submit']{background-color:var(--color);color:#FFF}.ui-dark .btn:disabled{background-color:#333 !important;border-color:#333 !important;color:#888 !important}.ui-dark .btn:disabled i{color:#999 !important}

.ui-intro-noscroll,.ui-intro-noscroll body{overflow:hidden}.ui-intro{position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,0.8);width:100%;height:100%;overflow:hidden;z-index:20;color:#000}.ui-intro-body{position:relative;top:50%;background-color:#FFF;border-radius:var(--radius);width:100%;margin:0 auto;display:block;box-shadow:0 5px 10px rgba(0,0,0,0.02);transition:transform 0.3s;transform:scale(1.5)}.ui-intro-body-visible{transform:scale(1)}.ui-intro-body > span{position:absolute;color:red;right:15px;top:10px;cursor:pointer;font-size:16px}.ui-intro-figures{display:table;width:100%}.ui-intro .visible{display:table-cell}.ui-intro figure{display:none;vertical-align:middle;text-align:center;width:100%;height:100%;overflow:hidden}i.ui-intro-button{margin:16px 5px 0;cursor:pointer;color:silver;font-size:12px}.ui-intro-pagination{padding:10px;background-color:#F0F0F0;height:60px;border-radius:0 0 var(--radius) var(--radius)}.ui-intro-pagination .selected{color:var(--color)}.ui-intro-pagination button{float:right;border:0;background-color:var(--color);color:#FFF;border-radius:var(--radius);font:normal 13px Arial;text-transform:uppercase;font-weight:bold;height:40px;width:150px;padding:0;margin:0;outline:0}.ui-intro-pagination button:hover{opacity:0.9}.ui-intro-pagination button.next i{margin-left:5px}.ui-intro-pagination button.done i{margin-right:5px}.ui-dark .ui-intro{background-color:rgba(0,0,0,0.8);color:#D0D0D0}.ui-dark .ui-intro-body{background-color:#202020}.ui-dark .ui-intro-body > span{color:red}.ui-dark i.ui-intro-button{color:#666}.ui-dark .ui-intro-pagination{background-color:#303030}.ui-dark .ui-intro-pagination .selected{color:var(--color)}

.ui-keyvalue-label{margin-bottom:5px;font-size:12px}.ui-keyvalue-label i{margin-right:5px}.ui-keyvalue-items > div:first-child{border-radius:var(--radius) var(--radius) 0 0}.ui-keyvalue-item{height:32px;background-color:#FFF;border:1px solid #E0E0E0;border-bottom:0}.ui-keyvalue-item-remove{float:right;width:32px;height:32px;border-left:1px solid #E0E0E0;text-align:center;color:#DA4453;font-size:14px}.ui-keyvalue-item-key{height:31px;padding:3px 0 4px;float:left;width:200px;border-right:1px solid #E0E0E0;font-weight:bold;background-color:#F8F8F8}.ui-keyvalue-item-value{padding:3px 0 0;margin:0 32px 0 202px}.ui-keyvalue-item i{cursor:pointer;display:block;padding:8px 0 0}.ui-keyvalue-item i:active{margin-top:1px}.ui-keyvalue-item input{width:100%;background-color:transparent;border:0;padding:3px 10px 0;outline:0;font-size:13px;color:#000}.ui-keyvalue-item:first-child .ui-keyvalue-item-key{border-top-left-radius:var(--radius)}.ui-keyvalue-base .ui-keyvalue-item-remove{display:none}.ui-keyvalue-base{border-radius:0 0 var(--radius) var(--radius);border-bottom:1px solid #E0E0E0}.ui-keyvalue-base .ui-keyvalue-item-key{height:30px;border-bottom-left-radius:var(--radius)}.ui-keyvalue.ui-disabled input{color:#777;cursor:not-allowed}.ui-keyvalue.ui-disabled i{display:none}.empty .ui-keyvalue-base{border-radius:var(--radius)}.ui-dark .ui-keyvalue-item{background-color:#202020;border-color:#444}.ui-dark .ui-keyvalue-item-remove{border-left-color:#444;color:#DA4453}.ui-dark .ui-keyvalue-item-key{border-right-color:#444;background-color:#282828}.ui-dark .ui-keyvalue-item input{background-color:transparent;color:#FFF}.ui-dark .ui-keyvalue-base{border-bottom-color:#444}.ui-dark .ui-keyvalue.ui-disabled input{color:#777}

.ui-layout{border:0;position:absolute;z-index:1}.ui-layout > section{position:absolute;overflow:hidden}.ui-layout > div{position:absolute}.ui-layout-resize-top{height:2px;cursor:row-resize}.ui-layout-resize-bottom{height:2px;cursor:row-resize}.ui-layout-resize-left{width:2px;cursor:col-resize}.ui-layout-resize-right{width:2px;cursor:col-resize}.ui-layout-resize{z-index:2;user-select:none}.ui-layout-resize:hover{background-color:#C0C0C0}.ui-layout-drag{background-color:#C0C0C0}.ui-layout-section{background-color:#F0F0F0}.ui-layout-lock{background-color:rgba(222,222,222,0.8);z-index:100}.ui-dark .ui-layout-section{background-color:#282828}.ui-dark .ui-layout-resize:hover{background-color:#505050}.ui-dark .ui-layout-lock{background-color:rgba(34,34,34,0.8)}

.ui-listform-invalid .ui-listform-items{border-color:red}.ui-listform-container{border:1px solid #E0E0E0;border-radius:var(--radius)}.ui-listform-items .ui-listform-item:first-child{border-top-left-radius:var(--radius);border-top-right-radius:var(--radius)}.ui-listform-items .ui-listform-item:last-child{border-bottom-left-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-listform-form-container{background-color:#F8F8F8;padding:15px}.ui-listform-form{border-radius:var(--radius);border:1px solid #E0E0E0;background-color:#FFF}.ui-listform-emptylabel{text-align:center;display:none;padding:15px;font-size:12px;color:gray}.ui-listform-empty .ui-listform-emptylabel{display:block}.ui-listform-item{border-bottom:1px solid #E0E0E0;cursor:pointer}.ui-listform-selected{font-weight:bold;background-color:#F8F8F8}.ui-listform-item:last-child{border-bottom:0}.ui-disabled .ui-listform-item{cursor:not-allowed;color:gray}.ui-listform-new button[name='remove']{display:none}.ui-listform-item-highlight{background-color:rgba(0,0,0,0.1)}.ui-dark .ui-listform-container{border-color:#404040}.ui-dark .ui-listform-form-container{background-color:#282828}.ui-dark .ui-listform-form{border-color:#404040;background-color:#232323}.ui-dark .ui-listform-item{border-bottom-color:#404040}.ui-dark .ui-listform-selected{background-color:#282828}.ui-dark .ui-disabled .ui-listform-item{color:#777}.ui-dark .ui-listform-emptylabel{color:#777}.ui-dark .ui-listform-item-highlight{background-color:rgba(255,255,255,0.1)}

.ui-loading{position:fixed;width:100%;height:100%;background-color:rgba(255,255,255,0.8);left:0;top:0;z-index:1000}.ui-loading-1 > div{background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzgiIGhlaWdodD0iMzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSI4LjA0MiUiIHkxPSIwJSIgeDI9IjY1LjY4MiUiIHkyPSIyMy44NjUlIiBpZD0iYSI+PHN0b3Agc3RvcC1jb2xvcj0iI0EwQTBBMCIgc3RvcC1vcGFjaXR5PSIwIiBvZmZzZXQ9IjAlIi8+PHN0b3Agc3RvcC1jb2xvcj0iI0EwQTBBMCIgc3RvcC1vcGFjaXR5PSIuNjMxIiBvZmZzZXQ9IjYzLjE0NiUiLz48c3RvcCBzdG9wLWNvbG9yPSIjQTBBMEEwIiBvZmZzZXQ9IjEwMCUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zNiAxOGMwLTkuOTQtOC4wNi0xOC0xOC0xOCIgc3Ryb2tlPSJ1cmwoI2EpIiBzdHJva2Utd2lkdGg9IjIiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiBmcm9tPSIwIDE4IDE4IiB0bz0iMzYwIDE4IDE4IiBkdXI9IjAuOXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PC9wYXRoPjxjaXJjbGUgZmlsbD0iI0EwQTBBMCIgY3g9IjM2IiBjeT0iMTgiIHI9IjEiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiBmcm9tPSIwIDE4IDE4IiB0bz0iMzYwIDE4IDE4IiBkdXI9IjAuOXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PC9jaXJjbGU+PC9nPjwvc3ZnPg==) no-repeat 50% 50%;background-size:80px 80px;width:80px;height:80px;position:absolute;left:50%;top:50%;margin:-40px 0 0 -40px}.ui-loading-2 > div{min-height:5px;background-color:#4285f4;width:0;position:absolute;z-index:1;animation:loadinganimation 5s infinite}.ui-loading-1 .ui-loading-text{position:absolute;width:250px;text-align:center;margin:90px 0 0 -125px;left:50%;font-size:12px;color:#000;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.ui-loading-2 .ui-loading-text{font-size:11px;padding:0 5px}.ui-loading-text i{margin-right:5px}.ui-dark .ui-loading{background-color:rgba(0,0,0,0.8)}.ui-dark .ui-loading > div{color:#FFF}@keyframes loadinganimation{0%{left:0}60%{left:0;width:100%}70%{left:70%;width:30%}90%{left:100%;width:30%}100%{left:0;width:0}}

.markdown-small .markdown{font-size:14px;line-height:20px}.markdown{font-size:16px;line-height:22px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';color:#404040;overflow:hidden;padding:0}.markdown-container > *:last-child{margin-bottom:0}.markdown code{font-family:'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;white-space:pre}.markdown h1{cursor:default;margin:0 0 20px;font-size:30px;padding:0 0 13px;border-bottom:1px solid #E0E0E0;color:#000;line-height:38px;font-family:-apple-systm, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';font-weight:normal;line-height:32px;font-weight:bold}.markdown h2{cursor:default;margin:0 0 18px;font-weight:bold;font-size:25px;padding:0 0 8px;border-bottom:1px solid #E0E0E0;color:#000;line-height:28px;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'}.markdown h3{cursor:default;margin:0 0 10px;font-size:20px;padding:0 0 5px;color:#404040;font-weight:bold;line-height:22px;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'}.markdown h4, .markdown h5{cursor:default;margin:0 0 10px;font-size:17px;color:#404040;font-weight:bold;line-height:22px;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';background-color:#F0F0F0;padding:4px 3px;border-radius:var(--radius);border-bottom:1px solid #E0E0E0}.markdown p{margin:0 0 15px;padding-left:0;padding-right:0}.markdown-small p{margin-bottom:10px}.markdown p code, .markdown li code, .markdown section code, .markdown blockquote code, .markdown h1 code, .markdown h2 code, .markdown h3 code, .markdown h4 code, .markdown td code{background-color:#E0E0E0;padding:1px 4px 2px;border-radius:var(--radius);font-size:14px}.markdown p code, .markdown section code, .markdown li code, .markdown blockquote code, .markdown td code{border:1px solid #E0E0E0;background-color:#F5F5F5}.markdown pre{padding:0;border-radius:var(--radius);margin:20px 0;width:100%}.markdown pre code{padding:10px;font-size:14px;line-height:18px;overflow-scrolling:touch;border-radius:var(--radius)}.markdown table{margin:0 0 15px;width:auto !important}.markdown ul{margin:0 0 20px;padding:0 0 0 2em}.markdown ul ul{margin-bottom:0}.markdown img{max-width:100%}.markdown th{background-color:#F8F8F8}.markdown blockquote{color:#000;margin:0 0 15px;padding:10px 0 0 20px;position:relative;font-style:italic}.markdown blockquote:before{content:'\\201C';position:absolute;margin-left:-18px;margin-top:-13px;font:45px 'PT Sans', sans-serif;color:#A0A0A0}.markdown section{padding:15px 20px;background-color:#FFFED1;margin:10px 0 15px;border-radius:var(--radius)}.markdown hr{border-color:#E0E0E0;border-width:2px}.markdown .line2{border-width:4px;margin:15px 0 30px !important}.markdown h1 code{font-size:28px;font-weight:normal;background-color:#DAE8F8}.markdown h2 code{font-size:23px;font-weight:normal;background-color:#DAE8F8}.markdown h3 code{font-size:18px;font-weight:normal;background-color:#DAE8F8}.markdown h4 code{font-size:17px;font-weight:normal;background-color:#DAE8F8}.markdown a code{background-color:#DAE8F8;text-decoration:none !important;border-color:#D5DFEB}.markdown-footnote{background-color:rgba(0,0,0,0.1);padding:0 2px;border-radius:var(--radius);cursor:help}.markdown-footnotebody{font-size:11px;border-top:1px solid #E0E0E0;font-family:Arial;color:#505050}.markdown-showsecret{cursor:pointer;display:block;padding:8px 15px;user-select:none;font-size:14px}.markdown-showsecret b{margin-left:8px}.markdown-showsecret .pull-right{margin:2px 0 0}.markdown-secret{padding:0;border-radius:var(--radius);border:1px solid #E0E0E0}.markdown-secret > div{padding:15px 15px 1px;border-radius:0 0 var(--radius) var(--radius);background-color:#F8F8F8}.markdown-small p code, .markdown-small li code, .markdown-small section code, .markdown-small blockquote code, .markdown-small td code, .markdown-small pre code{font-size:12px}.markdown-tasks{list-style-type:none;padding-left:12px !important}.markdown-tasks li > i:first-child{margin-right:5px}.markdown-code{margin-bottom:15px}.markdown-block{margin:0}.markdown-block:last-child{margin-bottom:15px}.markdown-block > div{padding:10px 10px 1px;border:1px solid #E0E0E0;margin:10px 0;border-radius:var(--radius)}.markdown-showblock{cursor:pointer;display:block;padding:3px 0;user-select:none;border-bottom:1px solid #E0E0E0}.markdown-showblock i{width:16px;font-size:12px;padding:6px 0 0;float:left}.markdown-showblock-visible{border-bottom:0}.markdown-video{position:relative;padding-bottom:56.25%;padding-top:25px;height:0;margin-bottom:15px}.markdown-video iframe{position:absolute;top:0;left:0;width:100%;height:100%}.ui-dark .markdown{color:#C0C0C0}.ui-dark .markdown blockquote{color:#FFF}.ui-dark .markdown blockquote:before{color:#707070}.ui-dark .markdown th{background-color:#404040}.ui-dark .markdown h2{color:#FFF;border-bottom-color:#404040}.ui-dark .markdown h1{color:#FFF;border-bottom-color:#404040}.ui-dark .markdown h1 code{background-color:#404040}.ui-dark .markdown hr{border-color:#404040}.ui-dark .markdown h2 code{background-color:#404040}.ui-dark .markdown h3 code{background-color:#404040}.ui-dark .markdown h4 code{background-color:#404040}.ui-dark .markdown section{background-color:#404040}.ui-dark .markdown a code{background-color:#303030;border-color:#454545}.ui-dark .markdown h4, .ui-dark .markdown h5{color:#C0C0C0;background-color:#505050;border-bottom:1px solid #404040}.ui-dark .markdown p code, .ui-dark .markdown section code, .ui-dark .markdown li code, .ui-dark .markdown blockquote code, .ui-dark .markdown td code{border-color:#404040;background-color:#505050}.ui-dark .markdown-footnote{background-color:rgba(255,255,255,0.1)}.ui-dark .markdown-footnotebody{border-top-color:#505050;color:#888}.ui-dark .markdown-block > div, .ui-dark .markdown-showblock{border-color:#404040}.ui-dark .markdown-secret{border:1px solid #404040}.ui-dark .markdown-secret > div{background-color:#303030}

.ui-menu-area{position:absolute;left:0;right:0;bottom:0;top:0;z-index:100}.ui-menu{position:absolute;z-index:1;transform-origin:top left;padding:10px 0}.ui-menu-items{background-color:#FFF;padding:5px 0;border-radius:var(--radius);box-shadow:2px 5px 10px rgba(0,0,0,0.05);border:1px solid #E0E0E0;position:relative}.ui-menu-submenu{position:absolute;z-index:101;background-color:#FFF;padding:5px 0;border-radius:var(--radius);box-shadow:2px 5px 10px rgba(0,0,0,0.05);border:1px solid #E0E0E0}.ui-menu-visible{}.ui-menu ul{margin:0;padding:0}.ui-menu li{margin:0;padding:5px;list-style-type:none;font-size:12px;cursor:pointer}.ui-menu-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:15px}.ui-menu-note{font-size:10px;margin:0 10px 3px 35px;color:#A0A0A0;line-height:11px}.ui-menu-nofa .ui-menu-note{margin-left:0}.ui-menu-selected{background-color:#F5F5F5}.ui-menu li:hover{background-color:#F0F0F0}.ui-menu-nofa{padding-left:12px !important}.ui-menu .pull-right{margin:1px 5px 0 0;width:20px;text-align:right;font-size:10px}.ui-menu-name i{width:30px;margin:0 5px 0 0;text-align:center;color:#000}.ui-menu-name b{position:absolute;right:10px;font-size:11px;color:gray;margin:1px 5px 0}.ui-menu-divider{padding:0 !important;background:transparent !important;cursor:default !important;color:gray;font-size:11px !important}.ui-menu-divider span{display:block;margin:5px 12px}.ui-menu-divider hr{margin:5px 0;border-color:#E0E0E0}.ui-menu li.ui-menu-disabled{color:#a0a0a0;background-color:#FFF;cursor:not-allowed}.ui-menu li.ui-menu-disabled i{color:#c5c5c5}.ui-menu-style-2 .ui-menu-items{border-radius:var(--radius)}.ui-menu-style-2 li{margin:2px 10px;padding:7px 2px;border-radius:var(--radius);font-size:13px}.ui-menu-style-2 .pull-right{margin-top:3px}.ui-menu-style-2 .ui-menu-submenu{border-radius:var(--radius)}.ui-menu-style-2 .ui-menu-divider{margin:7px 0}.ui-menu-style-2 .ui-menu-divider span{padding-left:10px}.ui-dark .ui-menu b{color:#505050}.ui-dark .ui-menu-items,.ui-dark .ui-menu-submenu{background-color:#303030;border-color:#353535;box-shadow:1px 5px 10px rgba(0,0,0,0.2)}.ui-dark .ui-menu-name i{color:#FFF}.ui-dark .ui-menu-selected{background-color:#252525}.ui-dark .ui-menu li:hover{background-color:#202020}.ui-dark .ui-menu-divider hr{border-color:#404040}.ui-dark .ui-menu-note{color:#777}.ui-dark .ui-menu li.ui-menu-disabled{background-color:#303030;color:#656565}.ui-dark .ui-menu li.ui-menu-disabled i{color:#525252}.ui-large .ui-menu-divider{font-size:14px !important}.ui-large .ui-menu li{font-size:14px;padding:7px 15px}.ui-large.ui-menu li{font-size:14px;padding:7px 15px}.ui-large .ui-menu-note{font-size:13px}@media (max-width:600px){.ui-menu-mobile.ui-menu-style-1 .ui-menu-divider{margin:9px 0;font-size:13px !important}.ui-menu-mobile.ui-menu-style-1 li{margin:0;padding:7px 10px;list-style-type:none;font-size:17px;cursor:pointer}.ui-menu-mobile.ui-menu-style-2 li{margin:2px 10px;padding:8px 5px;border-radius:var(--radius);font-size:17px}.ui-menu-mobile.ui-menu-style-2 .ui-menu-divider{margin:9px 0;font-size:13px !important}.ui-menu-mobile.ui-menu-style-2 .ui-menu-divider span{padding-left:12px}.ui-menu-mobile .ui-menu-note{font-size:12px}}

.ui-message{background-color:rgba(255,255,255,0.9);position:fixed;left:0;right:0;bottom:0;top:0;z-index:1010;width:100%;display:table;height:100%;transition:0.3s all;opacity:0}.ui-message > div{display:table-cell;vertical-align:middle;text-align:center;padding:15px}.ui-message-body{padding:30px 25px 20px;position:relative;display:inline-block;color:#000;border-radius:var(--radius);max-width:500px;text-align:left;transform:scale(1.5);transition:0.2s all;box-shadow:0 5px 20px rgba(0,0,0,0.1);background-color:#FFF;border-width:3px;border-style:solid}.ui-message-warning .ui-message-body{border-color:#DA4453;min-width:300px}.ui-message-success .ui-message-body{border-color:#8CC152;min-width:300px}.ui-message-info .ui-message-body{border-color:var(--color);min-width:300px}.ui-message button{display:block;min-width:100px;margin:20px auto 0;cursor:pointer;outline:0;background-color:#FFF;border:1px solid #E0E0E0;border-radius:var(--radius);color:#000;padding:0 20px;height:34px;font-weight:bold}.ui-message button:hover{background-color:#F0F0F0}.ui-message button:active{border-color:#D0D0D0}.ui-message-icon{border-radius:100px;width:60px;height:60px;padding:0;line-height:54px;font-size:30px;text-align:center;position:absolute;left:50%;border:4px solid #3BAFDA;margin-left:-30px;z-index:5;background-color:#FFF;color:#3BAFDA;margin-top:-40px;transform:scale(2);transition:all 0.3s}.ui-message-icon-animate{transform:scale(1)}.ui-message-success .ui-message-icon{border-color:#8CC152;color:#8CC152}.ui-message-warning .ui-message-icon{border-color:#DA4453;color:#DA4453}.ui-message-info .ui-message-icon{border-color:var(--color);color:var(--color)}.ui-message-error i{margin-right:5px;color:red}.ui-message-visible{opacity:1}.ui-message-visible .ui-message-body{transform:scale(1)}.ui-message2{background-color:rgba(220,220,220,0.9)}.ui-message2 .ui-message-body{padding:110px 0 0;border-width:0;border-radius:var(--radius);max-width:400px}.ui-message2 .ui-message-text{padding:0 20px 30px;text-align:center}.ui-message2 hr{display:none}.ui-message2 button{width:100%;border:0 !important;color:#FFF;border-radius:0 0 var(--radius) var(--radius);height:40px;margin:0}.ui-message2 button:hover{opacity:0.9}.ui-message2.ui-message-success button{background-color:#8CC152}.ui-message2.ui-message-warning button{background-color:#DA4453}.ui-message2.ui-message-info button{background-color:var(--color)}.ui-message2 .ui-message-icon{margin-top:30px;border-radius:0;border:0;background:transparent !important;font-size:50px}.ui-dark .ui-message2,.ui-dark .ui-message{background-color:rgba(50,50,50,0.9)}.ui-dark .ui-message-body{background-color:#202020;color:#FFF}.ui-dark .ui-message button{background-color:#404040;border-color:#404040;color:#FFF}.ui-dark .ui-message button:hover{background-color:#444}.ui-dark .ui-message button:active{border-color:#505050}.ui-dark .ui-message2.ui-message-success button{background-color:#8CC152}.ui-dark .ui-message2.ui-message-warning button{background-color:#DA4453}.ui-dark .ui-message2.ui-message-info button{background-color:var(--color)}.ui-dark .ui-message-icon{background-color:#202020}.ui-dark .ui-message hr{border-color:#404040}

.ui-miniform-noscroll,.ui-miniform-noscroll body{overflow:hidden}.ui-miniform-container{width:100%;position:fixed;left:0;top:0;bottom:0;right:0;background-color:rgba(230,233,237,0.8);z-index:5;overflow-y:scroll;transform-style:preserve-3d;overflow-scrolling:touch;padding:15px}.ui-miniform-container-table{display:table;width:100%;height:100%}.ui-miniform-container-cell{display:table-cell;width:100%;height:100%;vertical-align:middle;text-align:center}.ui-miniform{background-color:#FFF;border-radius:var(--radius);box-shadow:0 10px 30px rgba(0,0,0,0.1);transform:scale(0);transition:all 0.15s;opacity:0;text-align:left;position:relative;margin:0 auto}.ui-miniform-animate{transform:scale(1);opacity:1}.ui-miniform-title{padding:18px 15px 18px 20px;font-size:18px;user-select:none;color:#000;background-color:#FFF;border-bottom:1px solid #E0E0E0;height:58px;border-radius:var(--radius) var(--radius) 0 0}.ui-miniform-title .ui-miniform-button-close{float:right;cursor:pointer;font-size:18px;margin:1px 0 0;transition:all 0.2s;background:none;border:0;outline:0;height:auto;color:red;text-align:right !important;width:20px;padding:0}.ui-miniform-title .ui-miniform-button-close i{font-weight:bold}.ui-miniform-title .ui-miniform-button-close:hover{transform:scale(1.1)}.ui-miniform-title > span{font-weight:bold}.ui-miniform-title i{margin-right:7px}.ui-miniform > nav{padding:0 15px 0;border-top:1px solid #E0E0E0;background-color:#FFF;border-radius:0 0 var(--radius) var(--radius);line-height:65px;height:65px;display:block;float:none;position:relative}.ui-miniform > nav button{border:0;margin:15px 0 0;background-color:#F0F0F0;height:34px;padding:0 15px;color:#000;cursor:pointer;font-family:Arial;line-height:34px;vertical-align:middle;outline:0;font-size:14px;text-decoration:none;transition:all 0.3s;float:left;width:50%}.ui-miniform > nav button i{width:15px;text-align:center;margin-right:5px}.ui-miniform > nav button:hover{opacity:0.9}.ui-miniform > nav button:active{background-color:#D0D0D0}.ui-miniform > nav button:disabled{background-color:#F5F5F5 !important;border-color:#E0E0E0 !important;color:silver !important;cursor:not-allowed;box-shadow:none}.ui-miniform > nav button:first-child{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.ui-miniform > nav button:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-miniform > nav button[name='submit']{font-weight:bold;background-color:var(--color);color:#FFF}.ui-dark .ui-miniform-container{background-color:rgba(50,50,50,0.9)}.ui-dark .ui-miniform{background-color:#202020}.ui-dark .ui-miniform-title{background-color:#202020;border-bottom-color:#303030;color:#FFF}.ui-dark .ui-miniform > nav{background-color:#202020;border-top-color:#303030}.ui-dark .ui-miniform nav button{border-color:#202020;background-color:#505050;color:#E0E0E0}.ui-dark .ui-miniform > nav button[name='submit']{background-color:var(--color);color:#FFF}.ui-dark .ui-miniform > nav button:active{background-color:#404040}.ui-dark .ui-miniform > nav button:disabled{background-color:#303030 !important;color:#606060 !important;border-color:#202020 !important}

.ui-viewbox{overflow:hidden;-ms-overflow-style:none;box-sizing:content-box}.ui-viewbox-disabled{z-index:5;position:absolute;background-color:rgba(255,255,255,0.8)}.ui-viewbox-hidden{visibility:hidden}.ui-viewbox-centered-table{display:table;width:100%;height:100%}.ui-viewbox-centered-cell{display:table-cell;width:100%;height:100%;vertical-align:middle;text-align:center}

.ui-notify-container{position:fixed;max-width:400px;z-index:100;text-align:center;width:100%}.ui-notify{height:80px;transition:0.15s transform,opacity;transform:scale(1);transition-timing-function:ease-in;opacity:1}.ui-notify figure{background-color:#FFF;box-shadow:0 3px 20px rgba(0,0,0,0.2);border-radius:var(--radius);font-size:14px;padding:0;color:#000;cursor:default;position:relative;height:60px;display:block}.ui-notify-dot{width:10px;height:10px;position:absolute;border-radius:var(--radius) var(--radius) var(--radius) var(--radius);right:5px;bottom:5px}.ui-notify-1 .ui-notify-dot{background-color:#8CC152}.ui-notify-2 .ui-notify-dot{background-color:#F43D35}.ui-notify-3 .ui-notify-dot{background-color:var(--color)}.ui-notify-1 .ui-notify-icon{color:#8CC152}.ui-notify-2 .ui-notify-icon{color:#F43D35}.ui-notify-3 .ui-notify-icon{color:var(--color)}.ui-notify-icon{float:left;font-size:25px;padding:0 0 0 10px;width:50px;text-align:center;height:60px;line-height:60px;border-radius:var(--radius) 0 0 var(--radius)}.ui-notify-message{margin:1px 0 0 60px;line-height:16px;height:60px;display:table-cell;width:100%;vertical-align:middle;padding:0 10px;text-align:left}.ui-notify-hidden{transform:scale(0.7);opacity:0.1}.ui-notify-container-top{left:50%;margin-left:-200px;top:20px}.ui-notify-container-top-left{left:25px;top:20px}.ui-notify-container-top-right{right:25px;top:20px}.ui-notify-container-bottom{bottom:10px;left:50%;margin-left:-150px}.ui-notify-container-bottom-left{bottom:10px;left:25px}.ui-notify-container-bottom-right{bottom:10px;right:25px}@media(max-width:767px){.ui-notify-container{left:20px;right:20px;margin-left:0;width:auto}}.ui-dark .ui-notify figure{background-color:#444;box-shadow:0 3px 20px rgba(0,0,0,0.3);color:#FFF}

.ui-notifybar{position:fixed;left:20px;right:20px;z-index:100;bottom:20px;border-radius:100px;background-color:#FFF;box-shadow:0 -2px 10px rgba(0,0,0,0.05);height:40px;border:1px solid #E0E0E0}.ui-notifybar-controls button{border:0;background:transparent;border-radius:var(--radius);height:37px;width:22px;padding:0;margin:1px 0 0;color:#000}.ui-notifybar-controls button:hover{color:gray}.ui-notifybar-controls button:disabled{color:silver;cursor:not-allowed}.ui-notifybar-controls{border-right:1px solid #E0E0E0;height:38px;float:left;width:55px;text-align:center}.ui-notifybar-body{margin-left:65px;line-height:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ui-notifybar-body i{margin-right:5px}.ui-notifybar-1 .ui-notifybar-body i{color:#8CC152}.ui-notifybar-2 .ui-notifybar-body i{color:#DB3737}.ui-notifybar-3 .ui-notifybar-body i{color:#4285F4}.ui-dark .ui-notifybar{background-color:#282828;border-color:#404040}.ui-dark .ui-notifybar-controls button{color:#FFF}.ui-dark .ui-notifybar-controls button:disabled{color:#505050}.ui-dark .ui-notifybar-controls{border-right-color:#404040}

.ui-objecttree{font-family:Menlo,Consolas,monospace;font-size:10px;color:#000;overflow:hidden;white-space:pre-wrap}.ui-objecttree-item{margin-left:16px;position:relative}.ui-objecttree-item-key:hover{background-color:#f6f6f6}.ui-objecttree-key{color:#1A8B95}.ui-objecttree-number{color:#6d49ff}.ui-objecttree-boolean{color:#1B7F16}.ui-objecttree-null{color:#777;font-style:italic}.ui-objecttree-string{color:#ff6e6e}.ui-objecttree-date{color:#acacac}.ui-objecttree-item > div:not(.ui-objecttree-item):hover > .toolbox,.ui-objecttree-item:hover > .toolbox{display:block}.ui-objecttree .toolbox{display:none;position:absolute;right:0;top:-3px;background-color:#e2e2e2;padding:2px 4px;border-radius:3px;font-size:12px;color:#8e8e8e;cursor:pointer}.ui-objecttree .toolbox i{margin-right:4px}.ui-objecttree .toolbox i:hover{margin-right:4px;color:black}.ui-objecttree .toolbox i:last-child{margin-right:0}.ui-objecttree .ml{margin-left:16px}.ti-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.ui-objecttree .ti.ti-chevron-down{font-size:10px;margin-right:4px;padding:1px 2px;background-color:#c6c6c6;border-radius:2px;cursor:pointer}.ui-objecttree .ti.ti-chevron-down.ti-rotate-270{background-color:#9fb0ff}.ui-dark .ui-objecttree{color:#A0A0A0;background-color:#404040 !important}.ui-dark .ui-objecttree-item-key:hover{background-color:#353535}.ui-dark .ui-objecttree .toolbox{background-color:#6e6e6e;color:#cbcbcb}.ui-dark .ui-objecttree .ti.ti-chevron-down{background-color:#414141}.ui-dark .ui-objecttree .ti.ti-chevron-down.ti-rotate-270{background-color:#9fb0ff;color:#e5e5e5}.ui-dark .ui-objecttree .toolbox i:hover{color:white}

.page{position:absolute;z-index:10;background-color:#FFF}

.ui-part-absolute{position:absolute;z-index:10;background-color:#FFF}

.ui-parts-item{display:none}.ui-parts-focused{display:block}

.ui-progress{background-color:#F0F0F0;border-radius:var(--radius);box-sizing:border-box}.ui-progress div{background-size:56px 56px;animation:progress 20s infinite linear forwards;margin-right:30px;background-image:repeating-linear-gradient(45deg,#4285F4,#4285F4 10px,#4993E7 10px,#4993E7 20px);text-align:right;font-size:10px;color:#FFF;padding:2px 5px 0 0;height:18px;font-weight:bold;border-radius:3px;min-width:30px}.ui-dark .ui-progress{background-color:#303030}@keyframes progress{from{background-position:0% 0%}to{background-position:100% 0%}}

.ui-properties2-group:first-child{margin-top:10px}.ui-properties2-group:last-child section{margin-bottom:0}.ui-properties2-group{padding:0;margin-bottom:20px;border:1px solid #E0E0E0;border-radius:var(--radius) var(--radius) 0 0}.ui-properties2-2 .ui-properties2-group{border:0}.ui-properties2-group label{display:block;padding:10px 15px;font-size:16px;font-weight:bold;background-color:#F8F8F8;border-radius:var(--radius) var(--radius) 0 0}.ui-properties2-2 label{background:transparent;font-size:11px;color:#A0A0A0;font-weight:normal;padding-bottom:5px}.ui-properties2-2 section{background:#FFF;border-radius:15px;padding:10px 0;border:1px solid #E0E0E0}.ui-properties2-group label i{width:22px}.ui-properties2-group label i:before{content:'\\f146'}.ui-properties2-hidden label i:before{content:'\\f0fe' !important}.ui-properties2-hidden section{display:none}.ui-properties2-item{padding:6px 0;background-color:#FFF;font-size:12px;border-top:1px solid #EBEBEB}.ui-properties2-2 .ui-properties2-item{border-top-color:#ECECEC;margin:0 15px}.ui-properties2-2 .ui-properties2-item:last-child div{border-bottom:0}.ui-properties2-item > i{float:left;width:24px;height:24px;margin:10px 5px 0 0;font-size:20px}.ui-properties2-2 .ui-properties2-item > i{margin-top:8px;background:#606060;border-radius:6px;font-size:14px;color:#FFF;text-align:center;line-height:24px;width:24px;height:24px}.ui-properties2-isnote > i{margin-top:17px !important}.ui-properties2-required .ui-properties2-key:after{content:'*';color:red;margin-left:5px;font-weight:bold}.ui-properties2-key{float:left;width:170px;line-height:24px;padding:0 5px 0 15px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:#707070}.ui-properties2-key i{margin-right:7px}.ui-properties2-2 .ui-properties2-item{cursor:pointer}.ui-properties2-2 .ui-properties2-text:empty::after{content:"\\00a0\\0020"}.ui-properties2-2 .ui-properties2-value{margin-left:170px;text-align:right;color:#777;margin-right:0;line-height:21px;font-weight:normal !important;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ui-properties2-2 .ui-properties2-item{font-size:13px;padding:0;border-top:0}.ui-properties2-2 .ui-properties2-item > div{padding:10px 0 8px;border-bottom:1px solid #E0E0E0}.ui-properties2-2 .ui-properties2-isicon > div{margin-left:40px}.ui-properties2-2 .ui-properties2-key{color:#000;padding-left:0;line-height:20px}.ui-properties2-2 .ui-properties2-color span b{width:19px;border-radius:100%}.ui-properties2-value{margin:0 10px 0 170px;line-height:21px}.ui-properties2-note{color:#A0A0A0;font-size:11px;line-height:13px;font-weight:normal}.ui-properties2-string, .ui-properties2-number, .ui-properties2-date, .ui-properties2-list, .ui-properties2-menu, .ui-properties2-file{padding:0}.ui-properties2-string input, .ui-properties2-number input, .ui-properties2-date input{outline:0;height:21px;padding:0;margin:0;width:100%;border:0;line-height:21px;background-color:transparent}.ui-properties2-2 input{text-align:right;color:#777;height:17px}.ui-properties2 input:disabled{color:#A0A0A0}.ui-disabled .ui-properties2-value{color:#A0A0A0;cursor:default}.ui-disabled .ui-properties2-value *{cursor:default}.ui-properties2-date > i{float:right;width:18px;margin:4px 0 0;text-align:right;font-size:12px}.ui-properties2-date > div{margin-right:18px}.ui-properties2-bool, .ui-properties2-list, .ui-properties2-menu, .ui-properties2-color, .ui-properties2-fontawesome, .ui-properties2-emoji, .ui-properties2-file{line-height:22px}.ui-properties2-bool span{width:32px;height:18px;display:inline-block;border:1px solid #E0E0E0;line-height:15px;font-size:9px;margin:3px 0 5px;position:relative;cursor:pointer;color:#FFF;vertical-align:top;border-radius:100px;background:#E0E0E0;transition:all 0.3s;text-align:left}.ui-properties2-2 .ui-properties2-bool span{margin-top:0}.ui-properties2-bool span i{width:16px;height:16px;position:relative;display:inline-block;border-radius:100px;background:#FFF;transition:margin 0.3s}.ui-properties2-bool .checked{background-color:var(--color);border-color:var(--color)}.ui-properties2-bool .checked i{margin-left:14px}.ui-disabled .ui-properties2-bool .checked{background-color:#A0A0A0;border-color:#A0A0A0}.ui-properties2-fontawesometoggle, .ui-properties2-emojitoggle, .ui-properties2-color{width:22px;line-height:22px;display:block;cursor:pointer;font-size:20px;position:relative;text-align:left;margin-bottom:3px;display:inline-block;margin-right:1px}.ui-properties2-2 .ui-properties2-fontawesometoggle, .ui-properties2-2 .ui-properties2-emojitoggle, .ui-properties2-2 .ui-properties2-color{margin-bottom:0}.ui-properties2-fontawesometoggle{height:22px}.ui-properties2-2 .ui-properties2-fontawesometoggle{height:auto}.ui-properties2-list, .ui-properties2-menu, .ui-properties2-exec{cursor:pointer}.ui-properties2-list i, .ui-properties2-menu i, .ui-properties2-exec i{margin-left:7px}.ui-properties2-list i, .ui-properties2-menu i{float:right;width:20px;line-height:23px;text-align:right;font-size:12px}.ui-properties2-list span, .ui-properties2-menu span{display:block;margin-right:25px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.ui-properties2-2 .ui-properties2-list span, .ui-properties2-2 .ui-properties2-menu span{margin-right:0 !important}.ui-properties2-2 .ui-properties2-date > i{margin-top:3px}.ui-properties2-2 .ui-properties2-list span, .ui-properties2-2 .ui-properties2-menu span{margin-right:18px}.ui-properties2-2 .ui-properties2-list i, .ui-properties2-2 .ui-properties2-menu i{width:18px;color:#A0A0A0}.ui-properties2-file{cursor:pointer}.ui-properties2-file i{float:right;width:20px;line-height:22px;text-align:right;font-size:10px}.ui-properties2-file span{display:block;margin-right:25px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.ui-properties2-changed{font-weight:bold}.ui-properties2-changed .ui-properties2-key{color:#000}.ui-properties2-color{padding:0;line-height:12px}.ui-properties2-color span b{height:18px;display:block;border-radius:var(--radius);color:gray;width:60px}.ui-properties2-invalid{font-weight:bold;color:red !important}.ui-properties2-invalid .ui-properties2-key{border-right-color:red !important}.ui-properties2-camouflage input{filter:blur(3px)}.ui-properties2-camouflage input:focus{filter:unset}.ui-properties2-ricon{float:right;width:34px;height:24px;line-height:20px;text-align:center;color:gray;font-weight:normal}.ui-properties2-ricon i{font-size:14px;color:#000;padding:5px 0 0;display:block}.ui-properties2-isricon .ui-properties2-value{margin-right:34px}.ui-properties2-2 .ui-properties2-ricon i{padding:3px 0 0}.ui-properties2-2 .ui-properties2-ricon{line-height:20px}.ui-properties2-value.right input{text-align:right}.ui-properties2-value.center input{text-align:center}#properties2upload{position:absolute;left:-100px;top:-100px;opacity:0}.ui-dark .ui-properties2-group{border-color:#404040}.ui-dark .ui-properties2-item{border-color:#303030;background-color:#202020}.ui-dark .ui-properties2-item > div{border-bottom-color:#404040}.ui-dark .ui-properties2-2 section, .ui-dark .ui-properties2-2 .ui-properties2-item{background-color:#282828}.ui-dark .ui-properties2-2 section{border-color:#252525}.ui-dark .ui-properties2-key{color:#A0A0A0}.ui-dark .ui-properties2-2 .ui-properties2-key{color:#FFF}.ui-dark .ui-properties2-group label{background-color:#282828}.ui-dark .ui-properties2-2 label{background-color:transparent}.ui-dark .ui-properties2-bool span{border-color:#505050;background-color:#505050}.ui-dark .ui-properties2-bool span.checked{border-color:var(--color);background-color:var(--color)}.ui-dark .ui-properties2-changed .ui-properties2-key{color:#FFF}.ui-dark .ui-properties2-note{color:#606060}.ui-dark .ui-properties2-list i, .ui-dark .ui-properties2-menu i, .ui-dark .ui-properties2-date{color:gray}.ui-dark .ui-properties2-ricon{color:#888}.ui-dark .ui-properties2-ricon i{color:#FFF}

.ui-searchinput{height:30px;border:1px solid #E0E0E0}.ui-searchinput-left > span{float:left}.ui-searchinput-left > div{margin-left:28px}.ui-searchinput-right > span{float:right}.ui-searchinput-right > div{margin-right:28px;padding-left:5px}.ui-searchinput input{border:0;width:100%;background-color:transparent;outline:0;margin:0;padding:0;height:28px;font-size:12px}.ui-searchinput span{width:28px;text-align:center;font-size:12px;line-height:29px;color:gray}.ui-searchinput-is span{cursor:pointer;color:red}.ui-dark .ui-searchinput{border-color:#404040}

.ui-tabmenu{padding:0;margin:0 0 10px;display:block;position:relative;font-size:12px;list-style-type:none;height:26px}.tabmenu{padding:0;margin:0 0 10px;display:block;position:relative;font-size:12px;list-style-type:none;height:26px}.ui-tabmenu li{float:left;line-height:26px;border:0;margin:0 1px 0 0;padding:0;background-color:#F0F0F0;text-align:center;color:gray;cursor:pointer;min-width:80px}.ui-tabmenu li:first-child{border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius)}.ui-tabmenu li:last-child{border-top-right-radius:var(--radius);border-bottom-right-radius:var(--radius)}.ui-tabmenu .selected{background-color:var(--color);color:#FFF}.ui-tabmenu i{margin-right:5px}.ui-tabmenu.ui-disabled .selected{background-color:#E0E0E0}.ui-tabmenu.ui-disabled li{cursor:not-allowed;color:#A0A0A0}.ui-dark .ui-tabmenu li{background-color:#303030;color:#A0A0A0}.ui-dark .ui-tabmenu .selected{background-color:var(--color);color:#FFF}.ui-dark .ui-tabmenu.ui-disabled .selected{background-color:#404040}.ui-dark .ui-tabmenu.ui-disabled li{color:#888}

.json{font-family:Menlo,Consolas,monospace;color:#000;tab-size:2;overflow:hidden;white-space:pre-wrap}.json-key{color:#1A8B95}.json-number{color:#3990B5}.json-true{color:#1B7F16}.json-false{color:#9C251D}.json-null{color:#777;font-style:italic}.json-uid{color:#1A4795}.json-color i{margin-right:5px;vertical-align:middle}.json-icon{color:#451393}.json-icon i{margin-right:5px;vertical-align:middle}.json-date{color:#BF3CB3}.ui-dark .json{color:#A0A0A0}

.ui-textarea{border:1px solid #E0E0E0;padding:0;border-radius:var(--radius);position:relative;display:block;width:100%;background-color:#FFF;overflow:hidden}.ui-textarea-placeholder{position:absolute;top:3px;left:5px;cursor:text;color:#6f6f6f;user-select:none;font-size:13px}.ui-textarea textarea{border:0;width:100%;height:100%;outline:0;font:normal 13px Arial;color:#000;resize:none;min-height:50px;background-color:#FFF;padding:4px 5px}.ui-textarea-label{margin-bottom:3px;font-size:12px;text-align:left}.ui-textarea-label .ti{margin-right:5px}.ui-textarea-required .ui-textarea-label{font-weight:bold}.ui-textarea-required .ui-textarea-label:before{color:red;content:'***';margin-right:5px}.ui-textarea-required .ui-textarea{border-color:#D0D0D0}.ui-textarea-invalid .ui-textarea{border-color:red !important}.ui-textarea-monospace textarea{font-family:monospace;font-size:14px}.ui-textarea-helper{margin-top:8px;font-size:11px;color:red;text-align:left;display:none}.ui-textarea-helper-show{display:block}.ui-disabled.ui-textarea{background-color:#F0F0F0;cursor:not-allowed}.ui-disabled .ui-textarea-placeholder{cursor:not-allowed}.ui-disabled.ui-textarea textarea{background-color:#F0F0F0;color:gray}.ui-disabled .ui-textarea{background-color:#F0F0F0}.ui-disabled .ui-textarea textarea{background-color:#F0F0F0;cursor:not-allowed;color:gray}.ui-textarea-noscrollbar textarea::-webkit-scrollbar{display:none}.ui-textarea-noscrollbar textarea{-ms-overflow-style:none;scrollbar-width:none}.ui-dark .ui-textarea{border-color:#353535;background-color:#202020}.ui-dark .ui-textarea textarea{color:#FFF;background-color:#202020}.ui-dark .ui-textarea-required .ui-textarea-label:before{color:red}.ui-dark .ui-textarea-required .ui-textarea{border-color:#454545}.ui-dark .ui-textarea-invalid .ui-textarea{border-color:red !important}.ui-dark .ui-disabled.ui-textarea{background-color:#282828}.ui-dark .ui-disabled.ui-textarea textarea{background-color:#282828;color:#707070}.ui-dark .ui-disabled .ui-textarea{background-color:#282828}.ui-dark .ui-disabled .ui-textarea textarea{background-color:#282828;color:#707070}

.ui-textboxlist-label{margin-bottom:3px;font-size:12px;text-align:left}.ui-textboxlist-label-required:before{color:red;content:'***';margin-right:5px}.ui-textboxlist-label i{margin-right:5px}.ui-textboxlist-items > div:first-child{border-radius:var(--radius) var(--radius) 0 0}.ui-textboxlist-item{height:36px;background-color:#FFF;border:1px solid #E0E0E0;border-bottom:0}.ui-textboxlist-item > div:first-child{float:right;width:36px;text-align:center;color:#555;font-size:14px;height:35px;border-left:1px solid #E0E0E0}.ui-textboxlist-remove{color:#DA4453}.ui-textboxlist-item > div:last-child{padding:4px 0 0;margin-right:36px}.ui-textboxlist-item i{cursor:pointer;display:block;line-height:35px;text-align:center;float:left;width:36px;border-left:1px solid #E0E0E0}.ui-textboxlist-item i:first-child{border-left:0}.ui-textboxlist-item i:active{margin-top:1px}.ui-textboxlist-item input{width:100%;background-color:transparent;border:0;padding:1px 10px 0;border-radius:var(--radius);outline:0;font-size:13px;color:#000;line-height:26px}.ui-textboxlist-base{border-radius:0 0 var(--radius) var(--radius);border-bottom:1px solid #E0E0E0}.ui-textboxlist-base > div:first-child{display:none}.ui-textboxlist-helper{margin-top:8px;font-size:11px;color:red !important;text-align:left}.ui-textboxlist-empty .ui-textboxlist-base{border-radius:var(--radius)}.ui-textboxlist-item-invalid input{color:red}.ui-textboxlist-movable .ui-textboxlist-item > div:last-child{margin-right:110px}.ui-textboxlist-movable .ui-textboxlist-item > div:first-child{width:110px}.ui-dark .ui-textboxlist-item{border-color:#404040}.ui-dark .ui-textboxlist-item{background-color:#202020;border-color:#404040}.ui-dark .ui-textboxlist-item > div:first-child{color:#999;border-left-color:#404040}.ui-dark .ui-textboxlist-item input{background-color:transparent;color:#FFF}.ui-dark .ui-textboxlist-base{border-bottom-color:#404040}.ui-dark .ui-textboxlist-helper{color:red !important}.ui-dark .ui-textboxlist-item i{border-left-color:#404040}

.ui-timepicker{position:absolute;background-color:#FFF;border-radius:var(--radius);height:70px;font-size:14px;box-shadow:0 2px 5px rgba(0,0,0,0.1);transition:all 0.25s;transform:scale(0.5);transform-origin:left top;border:1px solid #E0E0E0;z-index:100}.ui-timepicker-visible{transform:scale(1)}.ui-timepicker-0{width:82px}.ui-timepicker-1{width:122px}.ui-timepicker-2{width:162px}.ui-timepicker i{display:block;text-align:center;cursor:pointer;height:20px}.ui-timepicker i:hover{color:gray}.ui-timepicker > div{float:left;width:40px}.ui-timepicker > div .ti-chevron-up{padding-top:5px}.ui-timepicker-hours{border-right:1px solid #F0F0F0}.ui-timepicker-seconds{border-left:1px solid #F0F0F0}.ui-timepicker-ampm{border-left:1px solid #F0F0F0}.ui-timepicker-ampm span{height:30px;display:block;line-height:30px;text-align:center}.ui-timepicker input{display:block;width:100%;border:0;background-color:#FFF;text-align:center;outline:0;height:30px;color:#000}.ui-dark .ui-timepicker{background-color:#303030;border-color:#353535;color:#A0A0A0;box-shadow:1px 5px 10px rgba(0,0,0,0.2)}.ui-dark .ui-timepicker input{background-color:#303030;color:#FFF}.ui-dark .ui-timepicker-hours{border-right-color:#353535}.ui-dark .ui-timepicker-seconds{border-left-color:#353535}.ui-dark .ui-timepicker i{color:#A0A0A0}.ui-dark .ui-timepicker i:hover{color:#FFF}

.ui-togglebutton{background-color:#FFF;margin:5px 0;border-radius:20px;border:2px solid #D0D0D0;height:24px;cursor:pointer;width:50px;position:relative;display:inline-block;user-select:none;-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}.ui-togglebutton button{cursor:pointer;outline:0;display:block;position:absolute;left:0;top:0;border-radius:100%;width:26px;height:26px;background-color:#FFF;float:left;margin:-3px 0 0 -3px;border:2px solid #D0D0D0;transition:left 0.3s;padding:0;color:#C0C0C0}.ui-togglebutton-selected{background-color:#83B152;border:2px solid #7DA652}.ui-togglebutton-selected button{left:26px;top:0;margin:0;border:0;width:20px;height:20px;box-shadow:0 0 4px rgba(0,0,0,0.1);font-size:11px;color:#000}.ui-togglebutton-invalid{border-color:#DA362D !important}.ui-togglebutton.ui-disabled{background-color:#A0A0A0 !important;border:gray !important;cursor:not-allowed !important}.ui-dark .ui-togglebutton{background-color:#202020;border-color:#404040}.ui-dark .ui-togglebutton button{background-color:#606060;border-color:#606060;color:#999}.ui-dark .ui-togglebutton-selected{background-color:#83B152;border-color:#7DA652}.ui-dark .ui-togglebutton-selected button{background-color:#FFF;color:#000}

[tooltip]{margin:20px;position:relative}[tooltip]::before{content:'';position:absolute;top:-8px;left:50%;transform:translateX(-50%);border-width:5px 7px 0 7px;border-style:solid;border-color:rgba(0,0,0,0.9) transparent transparent transparent;opacity:0;z-index:1000}[tooltip]::after{content:attr(tooltip);position:absolute;left:50%;top:-8px;transform:translateX(-50%) translateY(-100%);background:rgba(0,0,0,0.9);text-align:center;color:#fff;padding:4px 2px;font-size:12px;min-width:80px;border-radius:3px;pointer-events:none;opacity:0;z-index:1000}[tooltip]:hover::after, [tooltip]:hover::before{opacity:1;transition-delay:0.1s}[tooltip-position='left']::before{left:0%;top:50%;margin-left:-12px;transform:translatey(-50%) rotate(-90deg)}[tooltip-position='top']::before{left:50%}[tooltip-position='bottom']::before{top:100%;margin-top:8px;transform:translateX(-50%) translatey(-100%) rotate(-180deg)}[tooltip-position='right']::before{left:100%;top:50%;margin-left:1px;transform:translatey(-50%) rotate(90deg)}[tooltip-position='left']::after{left:0%;top:50%;margin-left:-7px;transform:translateX(-100%) translateY(-50%)}[tooltip-position='top']::after{left:50%}[tooltip-position='bottom']::after{top:100%;margin-top:7px;transform:translateX(-50%) translateY(0%)}[tooltip-position='right']::after{left:100%;top:50%;margin-left:10px;transform:translateX(0%) translateY(-50%)}.ui-dark [tooltip]::after{background:rgba(255,255,255,0.9);color:#000}.ui-dark [tooltip]::before{border-color:rgba(255,255,255,0.9) transparent transparent transparent}

.ui-viewbox{overflow:hidden;-ms-overflow-style:none;box-sizing:content-box}.ui-viewbox-disabled{z-index:5;position:absolute;background-color:rgba(255,255,255,0.8)}.ui-viewbox-hidden{visibility:hidden}.ui-viewbox-centered-table{display:table;width:100%;height:100%}.ui-viewbox-centered-cell{display:table-cell;width:100%;height:100%;vertical-align:middle;text-align:center}

.ui-windows-item{position:absolute;border-radius:var(--radius);box-shadow:0 10px 20px rgba(0,0,0,0.03);background-color:#FFF;z-index:4}.ui-windows-title{border:1px solid #E0E0E0;border-radius:var(--radius) var(--radius) 0 0;height:32px}.ui-windows-control{float:right;width:30px;text-align:center;border-left:1px solid #E0E0E0;line-height:30px;cursor:pointer;font-size:13px}i.ui-windows-control{transform:scale(1);font-size:16px}.ui-windows-control:hover{background-color:#F9F9F9}.ui-windows-control.ti-times{color:red;border-radius:0 var(--radius) 0 0}.ui-windows-title span{cursor:default;line-height:31px;display:block;margin-right:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 0 0 10px;font-weight:bold}.ui-windows-nomove .ui-windows-title span{cursor:default}.ui-windows-title span i{margin-right:5px}.ui-windows-body{border:1px solid #E0E0E0;border-top:0;border-radius:0 0 var(--radius) var(--radius);overflow-x:hidden}.ui-windows-moving .ui-windows-item{pointer-events:none}.ui-windows-dragged{z-index:6;pointer-events:unset !important}.ui-windows-dragged .ui-windows-title{background-color:#FAFAFA}.ui-windows-maximized{box-shadow:none}.ui-windows-maximized .ui-windows-title .ui-windows-control.ti-maximize:before{content:'\\ea01'}.ui-windows-maximized .ui-windows-title{border-left:0;border-right:0;border-radius:0;border-top:0}.ui-windows-maximized .ui-windows-control{height:31px}.ui-windows-maximized .ui-windows-body{border:0}.ui-windows-maximized .ui-windows-title .ti-window:before{content:'\\ea01'}.ui-windows-minimized .ui-windows-body{display:none}.ui-windows-nominimize .ui-windows-control[data-name='minimize']{display:none}.ui-windows-nomaximize .ui-windows-control[data-name='maximize']{display:none}.ui-windows-noclose .ui-windows-control[data-name='close']{display:none}.ui-windows-nomenu .ui-windows-control[data-name='menu']{display:none}.ui-windows-noresize .ui-windows-resize{display:none}.ui-windows-minimized .ui-windows-resize{display:none}.ui-windows-resize{position:absolute;width:5px;height:5px}.ui-windows-resize-tl{left:0;top:0;cursor:nwse-resize}.ui-windows-resize-tr{right:0;top:0;cursor:nesw-resize}.ui-windows-resize-bl{left:0;bottom:0;cursor:nesw-resize}.ui-windows-resize-br{right:0;bottom:0;cursor:nwse-resize}.ui-windows-block iframe, .ui-windows-block webview{pointer-events:none}.ui-windows-resizer{position:absolute;border-radius:var(--radius);border:1px dashed #C0C0C0;z-index:7;pointer-events:none}.ui-dark .ui-windows-item{background-color:#202020;box-shadow:0 10px 20px rgba(0,0,0,0.08)}.ui-dark .ui-windows-title{border-color:#404040}.ui-dark .ui-windows-body{border-color:#404040}.ui-dark .ui-windows-control{border-color:#404040}.ui-dark .ui-windows-control:hover{background-color:#272727}.ui-dark .ui-windows-dragged .ui-windows-title{background-color:#272727}.ui-dark .ui-windows-resizer{border-color:#777}

.ui-wysiwyg{position:relative}.ui-wysiwyg-toolbar{border-radius:var(--radius) var(--radius) 0 0;border:1px solid #E0E0E0;height:45px;padding-left:10px}.ui-wysiwyg-toolbar button{float:left;width:24px;height:24px;line-height:24px;outline:0;text-align:center;border:0;background-color:#FFF;margin:10px 5px 0 0;font-size:12px;border-radius:var(--radius)}.ui-wysiwyg-toolbar button:hover,.ui-wysiwyg-toolbar button.selected{background-color:#F0F0F0}.ui-wysiwyg-body{outline:0;background-color:#FFF;color:#000;border:1px solid #E0E0E0;border-top:0;padding:15px 10px;border-radius:0 0 var(--radius) var(--radius);position:relative;display:inline-block;width:100%}.ui-wysiwyg-placeholder{position:absolute;margin:15px 0 0 15px;color:#A0A0A0;cursor:text;z-index:1}.ui-wysiwyg .marked{background-color:rgba(0,0,0,0.1);padding:0 2px;border-radius:var(--radius)}.ui-wysiwyg code{font-family:Menlo,Consolas,monospace;color:#000;font-size:13px;background-color:#F0F0F0;padding:0 3px;border-radius:var(--radius)}.ui-dark .ui-wysiwyg-toolbar{border-color:#404040}.ui-dark .ui-wysiwyg-toolbar button{background-color:#202020;color:#D0D0D0}.ui-dark .ui-wysiwyg-toolbar button:hover,.ui-dark .ui-wysiwyg-toolbar button.selected{background-color:#303030}.ui-dark .ui-wysiwyg-body{background-color:#232323;color:#D0D0D0;border-color:#404040}.ui-dark .ui-wysiwyg-placeholder{color:#A0A0A0}.ui-dark .ui-wysiwyg .marked{background-color:rgba(255,255,255,0.2);color:#FFF}.ui-dark .ui-wysiwyg code{color:#D0D0D0;background-color:#404040}`);

COMPONENT('animation','style:2;delay:200;init:1000;cleaner:1000;visible:0;offset:50',function(self,config,cls){self.readonly();if(!config.if)self.blind();self.destroy=function(){self.visibleinterval&&clearInterval(self.interval)};self.make=function(){if(config.visible){self.visibleinterval=setInterval(function(){if(VISIBLE(self.dom,config.offset)){self.visibleinterval=null;clearInterval(self.visibleinterval);self.animate()}},500)}else setTimeout2(self.ID,self.animate,config.init);config.datasource&&self.datasource(config.datasource,function(){setTimeout2(self.ID,self.animate,config.init)})};self.restore=function(){self.find('.animated').aclass('animation').rclass('animated')};self.animate=function(){var el=self.find('.animation');var arr=[];for(var i=0;i<el.length;i++){var t=el[i];if(!t.$anim){var $t=$(t);if(!t.$animopt){var opt=($t.attrd('animation')||'').parseConfig();t.$animopt=opt}t.$anim=cls+'-'+(t.$animopt.style||config.style);$t.aclass(t.$anim+'-init animating');arr.push($t)}}if(!arr.length)return;setTimeout(function(arr){if(self.removed)return;var maxdelay=500;if(config.together){for(var i=0;i<arr.length;i++){var el=arr[i],c=el[0].$anim,opt=el[0].$animopt;if(!self.removed){if(opt.noanimation)el.rclass('animation '+c+'-init');else el.rclass('animation').aclass(c+'-run')}}setTimeout(function(){if(!self.removed){for(var i=0;i<arr.length;i++){var c=arr[i][0].$anim;arr[i].rclass(c+'-init '+c+'-run animating').aclass('animated');delete arr[i][0].$anim}config.exec&&self.EXEC(config.exec,self.element)}},1500);return}arr.wait(function(el,next,index){var opt=el[0].$animopt,delay=(opt.order||index)*(opt.delay||config.delay);var clsname=cls+'-'+(opt.style||config.style);if(maxdelay<delay)maxdelay=delay;if(el.hclass('hidden')||el.hclass('invisible')){el.rclass('animation '+clsname+'-init').aclass('animated');next();return}el[0].$animtime=setTimeout(function(el){if(!self.removed){if(opt.noanimation)el.rclass('animation '+clsname+'-init');else el.rclass('animation').aclass(clsname+'-run')}},delay,el);next()},function(){setTimeout(function(){for(var i=0;i<arr.length;i++){var c=arr[i][0].$anim;arr[i].rclass(c+'-init '+c+'-run animating').aclass('animated');delete arr[i][0].$anim}config.exec&&self.EXEC(config.exec,self.element)},maxdelay+1000)})},config.init/10>>0,arr)};self.setter=function(value){if(config.if){if(value===config.if)setTimeout2(self.ID,self.animate,config.init);else self.restore()}}});

COMPONENT('approve','cancel:Cancel',function(self,config,cls){var cls2='.'+cls,events={},buttons,oldcancel;self.readonly();self.singleton();self.nocompile&&self.nocompile();self.make=function(){self.aclass(cls+' hidden');self.html('<div><div class="{0}-body"><span class="{0}-close"><i class="ti ti-times"></i></span><div class="{0}-content"></div><div class="{0}-buttons"><button data-index="0"></button><button data-index="1"></button></div></div></div>'.format(cls));buttons=self.find(cls2+'-buttons').find('button');self.event('click','button',function(){self.hide(+$(this).attrd('index'))});self.event('click',cls2+'-close',function(){self.callback=null;self.hide(-1)});self.event('click',function(e){var t=e.target.tagName;if(t!=='DIV')return;var el=self.find(cls2+'-body');el.aclass(cls+'-click');setTimeout(function(){el.rclass(cls+'-click')},300)})};events.keydown=function(e){var index=e.which===13?0:e.which===27?1:null;if(index!=null){self.find('button[data-index="{0}"]'.format(index)).trigger('click');e.preventDefault();e.stopPropagation();events.unbind()}};events.bind=function(){$(W).on('keydown',events.keydown)};events.unbind=function(){$(W).off('keydown',events.keydown)};self.show=function(message,a,b,fn){clearTimeout2(self.id);if(typeof(b)==='function'){fn=b;b=config.cancel}if(M.scope)self.currscope=M.scope();self.callback=fn;var icon=a.match(/"[a-z0-9-\s]+"/);if(icon){var tmp=icon+'';if(tmp.indexOf(' ')==-1)tmp='ti ti-'+tmp;a=a.replace(icon,'').trim();icon='<i class="{0}"></i>'.format(tmp.replace(/"/g,''))}else icon='';var color=a.match(/#[0-9a-f]+/i);if(color)a=a.replace(color,'').trim();buttons.eq(0).css('background-color',color||'').html(icon+a);if(oldcancel!==b){oldcancel=b;buttons.eq(1).html(b)}self.find(cls2+'-content').html(message.replace(/\n/g,'<br />'));$('html').aclass(cls+'-noscroll');self.rclass('hidden');events.bind();self.aclass(cls+'-visible',5);document.activeElement&&document.activeElement.blur()};self.hide=function(index){if(!index){self.currscope&&M.scope(self.currscope);self.callback&&self.callback(index)}self.rclass(cls+'-visible');events.unbind();setTimeout2(self.id,function(){$('html').rclass(cls+'-noscroll');self.aclass('hidden')},50)}});

COMPONENT('audio',function(self){var can=false,volume=0.5;self.items=[];self.readonly();self.singleton();self.make=function(){var audio=document.createElement('audio');if(audio.canPlayType&&audio.canPlayType('audio/mpeg').replace(/no/,''))can=true};self.play=function(url){if(!can)return;var audio=new window.Audio();audio.src=url;audio.volume=volume;audio.play();audio.onended=function(){audio.$destroy=true;self.cleaner()};audio.onerror=function(){audio.$destroy=true;self.cleaner()};audio.onabort=function(){audio.$destroy=true;self.cleaner()};self.items.push(audio);return self};self.cleaner=function(){var index=0;while(true){var item=self.items[index++];if(item===undefined)return self;if(!item.$destroy)continue;item.pause();item.onended=null;item.onerror=null;item.onsuspend=null;item.onabort=null;item=null;index--;self.items.splice(index,1)}};self.stop=function(url){if(!url){self.items.forEach(function(item){item.$destroy=true});return self.cleaner()}var index=self.items.findIndex('src',url);if(index===-1)return self;self.items[index].$destroy=true;return self.cleaner()};self.setter=function(value){if(value===undefined)value=0.5;else value=(value/100);if(value>1)value=1;else if(value<0)value=0;volume=value?+value:0;for(var i=0,length=self.items.length;i<length;i++){var a=self.items[i];if(!a.$destroy)a.volume=value}}});

COMPONENT('autoexec','delay:0;init:0;manually:0;input:1',function(self,config){var delay=null,track=[];self.readonly();var exec=function(){config.exec&&self.EXEC(config.exec,self.element,self.get())};self.configure=function(key,value){switch(key){case'track':track=value.split(',').trim();break}};self.setter=function(value,path,type){var is=false;if((type===1||type===2)&&track.length){for(var p of track){if(path.indexOf(p)!==-1){is=true;break}}if(!is)return}switch(type){case 0:if(!config.init)return;break;case 1:case 3:if(!config.manually)return;break;case 2:if(!config.input)return;break}if(config.delay){delay&&clearTimeout(delay);delay=setTimeout(exec,config.delay)}else exec(value)}});

COMPONENT('autofill',function(self){self.readonly();self.blind();self.make=function(){var form=document.createElement('FORM');while(self.dom.children.length)form.appendChild(self.dom.children[0]);self.dom.appendChild(form);$(form).attr('action','#').attr('method','POST').on('submit',function(e){e.preventDefault();e.stopPropagation();return false})}});

COMPONENT('box','zindex:12;padding:25;scrollbar:1;scrolltop:1;style:1;align:center;background:1;transparent:0',function(self,config,cls){var cls2='.'+cls,csspos={},nav=false,init=false;if(!W.$$box){W.$$box_level=W.$$box_level||1;W.$$box=true;$(document).on('click',cls2+'-button-close',function(){SET($(this).attrd('path'),'')});var resize=function(){setTimeout2(self.name,function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='box'&&!HIDDEN(com.dom)&&com.$ready&&!com.$removed)com.resize()}},200)};ON('resize2',resize);$(document).on('click',cls2+'-container',function(e){if(e.target===this){var com=$(this).component();if(com&&com.config.closeoutside){com.set('');return}}var el=$(e.target);if(el.hclass(cls+'-container')&&el.hclass(cls+'-style-1')){var form=el.find(cls2);var c=cls+'-animate-click';form.aclass(c);setTimeout(function(){form.rclass(c)},300)}})}self.readonly();self.submit=function(){if(config.submit)self.EXEC(config.submit,self.hide,self.element);else self.hide()};self.cancel=function(){if(config.cancel)self.EXEC(config.cancel,self.hide);else self.hide()};self.hide=function(){config.close&&self.EXEC(config.close);if(config.independent)self.hideforce();self.set('')};self.resize=function(){if(self.hclass('hidden'))return;var padding=WIDTH()==='xs'?0:config.padding;var ui=self.find(cls2);csspos.height=WH-(config.style==1?(padding*2):padding);csspos.top=config.style===3?0:padding;var w=config.width;if(w>WW){csspos.width='';csspos.maxwidth='';w=0}else{csspos.width=w+'px';csspos.maxwidth=w+'px'}ui.css(csspos);self.element.css('padding','0 '+padding+'px');var el=self.find(cls2+'-title');var th=el.height();csspos={height:csspos.height-th};if(w)csspos.width=w;if(nav)csspos.height-=nav.height()+5;self.find(cls2+'-body').css(csspos);self.scrollbar&&self.scrollbar.resize();self.element.SETTER('*','resize')};self.make=function(){var html='<div id="{0}" class="hidden {4}-container invisible{6}"><div class="{4}{5}"{1}><div class="{4}-title"><button name="cancel" class="{4}-button-close{3}" data-path="{2}"><i class="ti ti-times"></i></button><i class="{4}-icon hidden"></i><span class="{4}-label"></span></div><div class="{4}-body"></div></div>'.format(self.ID,config.width?(' style="max-width:'+config.width+'px"'):'',self.path,config.closebutton==false?' hidden':'',cls,config.align==='center'?'':(' '+cls+'-align-'+config.align),' '+cls+'-'+(config.background?'':'no')+'bg');$(document.body).append(html);var scr=self.find('> script');self.template=scr.length?scr.html().trim():'';scr.length&&scr.remove();var el=$('#'+self.ID);var body=el.find(cls2+'-body')[0];var counter=0;el.css('padding','0 '+config.padding+'px');while(self.dom.children.length){var child=self.dom.children[0];if(child.tagName==='NAV'){nav=$(child);if(counter){body.parentNode.appendChild(child)}else{el.find(cls2+'-title')[0].appendChild(child);nav=null}}else body.appendChild(child);counter++}self.rclass('hidden invisible');var csscls=self.attr('class');csscls&&el.aclass(csscls);self.replace(el,true);if(config.scrollbar)self.scrollbar=SCROLLBAR(self.find(cls2+'-body'),{shadow:config.scrollbarshadow,visibleY:config.visibleY,orientation:'y'});self.aclass(cls+'-style-'+config.style);if(config.transparent)self.aclass(cls+'-transparent');self.event('scroll',function(){EMIT('scroll',self.name);EMIT('reflow',self.name)});self.event('click','button[name]',function(){var t=this;switch(t.name){case'submit':self.submit(self.hide);break;case'cancel':!t.disabled&&self[t.name](self.hide);break}});config.enter&&self.event('keydown','input',function(e){e.which===13&&!self.find('button[name="submit"]')[0].disabled&&setTimeout2(self.ID+'enter',self.submit,500)})};self.configure=function(key,value,init,prev){switch(key){case'title':self.find(cls2+'-label').text(value);break;case'icon':var icon=self.find(cls2+'-icon');icon.rclass2('fa ti');if(value)icon.aclass(self.faicon(value)).rclass('hidden');else icon.aclass('hidden');break;case'background':!init&&self.tclass(cls+'-bg',!!value);break;case'algin':!init&&self.rclass2(cls+'-align').aclass(cls+'–align-'+value);break;case'width':if(!init&&value!==prev){self.find(cls2).css('max-width',value+'px');self.resize()}break;case'closebutton':!init&&self.find(cls2+'-button-close').tclass('hidden',value!==true);break}};self.esc=function(bind){if(bind){if(!self.$esc){self.$esc=true;$(W).on('keydown',self.esc_keydown)}}else{if(self.$esc){self.$esc=false;$(W).off('keydown',self.esc_keydown)}}};self.esc_keydown=function(e){if(e.which===27&&!e.isPropagationStopped()){var val=self.get();if(!val||config.if===val){e.preventDefault();e.stopPropagation();self.hide()}}};self.hideforce=function(){if(!self.hclass('hidden')){self.aclass('hidden');self.release(true);self.esc(false);self.find(cls2).rclass(cls+'-animate');W.$$box_level--}};var allowscrollbars=function(){$('html').tclass(cls+'-noscroll',!!$(cls2+'-container').not('.hidden').length)};self.setter=function(value){setTimeout2(self.name+'-noscroll',allowscrollbars,50);var isHidden=value!==config.if;if(self.hclass('hidden')===isHidden){if(!isHidden){config.reload&&self.EXEC(config.reload,self);config.default&&DEFAULT(self.makepath(config.default),true);config.scrolltop&&self.scrollbar&&self.scrollbar.scrollTop(0)}return}setTimeout2(cls,function(){EMIT('reflow',self.name)},10);if(isHidden){if(!config.independent)self.hideforce();return}if(self.template){var is=self.template.COMPILABLE();self.find(cls2).append(self.template);self.template=null;is&&COMPILE()}if(W.$$box_level<1)W.$$box_level=1;W.$$box_level++;self.css('z-index',W.$$box_level*config.zindex);self.aclass('invisible');self.rclass('hidden');self.release(false);self.find(cls2).css({'max-width':value+'px',width:''});config.scrolltop&&self.scrollbar&&self.scrollbar.scrollTop(0);config.reload&&self.EXEC(config.reload,self);config.default&&DEFAULT(self.makepath(config.default),true);self.resize();setTimeout(function(){self.rclass('invisible');self.find(cls2).aclass(cls+'-animate');if(!init&&isMOBILE){$('body').aclass('hidden');setTimeout(function(){$('body').rclass('hidden')},50)}config.autofocus&&self.autofocus(config.autofocus);init=true},200);setTimeout2(self.ID,function(){self.css('z-index',(W.$$box_level*config.zindex)+1)},500);config.closeesc&&self.esc(true)}});

COMPONENT('checkbox',function(self,config,cls){self.nocompile&&self.nocompile();self.validate=function(value){return(config.disabled||!config.required)?true:(value===true||value==='true'||value==='on')};self.configure=function(key,value,init){if(init)return;switch(key){case'label':self.find('span').html(value);break;case'required':self.find('span').tclass(cls+'-label-required',value);break;case'disabled':self.tclass('ui-disabled',value);break;case'checkicon':self.find('i').rclass2('ti-').aclass('ti-'+value);break}};self.make=function(){self.aclass(cls);self.html('<span><i class="ti ti-{2}"></i></span><label{1}>{0}</label>'.format(config.label||self.html(),config.required?(' class="'+cls+'-label-required"'):'',config.checkicon||'check'));config.disabled&&self.aclass('ui-disabled');self.event('click',function(){if(!config.disabled){self.dirty(false);self.getter(!self.get())}})};self.setter=function(value){var is=config.reverse?!value:!!value;self.tclass(cls+'-checked',is)}});

COMPONENT('choose','limit:1;attr:id;key:id;selector:.selection;event:click;class:selected;type:string;uncheck:false',function(self,config,cls){var convert=function(val){switch(config.type){case'number':return val?val.parseInt():null;default:return val}};self.getter=null;self.validate=function(value){if(config.disabled||!config.required)return true;return config.limit===1?value!=null:value&&value.length>0};self.make=function(){self.aclass(cls);self.event(config.event,config.selector,function(e){e.preventDefault();e.stopPropagation();self.toggle($(this))})};self.toggle=function(id){if(config.disabled)return;id=convert(ATTRD(id,config.attr));var model=self.get();if(model==null){self.rewrite(model);self.set(config.limit===1?id:[id])}else{if(config.limit===1){if(model===id){if(config.uncheck)self.set(null)}else self.set(id)}else{var index=model.indexOf(id);if(index===-1){if(config.limit<=model.length)model.pop();model.push(id)}else model.splice(index,1);self.update(true)}}self.change(true)};self.recalc=function(){var arr=self.find(config.selector);var model=self.get();for(var i=0;i<arr.length;i++){var el=$(arr[i]);var is=false;if(config.limit===1)is=model==null?false:model===convert(el.attrd(config.attr));else is=model&&model instanceof Array&&model.length?model.indexOf(el.attrd(config.attr))!==-1:false;el.tclass(config.class,is)}};var datasource=function(){self.update()};self.configure=function(key,value){if(key==='datasource')self.datasource(value,datasource)};self.setter=function(){setTimeout2(self.ID,self.recalc,10)}});

COMPONENT('clipboard',function(self,config,cls){var container;self.singleton();self.readonly();self.nocompile();self.make=function(){if(navigator.clipboard&&W.isSecureContext&&window.self===window.top){self.copy=function(value){navigator.clipboard.writeText(value).catch(err=>console.error(err))}}else{var id='clipboard'+self.id;$(document.body).append('<textarea id="{0}" class="{1}"></textarea>'.format(id,cls));container=$('#'+id);self.copy=function(value){container.val(value);container.focus();container.select();document.execCommand('copy');container.blur()}}};self.setter=function(value){value&&self.copy(value)}});

COMPONENT('colorpicker',function(self,config,cls){var cls2='.'+cls,is=false,events={},colors=[['','E73323','EC8632','FFFD54','68B25B','7CFBFD','4285F4','E73CF7','E8357E','73197B','91683C','808080'],['FFFFFF','E8E8E8','D1D1D1','B9B9B9','A2A2A2','8B8B8B','747474','5D5D5D','464646','2E2E2E','171717','000000'],['5C0E07','5E350F','66651C','41641A','2D6419','2D6438','2D6465','133363','000662','2D0962','5C1262','5C0F32','8A1A11','8E501B','99982F','62962B','47962A','479654','479798','214D94','010E93','451393','8A2094','8A1C4C','B9261A','BD6B27','CCCB41','83C83C','61C83B','61C871','62C9CA','2E67C5','0216C4','5C1DC4','B92EC5','B92865','E73323','EC8632','FFFD54','A4FB4E','7BFA4C','7BFA8D','7CFBFD','3B80F7','041EF5','7327F5','E73CF7','E7357F','E8483F','EF9D4B','FFFE61','B4FB5C','83FA5A','83FAA2','83FBFD','5599F8','343CF5','8C42F6','E84FF7','E84A97','EA706B','F2B573','FFFE7E','C5FC7C','96FA7A','96FBB9','96FCFD','7BB2F9','666AF6','A76EF7','EB73F8','EA71B0','F6CECD','FAE6CF','FFFED1','EBFED1','D7FDD0','D7FDE7','D8FEFE','D1E5FD','CCCDFB','E1CEFB','F6CFFC','F6CEE4']];self.singleton();self.readonly();self.blind();self.nocompile();self.make=function(){var html='';for(var i=0;i<colors.length;i++){html+='<div>';for(var j=0;j<colors[i].length;j++){var color=colors[i][j];html+='<span class="{0}-cell" data-color="{2}"><span style="{1}">{3}</span></span>'.format(cls,color?('background-color:#'+color):'',color,color?'':'<i class="ti ti-ban"></i>')}html+='</div>'}self.html('<div class="{0}"><div class="{0}-body">{1}</div></div>'.format(cls,html));self.aclass(cls+'-container hidden');self.event('click',cls2+'-cell',function(){var el=$(this);var color=el.find('span').attr('style').replace('background-color:','');self.opt.callback&&self.opt.callback(color?self.opt.opacity?self.hex2rgba(color,self.opt.opacity):color:'');self.hide()});events.click=function(e){var el=e.target,parent=self.dom;do{if(el==parent)return;el=el.parentNode}while(el);self.hide()};self.on('scroll + reflow + resize + resize2',self.hide)};self.hex2rgba=function(hex,opacity){var c=(hex.charAt(0)==='#'?hex.substring(1):hex).split('');if(c.length===3)c=[c[0],c[0],c[1],c[1],c[2],c[2]];var a=c.splice(6);if(a.length)a=parseFloat(parseInt((parseInt(a.join(''),16)/255)*1000)/1000);else a=opacity||'1';c='0x'+c.join('');return'rgba('+[(c>>16)&255,(c>>8)&255,c&255].join(',')+','+a+')'};self.bindevents=function(){if(!events.is){events.is=true;$(document).on('click',events.click)}};self.unbindevents=function(){if(events.is){events.is=false;$(document).off('click',events.click)}};self.show=function(opt){var tmp=opt.element?opt.element instanceof jQuery?opt.element[0]:opt.element.element?opt.element.dom:opt.element:null;if(is&&tmp&&self.target===tmp){self.hide();return}events.is&&self.unbindevents();self.target=tmp;self.opt=opt;var css={};if(is){css.left=0;css.top=0;self.element.css(css)}else self.rclass('hidden');var target=$(opt.element);var w=self.element.width();var offset=target.offset();if(opt.element){switch(opt.align){case'center':css.left=Math.ceil((offset.left-w/2)+(target.innerWidth()/2));break;case'right':css.left=(offset.left-w)+target.innerWidth();break;default:css.left=offset.left;break}css.top=opt.position==='bottom'?(offset.top-self.element.height()-10):(offset.top+target.innerHeight()+10)}else{css.left=opt.x;css.top=opt.y}if(opt.offsetX)css.left+=opt.offsetX;if(opt.offsetY)css.top+=opt.offsetY;is=true;self.element.css(css);setTimeout(self.bindevents,10)};self.hide=function(){if(is){is=false;self.target=null;self.opt=null;setTimeout(self.unbindevents,50);self.aclass('hidden')}}});

COMPONENT('configuration','dateformat:yyyy-MM-dd',function(self,config,cls){var cls2='.'+cls,datasource,items=EMPTYARRAY;self.validate=function(value){if(config.disabled)return true;if(!value)value=EMPTYOBJECT;var errors=[];for(var i=0;i<items.length;i++){var item=items[i];if(item.required&&item.isdisabled!==true&&item.isvisible!==false){var val=value[item.name],is=item.validate(item.prepare(val));item.element.tclass(cls+'-invalid',!is);if(!is)errors.push(item)}}return!errors.length};self.reload=function(){var model=self.get();var prev;for(var i=0;i<items.length;i++){var item=items[i];item.$disable&&item.disable(item.$disable(model||EMPTYOBJECT));var is=true;if(item.$visible){is=item.$visible(model||EMPTYOBJECT);item.element.tclass('hidden',!is)}if(item.element[0].getAttribute('class').indexOf(cls+'-last')!==-1)item.element.rclass(cls+'-last');if(prev&&prev.group!==item.group)prev.element.aclass(cls+'-last');if(is)prev=item}if(prev)prev.element.aclass(cls+'-last')};self.types={};self.types.template=function(item){var icon='';if(item.icon)icon='<i class="'+self.faicon(item.icon)+'"></i>';var builder=[],align=item.align||0;if(align==='center')align=1;else if(align==='right')align=2;builder.push('<div class="{0}-item{1}">'.format(cls,align?(' '+cls+'-align-'+align):''));builder.push('<div class="{0}-item-label">{1}{2}</div>'.format(cls,icon,item.text));item.summary&&builder.push('<div class="{0}-item-summary">{1}</div>'.format(cls,item.summary));builder.push('<div class="{0}-item-control"></div>'.format(cls));item.note&&builder.push('<div class="{0}-item-note">{1}</div>'.format(cls,item.note));item.button&&builder.push('<div class="{0}-button"><button>{1}</button></div>'.format(cls,item.button));item.html&&builder.push(item.html);builder.push('</div>');var T,get=function(){var model=self.get()||EMPTYOBJECT;return model[item.name]};var set=function(val){var model=self.get();var empty=false;if(!model){empty=true;model={}}var old=model[item.name];val=T.prepare(val);if(old!=val){model[item.name]=val;if(empty)SET(self.path,model);else UPD(self.path+'.'+item.name,2);self.change(true);return true}};var el=$(builder.join(''));item.required&&el.aclass(cls+'-required');var control=el.find(cls2+'-item-control');var type=self.types[item.type](item,control,set,get);T=type;type.element=el;type.control=control;type.name=item.name;type.required=item.required;var fndisable=item.disable?FN(item.disable):null;if(fndisable){type.$disable=function(model){var is=!!fndisable(model);item.button&&type.element.find(cls2+'-button button').prop('disabled',is);type.isdisabled=is;return is}}else{type.$disable=null;type.isdisabled=false}var fnvisible=item.visible?FN(item.visible):null;if(fnvisible){type.$visible=function(model){var is=!!fnvisible(model);type.isvisible=is;return is}}else{type.$visible=null;type.isvisible=true}item.noborder&&el.aclass(cls+'-noborder');item.click&&el.find(cls2+'-button button').on('click',function(){var meta={};meta.item=item;meta.value=get();meta.set=set;meta.type=type;self.EXEC(item.click,meta)});return type};self.types.string=function(item,el,set,get){var obj={};obj.bind=function(val){var input=el.find('input');if(item.camouflage){var arr=[];for(var i=0;i<val.length;i++)arr.push('•');val=arr.join('')}input.val(val)};obj.validate=function(val){if(val==null)return false;if(item.transform==='email')return val.isEmail();if(item.transform==='phone')return val.isPhone();if(item.transform==='url')return val.isURL();return!!val};obj.disable=function(val){el.tclass(cls+'-disabled',!!val).find('input').prop('disabled',!!val)};obj.prepare=function(val){if(val==null)return'';val=(val+'').trim();switch(item.transform){case'phone':case'url':return val.replace(/\s/g,'');case'email':case'lowercase':return val.toLowerCase();case'uppercase':return val.toUppercase();case'slug':return val.slug();case'id':return val.slug().replace(/-/g,'')}return val};el.append('<div class="{0}-type-string"{1}><input type="text" placeholder="{2}" /></div>'.format(cls,item.width?' style="max-width:{0}px"'.format(item.width):'',(item.placeholder||'').encode()));var input=el.find('input');item.maxlength&&input.prop('maxlength',item.maxlength);input.on('change',function(){set(this.value)}).blur(function(){if(item.camouflage)obj.bind(this.value)}).on('focus',function(){if(item.camouflage){var val=obj.prepare(get());this.value=val}});item.monospace&&input.aclass(cls+'-monospace');item.bold&&input.aclass('b');return obj};self.types.multiline=self.types.textarea=function(item,el,set){var obj={};obj.bind=function(val){el.find('input').val(val)};obj.validate=function(val){return!!val};obj.disable=function(val){el.tclass(cls+'-disabled',!!val).find('textarea').prop('disabled',!!val)};obj.prepare=function(val){return val!=null?(val+'').trim():''};el.append('<div class="{0}-type-multiline"{2}><textarea placeholder="{1}"></textarea></div>'.format(cls,(item.placeholder||'').encode(),item.height?' style="height:{0}"'.format(item.height):''));var input=el.find('textarea').on('change',function(){set(this.value)});item.monospace&&input.aclass(cls+'-monospace');item.bold&&input.aclass('b');return obj};self.types.group=function(item){var icon='';if(item.icon)icon='<i class="'+self.faicon(item.icon)+'"></i>';var builder=['<div>'];builder.push('<div class="{0}-group">{1}</div>'.format(cls,icon+item.text));if(item.summary)builder.push('<div class="{0}-group-summary">{1}</div>'.format(cls,item.summary));else builder.push('<br>');return builder.join('')+'</div>'};self.types.number=function(item,el,set,get){var obj={};obj.bind=function(val){el.find('input').val(val)};obj.disable=function(val){el.tclass(cls+'-disabled',!!val).find('input').prop('disabled',!!val)};obj.validate=function(val){return val!=0};obj.prepare=function(val){if(val==null)return 0;if(item.min!=null&&val<item.min)val=item.min;else if(item.max!=null&&val>item.max)val=item.max;var type=typeof(val);return type==='string'?val.parseFloat():type==='number'?val:0};el.parent().aclass(cls+'-border');el.append('<div class="{0}-type-number"{1}><span><i class=ti ti-angle-up"></i><i class="ti ti-angle-down"></i></span><div><input type="text" placeholder="{2}" /></div></div>'.format(cls,item.width?' style="max-width:{0}px"'.format(item.width):'',(item.placeholder||'').encode()));var input=el.find('input');input.prop('maxlength',item.maxlength||12);input.on('change blur',function(){set(this.value)});item.monospace&&input.aclass(cls+'-monospace');item.bold&&item.aclass('b');el.find('span i').on('click',function(){if(input[0].disabled)return;var inc=item.increment||1,val=get()||0;if(this.getAttribute('class').indexOf('-up')!==-1){set(val+inc)}else{set(val-inc)}});return obj};self.types.boolean=self.types.checkbox=function(item,el,set){var tcls=cls+'-checked',obj={};obj.bind=function(val){el.tclass(tcls,!!val)};obj.validate=function(val){return val===true};obj.disable=function(val){el.parent().tclass(cls+'-disabled',!!val)};obj.prepare=function(val){return!!val};el.parent().aclass(cls+'-border');el.append('<div class="{0}-type-boolean"><div><span><i class="ti ti-check"></i></span></div></div>'.format(cls));el.find(cls2+'-type-boolean > div').on('click',function(){if(!el.parent().hclass(cls+'-disabled')){el.tclass(tcls);set(el.hclass(tcls))}});return obj};self.types.dropdown=function(item,el,set){var obj={};obj.bind=function(val){var items=item.items;if(typeof(items)==='string')items=GET(self.makepath(items));var obj=(items||EMPTYARRAY).findItem('id',val);el.find('label').tclass('hidden',!!obj);el.find(cls2+'-value').text(obj?obj.name:'')};obj.validate=function(val){return!!val};obj.disable=function(val){el.parent().tclass(cls+'-disabled',!!val)};obj.prepare=function(val){return val==null?null:val};el.append('<div class="{0}-type-dropdown"><span><i class="ti ti-angle-down"></i></span><label>{1}</label><div class="{0}-value"></div></div>'.format(cls,(item.placeholder||'').encode()));el.find(cls2+'-type-dropdown').on('click',function(){if(!el.parent().hclass(cls+'-disabled')){var items=item.items;if(typeof(items)==='string')items=GET(self.makepath(items));var opt={};opt.element=$(this);opt.items=items;opt.placeholder=item.dirplaceholder;opt.search=item.dirsearch;opt.empty=item.dirempty;opt.callback=function(val){set(val?val.id:null)};SETTER('directory/show',opt)}});return obj};self.types.color=function(item,el,set){var obj={};obj.bind=function(val){el.find(cls2+'-type-color div').css('background-color',val)};obj.validate=function(val){return!!val};obj.disable=function(val){el.parent().tclass(cls+'-disabled',!!val)};obj.prepare=function(val){return val==null?'':(val+'')};el.append('<div class="{0}-type-color"><div></div></div>'.format(cls));el.find(cls2+'-type-color').on('click',function(){if(!el.parent().hclass(cls+'-disabled')){var opt={};opt.element=$(this);opt.callback=set;SETTER('colorpicker/show',opt)}});return obj};self.types.icon=function(item,el,set){var obj={};obj.bind=function(val){el.find(cls2+'-type-icon').html('<i class="{0}"></i>'.format(val))};obj.validate=function(val){return!!val};obj.disable=function(val){el.parent().tclass(cls+'-disabled',!!val)};obj.prepare=function(val){return val==null?'':(val+'')};el.append('<div class="{0}-type-icon"></div>'.format(cls));el.find(cls2+'-type-icon').on('click',function(){if(!el.parent().hclass(cls+'-disabled')){var opt={};opt.element=$(this);opt.callback=set;SETTER('icons/show',opt)}});return obj};self.types.date=function(item,el,set,get){var obj={};obj.bind=function(val){el.find(cls2+'-value').html(val?val.format(item.format||DEF.dateformat||config.dateformat):'');el.find('label').tclass('hidden',!!val)};obj.validate=function(val){return!!val};obj.disable=function(val){el.parent().tclass(cls+'-disabled',!!val)};obj.prepare=function(val){if(val==null)return null;var type=typeof(val);return type==='string'?val.parseDate():type==='number'?new Date(val):val instanceof Date?val:null};el.append('<div class="{0}-type-date"><span><i class="ti ti-calendar"></i></span><label>{1}</label><div class="{0}-value"></div></div>'.format(cls,(item.placeholder||'').encode()));el.find(cls2+'-type-date').on('click',function(){if(!el.parent().hclass(cls+'-disabled')){var opt={};opt.value=get();opt.element=$(this);opt.callback=set;SETTER('datepicker/show',opt)}});return obj};self.types.selectable=function(item,el,set){var obj={},prev,items=item.items;if(typeof(items)==='string')items=GET(self.makepath(items));if(!(items instanceof Array))items=(items||EMPTYARRAY);obj.bind=function(val){var elements=el.find(cls2+'-type-selectable-item');el.find(cls2+'-selected').rclass(cls+'-selected');if(val instanceof Array){for(var i=0;i<val.length;i++){var index=items.findIndex('id',val[i]);if(index!==-1)elements.eq(index).aclass(cls+'-selected')}}else{var index=items.findIndex('id',val);if(index!==-1)elements.eq(index).aclass(cls+'-selected')}};obj.validate=function(val){return item.multiple?val&&val.length>0:!!val};obj.disable=function(val){el.parent().tclass(cls+'-disabled',!!val)};obj.prepare=function(val){return val==null?'':item.multiple&&val instanceof Array?val:(val+'')};var builder=[];for(var i=0;i<items.length;i++)builder.push('<div class="{0}-type-selectable-item"><i class="{icon}"></i><span>{name}</div>'.format(cls).arg(items[i]));el.append('<div class="{0}-type-selectable">{1}</div>'.format(cls,builder.join('')));el.find(cls2+'-type-selectable-item').on('click',function(){var selcls=cls+'-selected';if(!el.parent().hclass(cls+'-disabled')){var target=$(this);if(item.multiple){target.tclass(selcls)}else{if(prev&&prev[0]!==target[0])prev.rclass(selcls);prev=target.tclass(selcls)}var arr=el.find(cls2+'-selected');var selected=[];for(var i=0;i<arr.length;i++){var index=$(arr[i]).index();selected.push(items[index].id)}set(item.multiple?selected:(selected[0]||null))}});return obj};self.configure=function(key,value){if(key==='datasource'){self.datasource(value,function(path,value){datasource=value;self.redraw();self.refresh()},true)}};self.rebind=function(val){datasource=new Function('val','return '+val.trim())(val);self.redraw();self.refresh()};self.redraw=function(){items=[];self.empty();var container=self.element,was=false,group,count=0;for(var i=0;i<datasource.length;i++){var item=datasource[i];if(item.type==='group'){if(count&&!was)self.append('<br>');group=item;self.append(self.types.group(item));var div=document.createElement('DIV');self.append(div);container=$(div).aclass(cls+'-items')}else{count++;item=self.types.template(item);item.group=group;container.append(item.element);items.push(item)}}};self.make=function(){self.aclass(cls);var template=self.find('script').html();template&&self.rebind(template)};self.setter=function(value,path){if(!value)value={};var diff=path.substring(self.path.length+1);for(var key in value){var val=value[key];for(var j=0;j<items.length;j++){var item=items[j];if(item.name===key&&item.type!=='group'&&(!diff||diff.indexOf(path)===-1))item.bind(item.prepare(val))}}self.reload();self.rclass('invisible')}});

COMPONENT('console',function(self,config,cls){var cls2='.'+cls,etabs,source,elogs,current,ready=false;self.singleton();self.readonly();self.make=function(){self.aclass(cls+' hidden');self.append('<div class="{0}-body"><div class="{0}-tabs"><span class="{0}-close"><i class="ti ti-times"></i></span><div></div></div><div class="{0}-output"></div></div>'.format(cls));etabs=self.find(cls2+'-tabs > div');elogs=self.find(cls2+'-output');self.event('click',cls2+'-tab',function(){var el=$(this);var id=el.attrd('id');self.show(id)});self.event('click',cls2+'-close',function(){self.set(false)});self.on('resize2 + resize',self.resize);self.resize()};self.resize=function(){elogs.css('width',WW+30)};self.render_tabs=function(){if(!source)return;var keys=Object.keys(source);var builder=[];for(var i=0;i<keys.length;i++){var item=source[keys[i]];if(!current)current=keys[i];var icon=self.icon(item.icon);builder.push(('<span title="{1}" data-id="{2}" class="'+cls+'-tab{3}"><i class="{0}"></i>{1}</span>').format(icon+(item.name?'':'" style="margin-right:0'),item.name,keys[i],current===keys[i]?(' '+cls+'-selected'):''))}etabs.html(builder.join(''));current&&self.render_logs(source[current])};self.render_logs=function(obj){if(!obj){elogs.empty();return}var builder=[],arr=obj.items||EMPTYARRAY;for(var i=0;i<arr.length;i++){var item=arr[i],type=item.type||'info',icon=type==='error'?'bug':type==='warning'?type:type==='success'?'check-circle':'info-circle';builder.push('<div class="{0}-message {0}-{2}"><i class="ti ti-{3}"></i>{1}</div>'.format(cls,obj.encode===true||obj.encode==null?Thelpers.encode(item.body):item.body,type,icon))}elogs.html(builder.join(''));elogs[0].scrollTop=0};self.show=function(id){if(current===id||!ready)return;etabs.find(cls2+'-selected').rclass(cls+'-selected');etabs.find(cls2+'-tab[data-id="{0}"]'.format(id)).aclass(cls+'-selected');current=id;self.render_logs(source[id])};self.rebind=function(path,value){if(!ready)return;source=value;if(path===config.datasource)self.render_tabs();else if(path.substring(config.datasource.length+1).substring(0,current.length)===current)self.render_logs(source[current])};self.configure=function(key,value){if(key==='datasource')self.datasource(value,self.rebind)};self.setter=function(value){if(value&&!ready){ready=true;self.rebind(config.datasource,GET(config.datasource))}if(value){self.rclass('hidden');if(typeof(value)==='string')self.show(value);self.aclass(cls+'-visible',100)}else{self.rclass('hidden',100);self.rclass(cls+'-visible')}}});

COMPONENT('datepicker','today:Set today;clear:Clear;firstday:0',function(self,config,cls){var cls2='.'+cls,skip=false,visible=false,current,elyears,elmonths,elbody,main;self.days=EMPTYARRAY;self.days_short=EMPTYARRAY;self.months=EMPTYARRAY;self.months_short=EMPTYARRAY;self.years_from;self.years_to;self.singleton();self.readonly();self.nocompile();self.configure=function(key,value){switch(key){case'days':if(value instanceof Array)self.days=value;else self.days=value.split(',').trim();self.days_short=[];for(var i=0;i<DAYS.length;i++){DAYS[i]=self.days[i];self.days_short[i]=DAYS[i].substring(0,2).toUpperCase()}break;case'months':if(value instanceof Array)self.months=value;else self.months=value.split(',').trim();self.months_short=[];for(var i=0,length=self.months.length;i<length;i++){var m=self.months[i];MONTHS[i]=m;if(m.length>4)m=m.substring(0,3)+'.';self.months_short.push(m)}break;case'yearfrom':if(value.indexOf('current')!==-1)self.years_from=+(NOW.format('yyyy'));else self.years_from=+(NOW.add(value).format('yyyy'));break;case'yearto':if(value.indexOf('current')!==-1)self.years_to=+(NOW.format('yyyy'));else self.years_to=+(NOW.add(value).format('yyyy'));break}};function getMonthDays(dt){var m=dt.getMonth();var y=dt.getFullYear();if(m===-1){m=11;y--}return(32-new Date(y,m,32).getDate())}self.calculate=function(year,month,selected){var d=new Date(year,month,1,12,0);var output={header:[],days:[],month:month,year:year},firstday=config.firstday,firstcount=0,frm=d.getDay()-firstday;var today=NOW,ty=today.getFullYear();var tm=today.getMonth();var td=today.getDate();var sy=selected?selected.getFullYear():-1;var sm=selected?selected.getMonth():-1;var sd=selected?selected.getDate():-1;var days=getMonthDays(d);if(frm<0)frm=7+frm;while(firstcount++<7){output.header.push({index:firstday,name:self.days_short[firstday]});firstday++;if(firstday>6)firstday=0}var index=0,indexEmpty=0,count=0,prev=getMonthDays(new Date(year,month-1,1,12,0))-frm;var cur;for(var i=0;i<days+frm;i++){var obj={today:false,selected:false,empty:false,future:false,number:0,index:++count};if(i>=frm){obj.number=++index;obj.selected=sy===year&&sm===month&&sd===index;obj.today=ty===year&&tm===month&&td===index;obj.future=ty<year;if(!obj.future&&year===ty){if(tm<month)obj.future=true;else if(tm===month)obj.future=td<index}}else{indexEmpty++;obj.number=prev+indexEmpty;obj.empty=true;cur=d.add('-'+indexEmpty+' days')}if(!obj.empty)cur=d.add(i+' days');obj.month=i>=frm&&obj.number<=days?d.getMonth():cur.getMonth();obj.year=i>=frm&&obj.number<=days?d.getFullYear():cur.getFullYear();obj.date=cur;output.days.push(obj)}indexEmpty=0;for(var i=count;i<42;i++){var cur=d.add(i+' days');var obj={today:false,selected:false,empty:true,future:true,number:++indexEmpty,index:++count};obj.month=cur.getMonth();obj.year=cur.getFullYear();obj.date=cur;output.days.push(obj)}return output};self.hide=function(){if(visible){self.unbindevents();self.opt.close&&self.opt.close();self.opt=null;self.older=null;self.target=null;self.aclass('hidden');self.rclass(cls+'-visible');visible=false}return self};self.show=function(opt){setTimeout(function(){clearTimeout2('datepickerhide')},5);var el=$(opt.element);var dom=el[0];if(self.target===dom){self.hide();return}if(self.opt&&self.opt.close)self.opt.close();var off=el.offset();var w=el.innerWidth();var h=el.innerHeight();var l=0,t=0,height=305+(opt.cancel?25:0);var s=250;if(opt.element){switch(opt.align){case'center':l=Math.ceil((off.left-s/2)+(w/2));break;case'right':l=(off.left+w)-s;break;default:l=off.left;break}t=opt.position==='bottom'?(off.top-height):(off.top+h+12)}if(opt.offsetX)l+=opt.offsetX;if(opt.offsetY)t+=opt.offsetY;if(l+s>WW)l=(l+w)-s;var restrict=true,parent=dom.parentNode;while(parent){if(parent.tagName==='BODY'){restrict=false;break}if(parent.classList.contains('ui-scrollbar-area'))break;parent=parent.parentNode}if(restrict&&(t+height)>WH)t=(t+h)-height;var dt=typeof(opt.value)==='string'?GET(opt.value):opt.value;if((!(dt instanceof Date))||isNaN(dt.getTime()))dt=NOW;opt.scope=M.scope?M.scope():'';self.opt=opt;self.time=dt.format('HH:mm:ss');self.rclass('hidden');self.date(dt);main.css({left:l,top:t});main.aclass(cls+'-visible',50);self.bindevents();self.target=dom;visible=true};self.setdate=function(dt){if(!dt){if(typeof(self.opt.value)==='string')SET(self.opt.value+' @change',dt);else self.opt.callback(dt);return}var time=self.time.split(':');if(time.length>1){dt.setHours(+(time[0]||'0'));dt.setMinutes(+(time[1]||'0'));dt.setSeconds(+(time[2]||'0'))}self.opt.scope&&M.scope(self.opt.scope);if(typeof(self.opt.value)==='string')SET(self.opt.value+' @change',dt);else self.opt.callback(dt)};self.make=function(){self.aclass(cls+'-container hidden');var conf={},reconfigure=false;if(!config.days){conf.days=[];for(var i=0;i<DAYS.length;i++)conf.days.push(DAYS[i]);reconfigure=true}if(!config.months){conf.months=MONTHS;reconfigure=true}reconfigure&&self.reconfigure(conf);W.$datepicker=self;self.event('click',function(e){e.stopPropagation()});var hide=function(){visible&&W.$datepicker&&W.$datepicker.hide()};var hide2=function(){visible&&setTimeout2('datepickerhide',function(){W.$datepicker&&W.$datepicker.hide()},20)};self.bindevents=function(){if(!visible)$(W).on('scroll',hide2)};self.unbindevents=function(){if(visible)$(W).off('scroll',hide2)};self.element.on('click',function(e){if(e.target===self.dom)hide()});self.on('reflow + scroll + resize + resize2',hide)};self.makehtml=function(){var builder=[];builder.push('<div class="{0}-header"><span class="{0}-next"><i class="ti ti-angle-right"></i></span><span class="{0}-prev"><i class="ti ti-angle-left"></i></span><div class="{0}-info"><span class="{0}-month">---</span><span class="{0}-year">---</span></div></div><div class="{0}-years hidden"></div><div class="{0}-months"></div><div class="{0}-body hidden"><div class="{0}-week">'.format(cls));for(var i=0;i<7;i++)builder.push('<div></div>');builder.push('</div><div class="{0}-days">'.format(cls));var clearbtn=self.opt.clear===false?null:'<span>{1}</span>'.format(cls,config.clear);for(var i=0;i<42;i++)builder.push('<div class="{0}-date"><div></div></div>'.format(cls,i));builder.push('</div></div><div class="{0}-footer"><span class="{0}-now">{2}</span><span class="{0}-clear">{3}</span></div>'.format(cls,config.close,config.today,clearbtn));self.html('<div class="{0}">{1}</div>'.format(cls,builder.join('')));main=$(self.find(cls2)[0]);builder=[];elbody=self.find(cls2+'-body');elmonths=self.find(cls2+'-months');for(var i=0;i<12;i++)builder.push('<div class="{0}-month" data-index="{1}"><div></div></div>'.format(cls,i));elmonths.html(builder.join(''));builder=[];elyears=self.find(cls2+'-years');for(var i=0;i<25;i++)builder.push('<div class="{0}-year"><div></div></div>'.format(cls));elyears.html(builder.join(''));self.makehtml=null;self.find(cls2+'-month').on('click',function(e){var el=$(this);var index=el.attrd('index');var h='hidden';if(index){current.setMonth(+index);self.date(current,true)}else if(!elmonths.hclass(h))index=1;elyears.aclass(h);if(index)elmonths.aclass(h);else{elmonths.find(cls2+'-today').rclass(cls+'-today');elmonths.find(cls2+'-month').eq(current.getMonth()).aclass(cls+'-today');elmonths.rclass(h)}elbody.tclass(h,!elmonths.hclass(h));e.preventDefault();e.stopPropagation()});self.find(cls2+'-year').on('click',function(e){var el=$(this);var year=el.attrd('year');var h='hidden';if(year){current.setFullYear(+year);self.date(current,true)}else if(!elyears.hclass(h))year=1;elmonths.aclass(h);if(year)elyears.aclass(h);else{self.years();elyears.rclass(h)}elbody.tclass(h,!elyears.hclass(h));e.preventDefault();e.stopPropagation()});self.years=function(){var dom=self.find(cls2+'-years').find(cls2+'-year');var year=current.getFullYear();var index=12;for(var i=0;i<25;i++){var val=year-(index--);$(dom[i]).tclass(cls+'-today',val===year).attrd('year',val).find('div')[0].innerHTML=val}};self.find(cls2+'-date').on('click',function(){var dt=$(this).attrd('date').split('-');self.setdate(new Date(+dt[0],+dt[1],+dt[2],12,0,0));self.hide()});self.find(cls2+'-now').on('click',function(){self.setdate(new Date());self.hide()});self.find(cls2+'-clear').on('click',function(){self.setdate(null);self.hide()});self.find(cls2+'-next').on('click',function(e){if(elyears.hclass('hidden')){current.setMonth(current.getMonth()+1);self.date(current,true)}else{current.setFullYear(current.getFullYear()+25);self.years()}e.preventDefault();e.stopPropagation()});self.find(cls2+'-prev').on('click',function(e){if(elyears.hclass('hidden')){current.setMonth(current.getMonth()-1);self.date(current,true)}else{current.setFullYear(current.getFullYear()-25);self.years()}e.preventDefault();e.stopPropagation()})};self.date=function(value,skipday){var clssel=cls+'-selected';self.makehtml&&self.makehtml();if(typeof(value)==='string')value=value.parseDate();var year=value==null?null:value.getFullYear();if(year&&(year<self.years_from||year>self.years_to))return;if(!value||isNaN(value.getTime())){self.find('.'+clssel).rclass(clssel);value=NOW}var empty=!value;if(skipday){skipday=false;empty=true}if(skip){skip=false;return}value=new Date((value||NOW).getTime());var output=self.calculate(value.getFullYear(),value.getMonth(),value);var dom=self.find(cls2+'-date');self.find(cls2+'-body').rclass('hidden');self.find(cls2+'-months,'+cls2+'-years').aclass('hidden');current=value;for(var i=0;i<42;i++){var item=output.days[i],classes=[cls+'-date'];if(item.empty)classes.push(cls+'-disabled');if(!empty&&item.selected)classes.push(cls+'-selected');if(item.today)classes.push(cls+'-day-today');var el=$(dom[i]);el.attrd('date',item.year+'-'+item.month+'-'+item.number);el.find('div').html(item.number);el.find('i').remove();el.rclass().aclass(classes.join(' '))}if(!skipday){dom=self.find(cls2+'-week').find('div');for(var i=0;i<7;i++)dom[i].innerHTML=output.header[i].name;dom=self.find(cls2+'-months').find(cls2+'-month');for(var i=0;i<12;i++)$(dom[i]).find('div').attrd('index',i)[0].innerHTML=self.months_short[i]}self.opt.badges&&self.opt.badges(current,function(date){if(!(date instanceof Array))date=[date];for(var i=0;i<date.length;i++){var dt=date[i].getFullYear()+'-'+date[i].getMonth()+'-'+date[i].getDate();var el=self.find(cls2+'-date[data-date="{0}"]'.format(dt));if(el.length&&!el.find('i').length)el.append('<i class="ti ti-circle-alt"></i>')}});var info=self.find(cls2+'-info');info.find(cls2+'-month').html(self.months[current.getMonth()]);info.find(cls2+'-year').html(current.getFullYear())}});

COMPONENT('directory','minwidth:200;create:Create',function(self,config,cls){var cls2='.'+cls,container,timeout,icon,plus,skipreset=false,skipclear=false,ready=false,input=null,issearch=false,is=false,selectedindex=0,resultscount=0,templateE='{{ name | encode | ui_directory_helper}}',templateR='{{ name | raw}}',template='<li data-index="{{ $.index}}" data-search="{{ $.search}}" class="{{ $.classes}}">{{ if $.checkbox}}<span class="'+cls+'-checkbox"><i class="ti ti-check"></i></span>{{ fi}}{0}</li>',templateraw=template.format(templateR);var regstrip=/(&nbsp;|<([^>]+)>)/ig;var parentclass=null,skiphide=false,skipmouse=false,customvalue,main;template=template.format(templateE);Thelpers.ui_directory_helper=function(val){var t=this;return t.template?(typeof(t.template)==='string'?t.template.indexOf('{{')===-1?t.template:Tangular.render(t.template,this):t.render(this,val)):self.opt.render?self.opt.render(this,val):val};self.template=Tangular.compile(template);self.templateraw=Tangular.compile(templateraw);self.readonly();self.singleton();self.nocompile();self.configure=function(key,value,init){if(init)return;switch(key){case'placeholder':self.find('input').prop('placeholder',value);break}};self.make=function(){self.aclass('hidden '+cls+'-area');self.append('<div class="{1}"><div class="{1}-search"><span class="{1}-add hidden"><i class="ti ti-plus"></i></span><span class="{1}-button"><i class="ti ti-search"></i></span><div><input type="text" placeholder="{0}" class="{1}-search-input" name="dir{2}" autocomplete="new-password" /></div></div><div class="{1}-container"><ul></ul></div></div>'.format(config.placeholder,cls,Date.now()));customvalue=$('<li data-index="-2"></li>')[0];main=self.find(cls2);container=self.find('ul');input=self.find('input');icon=self.find(cls2+'-button').find('.ti');plus=self.find(cls2+'-add');self.event('mouseenter mouseleave','li',function(){if(ready&&!issearch&&!skipmouse){container.find('li.current').rclass('current');$(this).aclass('current');var arr=container.find('li:visible');for(var i=0;i<arr.length;i++){if($(arr[i]).hclass('current')){selectedindex=i;break}}}});self.element.on('click',function(e){if(e.target===self.dom)self.hide(1)});var skiphidedelay,skipmousedelay,skipmousefalse=function(){skipmousedelay=null;skipmouse=false};var skipmouseforce=function(){skipmouse=true;skipmousedelay&&clearTimeout(skipmousedelay);skipmousedelay=setTimeout(skipmousefalse,500)};self.event('focus','input',function(){skiphide=true;skiphidedelay&&clearTimeout(skiphidedelay);skiphidedelay=setTimeout(function(){skiphide=false},800);if(self.opt.search===false)$(this).blur()});self.event('click',cls2+'-button',function(e){skipclear=false;input.val('');self.search();e.stopPropagation();e.preventDefault()});self.event('click',cls2+'-add',function(){if(self.opt.custom&&self.opt.callback){self.opt.scope&&M.scope(self.opt.scope);self.opt.callback(input.val(),self.opt.element,true);self.hide()}});self.event('click','li',function(e){var el=$(this);if(el.hclass('ui-disabled'))return;if(self.opt.callback){self.opt.scope&&M.scope(self.opt.scope);var index=+el.attrd('index');if(index===-2){self.opt.scope&&M.scope(self.opt.scope);self.opt.callback(input.val(),self.opt.element,true);self.hide();return}var item=self.opt.items[index];if(self.opt.checkbox){item.selected=!item.selected;if(item.selected)item.selectedts=Date.now();else delete item.selectedts;el.tclass('selected',item.selected);if(self.opt.checked){var tmpindex=self.opt.checked.indexOf(item.id);if(item.selected){if(tmpindex===-1)self.opt.checked.push(item.id)}else if(tmpindex!==-1)self.opt.checked.splice(tmpindex,1)}var response=null;if(self.opt.checked){response=self.opt.checked.slice(0)}else{response=[];for(var i=0;i<self.opt.items.length;i++){var m=self.opt.items[i];if(m.selected)response.push(m)}}response.quicksort('selectedts');self.opt.callback(response,self.opt.element,false,e)}else self.opt.callback(item,self.opt.element,false,e)}is=true;if(!self.opt.checkbox){self.hide(0);e.preventDefault();e.stopPropagation()}});var e_resize=function(){is&&self.hide(0)};self.bindedevents=false;self.bindevents=function(){if(!self.bindedevents){$(W).on('resize',e_resize);self.bindedevents=true}};self.unbindevents=function(){if(self.bindedevents){self.bindedevents=false;$(W).off('resize',e_resize)}};self.event('keydown','input',function(e){var o=false;switch(e.which){case 8:skipclear=false;break;case 27:o=true;self.hide();break;case 13:o=true;var sel=self.find('li.current');if(sel.hclass('ui-disabled'))return;if(self.opt.callback){self.opt.scope&&M.scope(self.opt.scope);var index=+sel.attrd('index');if(self.opt.custom&&(!sel.length||index===-2))self.opt.callback(this.value,self.opt.element,true);else self.opt.callback(self.opt.items[index],self.opt.element)}self.hide();break;case 38:o=true;selectedindex--;if(selectedindex<0)selectedindex=0;self.move();break;case 40:o=true;selectedindex++;if(selectedindex>=resultscount)selectedindex=resultscount;self.move();break}if(o){skipmouseforce();e.preventDefault();e.stopPropagation()}});self.event('input','input',function(){issearch=true;setTimeout2(self.ID,self.search,100,null,this.value)});var fn=function(){is&&!skiphide&&self.hide(1)};self.on('reflow + scroll + resize + resize2',fn);$(W).on('scroll',fn)};self.move=function(){var counter=0,scroller=container.parent();var li=container.find('li');var hli=0,was=false,last=-1,lastselected=0,plus=0;for(var i=0;i<li.length;i++){var el=$(li[i]);if(el.hclass('hidden')){el.rclass('current');continue}var is=selectedindex===counter;el.tclass('current',is);if(is){hli=(el.innerHeight()||30)+1;plus=(hli*2);was=true;var t=(hli*(counter||1));scroller[0].scrollTop=t-plus}counter++;last=i;lastselected++}if(!was&&last>=0){selectedindex=lastselected;li.eq(last).aclass('current')}};var nosearch=function(){issearch=false};self.nosearch=function(){setTimeout2(self.ID+'nosearch',nosearch,500)};self.search=function(value){if(!self.opt)return;icon.tclass('ti-times',!!value).tclass('ti-search',!value);if(self.opt.custom){plus.tclass('hidden',!value);customvalue.innerHTML=(typeof(self.opt.custom)==='string'?self.opt.custom:config.create)+': <b>'+(value?Thelpers.encode(value.toString()):'...')+'</b>'}if(!value&&!self.opt.ajax){if(!skipclear)container.find('li').rclass('hidden');if(!skipreset)selectedindex=0;resultscount=self.opt.items?self.opt.items.length:0;customvalue.classList.toggle('hidden',!value);self.move();self.nosearch();return}resultscount=0;selectedindex=0;if(self.opt.ajax){var val=value||'';if(self.ajaxold!==val){self.ajaxold=val;setTimeout2(self.ID,function(val){self.opt&&self.opt.ajax(val,function(items){var builder=[],indexer={},item,key=(self.opt.search==true?self.opt.key:(self.opt.search||self.opt.key))||'name';for(var i=0;i<items.length;i++){item=items[i];if(self.opt.exclude&&self.opt.exclude(item))continue;if(self.opt.checked)item.selected=self.opt.checked.indexOf(item.id)!==-1;indexer.index=i;indexer.search=item[key]?item[key].replace(regstrip,''):'';indexer.checkbox=self.opt.checkbox===true;resultscount++;builder.push(self.opt.ta(item,indexer))}if(self.opt.empty){item={};var tmp=self.opt.raw?'<b>{0}</b>'.format(self.opt.empty):self.opt.empty;item[self.opt.key||'name']=tmp;if(!self.opt.raw)item.template='<b>{0}</b>'.format(self.opt.empty);indexer.index=-1;builder.unshift(self.opt.ta(item,indexer))}if(customvalue.parentNode)customvalue.parentNode.removeChild(customvalue.parentNode);skipclear=true;self.opt.items=items;container.html(builder);if(self.opt.custom){container.prepend(customvalue);customvalue.classList.toggle('hidden',!value)}self.move();self.nosearch()})},300,null,val)}}else if(value){value=value.toSearch().split(' ');var arr=container.find('li');for(var i=0;i<arr.length;i++){var el=$(arr[i]);var val=el.attrd('search')||'';if(!val)continue;val=val.toSearch();var is=false;for(var j=0;j<value.length;j++){if(val.indexOf(value[j])===-1){is=true;break}}el.tclass('hidden',is);if(!is)resultscount++}customvalue.classList.toggle('hidden',!value);skipclear=true;self.move();self.nosearch()}};self.show=function(opt){if(opt.checked==true)opt.checked=[];var el=opt.element instanceof jQuery?opt.element[0]:opt.element;if(opt.items==null)opt.items=EMPTYARRAY;self.tclass(cls+'-default',!opt.render);if(parentclass){self.rclass(parentclass);parentclass=null}if(opt.classname){main.aclass(opt.classname);parentclass=opt.classname}if(!opt.minwidth)opt.minwidth=config.minwidth;if(is){clearTimeout(timeout);if(self.target===el){self.hide(1);return}}self.initializing=true;self.target=el;opt.ajax=null;self.ajaxold=null;var element=opt.element?$(opt.element):null;var callback=opt.callback,items=opt.items,type=typeof(items);var item;if(type==='string'){items=opt.items=GET(items);type=typeof(items)}if(type==='function'&&callback){type='';opt.ajax=items;items=null}if(!items&&!opt.ajax){self.hide(0);return}setTimeout(self.bindevents,500);self.tclass(cls+'-search-hidden',opt.search===false);self.opt=opt;opt.class&&main.aclass(opt.class);input.val('');var builder=[],selected=null;opt.ta=opt.key?Tangular.compile((opt.raw?templateraw:template).replace(/\{\{\sname/g,'{{ '+opt.key)):opt.raw?self.templateraw:self.template;if(!opt.ajax){var indexer={},key=(opt.search==true?opt.key:(opt.search||opt.key))||'name';for(var i=0;i<items.length;i++){item=items[i];if(typeof(item)==='string')item={name:item,id:item,selected:item===opt.selected};if(opt.exclude&&opt.exclude(item))continue;if(item.selected||opt.selected===item){selected=i;skipreset=true;item.selected=true}else item.selected=false;if(opt.checked&&item.selected)opt.checked.push(item.id);var c='';if(item.selected)c+=(c?' ':'selected current');if(item.classname)c+=(c?' ':item.classname);if(item.disabled)c+=(c?' ':'ui-disabled');indexer.classes=c;indexer.checkbox=opt.checkbox===true;indexer.index=i;indexer.search=item[key]?item[key].replace(regstrip,''):'';builder.push(opt.ta(item,indexer))}if(opt.empty){item={};var tmp=opt.raw?'<b>{0}</b>'.format(opt.empty):opt.empty;item[opt.key||'name']=tmp;if(!opt.raw)item.template='<b>{0}</b>'.format(opt.empty);indexer.index=-1;builder.unshift(opt.ta(item,indexer))}}self.target=element?element[0]:null;var w=element?element.width():config.minwidth;var offset=element?element.offset():EMPTYOBJECT;var width=w+(opt.offsetWidth||0);if(opt.minwidth&&width<opt.minwidth)width=opt.minwidth;else if(opt.maxwidth&&width>opt.maxwidth)width=opt.maxwidth;ready=false;opt.ajaxold=null;plus.aclass('hidden');self.find('input').prop('placeholder',opt.placeholder||config.placeholder);var scroller=self.find(cls2+'-container').css('width',width+30);if(customvalue.parentNode)customvalue.parentNode.removeChild(customvalue);container.html(builder);if(opt.custom)container.prepend(customvalue);var options={left:0,top:0,width:width};if(opt.element){switch(opt.align){case'center':options.left=Math.ceil((offset.left-width/2)+(opt.element.innerWidth()/2));break;case'right':options.left=(offset.left-width)+opt.element.innerWidth();break;default:options.left=offset.left;break}options.top=opt.position==='bottom'?((offset.top-self.height())+element.height()):offset.top}else{options.top=opt.y;options.left=opt.x}options.scope=M.scope?M.scope():'';if(opt.offsetX)options.left+=opt.offsetX;if(opt.offsetY)options.top+=opt.offsetY;var mw=width,mh=self.height();if(options.left<0)options.left=10;else if((mw+options.left)>WW)options.left=(WW-mw)-10;var dom=opt.element?opt.element[0].parentNode:null,restrict=true;while(dom){if(dom.tagName==='BODY'){restrict=false;break}if(dom.classList.contains('ui-scrollbar-area'))break;dom=dom.parentNode}if(options.top<0)options.top=10;else if(restrict&&(mh+options.top)>WH)options.top=(WH-mh)-10;main.css(options);!isMOBILE&&setTimeout(function(){if(opt.search!==false)input.focus()},200);setTimeout(function(){self.initializing=false;is=true;if(selected){var h=container.find('li:first-child').innerHeight()+1;var y=(container.find('li.selected').index()*h)-(h*2);scroller[0].scrollTop=y<0?0:y}else{scroller[0].scrollTop=0;ready=true}self.rclass('invisible')},100);if(is){self.search();return}selectedindex=selected||0;resultscount=items?items.length:0;skipclear=true;self.search();self.aclass('invisible');self.rclass('hidden');setTimeout(function(){if(self.opt&&((self.opt.x!=null&&self.opt.y!=null)||(self.target&&self.target.offsetParent)))main.aclass(cls+'-visible');else self.hide(1)},100);skipreset=false};self.hide=function(sleep){if(!is||self.initializing)return;clearTimeout(timeout);timeout=setTimeout(function(){self.unbindevents();self.rclass(cls+'-visible').aclass('hidden');if(self.opt){self.opt.close&&self.opt.close();self.opt.class&&self.rclass(self.opt.class);self.opt=null}is=false},sleep?sleep:100)}});

COMPONENT('edit','dateformat:yyyy-MM-dd;padding:10;floating:0',function(self,config,cls){var cls2='.'+cls,events={},floating;self.readonly();self.singleton();self.parse=function(el){var t=el[0];if(t.$edit)return t.$edit;var opt=(el.attrd('edit')||'').parseConfig();opt.scope=el.scope();opt.html=el.html();if(opt.type)opt.type=opt.type.toLowerCase();if(opt.type==='date'&&!opt.format)opt.format=config.dateformat;if(opt.offsetX==null)opt.offsetX=config.offsetX;if(opt.offsetY==null)opt.offsetY=config.offsetY;if(opt.floating==null)opt.floating=config.floating;if(opt.check){opt.checkforce=function(el){var opt=el[0].$edit,path=opt.scope?opt.scope.makepath(opt.check):opt.check;return GET(path)(opt,el)}}t.$edit=opt;return opt};self.movecursor=function(el,beg){var range,selection,doc=document;if(doc.createRange){range=doc.createRange();range.selectNodeContents(el[0]);range.collapse(beg?true:false);selection=W.getSelection();selection.removeAllRanges();selection.addRange(range)}else if(doc.selection){range=doc.body.createTextRange();range.moveToElementText(el[0]);range.collapse(beg?true:false);range.select()}};self.focusnext=function(el,e){el=$(el);var parent=el[0];for(var i=0;i<12;i++){parent=parent.parentNode;if(parent===document.body)break}var arr=$(parent).find('.edit,.edit2');for(var i=0;i<arr.length;i++){if(arr[i]===el[0]){var next=arr[i+1];e&&e.preventDefault();next&&self.edit($(next));return true}}};self.make=function(){self.aclass(cls);self.append('<div class="{0}-window hidden"></div>'.format(cls));floating=self.find(cls2+'-window');$(document).on('click','.edit',self.edit).on('dblclick','.edit2',self.edit);events.keydown=function(e){var t=this;if(!t.$editevents)return;var meta=t.$edit;if(meta.clear){t.innerHTML='';meta.clear=0}if(!meta.keypressed){meta.keypressed=1;$(t).aclass('edit-keypressed')}if((e.metaKey||e.ctrlKey)&&(e.which===66||e.which===76||e.which===73||e.which===85)){if(meta.type!=='html'){e.preventDefault();e.stopPropagation()}}var el;if(e.which===27){el=$(t);t.$edit.is=false;self.detach(el);return}if(e.which===13||e.which===9){if(e.which===13&&meta.multiline)return;e.preventDefault();el=$(t);if(self.approve(el)){self.detach(el);el.rclass('edit-keypressed');if(e.which===9&&self.focusnext(t,e))return}else self.detach(el)}};events.blur=function(){var t=this;if(t.$editevents){var el=$(t);el.rclass('edit-keypressed');t.$edit.is&&self.approve(el);self.detach(el)}};events.paste=function(e){e.preventDefault();e.stopPropagation();var meta=this.$edit,text=e.originalEvent.clipboardData.getData(self.attrd('clipboard')||'text/plain');text&&document.execCommand('insertText',false,meta.multiline?text.trim():text.replace(/\n|\r/g,'').trim())}};self.edit=function(e){var is=e instanceof jQuery,t=is?e:this;if(!is){e.preventDefault();e.stopPropagation()}if(t.$edit&&t.$edit.is)return;var el=$(t);var opt=self.parse(el);if(!opt||(opt.checkforce&&!opt.checkforce(el)))return;if(opt.prevent){e.preventDefault();e.stopPropagation()}var value=el.html();var empty=false,jcbind=el[0].$jcbind||{};if(jcbind.empty&&jcbind.empty==el[0].innerText){empty=true}if(opt.floating){var target=opt.parent?(opt.parent==='parent'?el.parent():el.closest(opt.parent)):el;var offset=opt.floating==='position'?target.position():target.offset();var width=opt.width||(target.width()+(config.padding*2)+(opt.offsetWidth||0));if(width<config.minwidth)width=config.minwidth;var align=opt.align||'';floating.css({width:width,left:(offset.left-config.padding)+(opt.offsetX||0),top:(offset.top-config.padding)+(opt.offsetY||0),font:el.css('font'),'text-align':align});floating.html(empty?'':value);floating.rclass('hidden');floating[0].$edit=opt}else{floating.aclass('hidden');delete floating[0].$edit;empty&&el.empty()}opt.is=true;opt.keypressed=0;opt.html=value;opt.element=el;self.attach(opt.floating?floating:el)};self.approve=function(el){var opt=el[0].$edit,cur=el.html();if(opt.html===cur)return true;var val=cur;if(opt.type!=='html'){var area=document.createElement('TEXTAREA');area.innerHTML=val;val=$(area).text();val=val.replace(/<br(\s\/)?>/g,opt.multiline?'\n':'').trim()}if(opt.maxlength&&val.length>opt.maxlength)val=val.substring(0,opt.maxlength);opt.value=val;switch(opt.type){case'number':opt.value=opt.value?opt.value.parseFloat():0;if((opt.minvalue!=null&&opt.value<opt.minvalue)||(opt.maxvalue!=null&&opt.value>opt.maxvalue))return false;break;case'phone':if(opt.required){if(!opt.value.isPhone())return false}else if(opt.value&&!opt.value.isPhone())return false;break;case'url':if(opt.required){if(!opt.value.isURL())return false}else if(opt.value&&!opt.value.isURL())return false;break;case'email':if(opt.required){if((!opt.value||!opt.value.isEmail()))return false}else if(opt.value&&!opt.value.isEmail())return false;break;case'date':if(!opt.empty){opt.value=opt.value?opt.value.parseDate(opt.format):null;if(opt.required&&!opt.value)return false}break;default:if(opt.required&&!opt.value)return false;break}self.save(el);return true};self.save=function(el){var opt=el[0].$edit,fn=opt.exec||opt.save||config.exec;if(fn){fn=GET(opt.scope?opt.scope.makepath(fn):fn);if(typeof(fn)==='function'){opt.detached=true;fn(opt,function(body){if(body==null||body===false)opt.value=opt.html;else if(body!==true)opt.value=body+'';opt.element.html(opt.value+'');opt.notify&&EXEC(opt.scope?opt.scope.makepath(opt.notify):opt.notify,opt)});return}}if(!opt.nobind&&opt.bind!==true){setTimeout(function(){var b=opt.element.binder();if(b){b.disabled=true;b.exec(opt.value,b.path);SET(b.path,opt.value,2);b.disabled=false;opt.notify&&EXEC(opt.scope?opt.scope.makepath(opt.notify):opt.notify,opt)}},100)}};self.attach=function(el){if(!el[0].$editevents){var o=el[0].$edit;el[0].$editevents=true;el.aclass('edit-open'+(o.multiline?' edit-multiline':''));el.on('keydown',events.keydown);el.on('blur',events.blur);el.on('paste',events.paste);el.attr('contenteditable',true);el.focus();if(o.clear||o.cursor==='beg'||o.cursor==='begin')setTimeout(self.movecursor,10,el,1);else self.movecursor(el,0);if(o.select||o.selectall){setTimeout(function(){document.execCommand('selectAll',false,null)},20)}}};self.detach=function(el){if(el[0].$editevents){el.off('keydown',events.keydown);el.off('blur',events.blur);el.off('paste',events.paste);el[0].$editevents=false;if(el[0]===floating[0])floating.aclass('hidden');var opt=el[0].$edit;if(!opt.detached&&opt.html!=null)opt.element.html(opt.html);delete opt.detached;opt.is=false;el.rclass('edit-open edit-multiline');el.attr('contenteditable',false)}}});

COMPONENT('empty','icon:ti ti-database;parent:parent;margin:0;wait:1',function(self,config,cls){var visible=false,special=false,table;self.readonly();self.make=function(){self.aclass(cls);var scr=self.find('> scri'+'pt,> template');var text=scr.length?scr.html():self.html();var html='<div class="{0}-table hidden"><div class="{0}-cell"><i class="{1}"></i><div>{2}</div></div></div>'.format(cls,config.icon,text);if(scr.length){special=true;scr.remove();self.element.prepend(html)}else self.html(html);table=self.find('> .'+cls+'-table');self.on('resize2 + resize',function(){if(!visible)self.resize()});self.rclass('hidden invisible')};self.resize=function(){setTimeout2(self.ID,self.resizeforce,300)};self.resizeforce=function(){if(visible)return;if(config.height){table.css('height',config.height);table.tclass('hidden',visible);return}var parent=self.parent(config.parent);var wh=parent.height()-10;if(config.topoffset)wh-=self.element.offset().top;if(config.topposition)wh-=self.element.position().top;table.css('height',wh<100?'auto':wh-config.margin);table.rclass('hidden')};self.setter=function(value,path,type){if(!value&&type===0&&config.wait)return;visible=false;if(value instanceof Array)visible=!!value.length;else if(value)visible=value.items&&!!value.items.length;if(visible)table.aclass('hidden');else self.resize();if(special){for(var i=1;i<self.dom.children.length;i++)$(self.dom.children[i]).tclass('hidden',!visible)}}});

COMPONENT('enter','validate:1;trigger:button[name="submit"];flags:visible;timeout:1500;delay:500',function(self,config){var flags,delay=null,submit=function(btn){delay=null;if(btn)btn.trigger('click');else self.EXEC(config.exec,self)};self.readonly();self.make=function(){self.event('keydown','input',function(e){if(e.which===13&&(!config.validate||!self.path||CAN(self.path,flags))){if(config.exec){if(!BLOCKED(self.ID,config.timeout)){delay&&clearTimeout(delay);delay=setTimeout(submit,config.delay)}}else{var btn=self.find(config.trigger);if(!btn.prop('disabled')){if(!BLOCKED(self.ID,config.timeout)){delay&&clearTimeout(delay);delay=setTimeout(submit,config.delay,btn)}}}}})};self.configure=function(key,value){switch(key){case'flags':if(value){flags=value.split(',');for(var i=0;i<flags.length;i++)flags[i]='@'+flags[i]}else flags=null;break}}});

COMPONENT('exec',function(self,config){var regparent=/\?\d/,extensions=[];self.readonly();self.blind();self.singleton();self.register=function(fn){extensions.push(fn)};self.make=function(){var scope=null,scopepath=function(el,val){if(!scope)scope=el.scope();return val==null?scope:scope?scope.makepath?scope.makepath(val):val.replace(/\?/g,el.scope().path):val};var fn=function(plus,forceprevent){return function(e){var el=$(this);var attr=el.attrd('exec'+plus);var path=el.attrd('path'+plus);var href=el.attrd('href'+plus);var def=el.attrd('def'+plus);var reset=el.attrd('reset'+plus);scope=null;var prevent=forceprevent?'1':el.attrd('prevent'+plus);if(prevent==='true'||prevent==='1'){e.preventDefault();e.stopPropagation()}if(attr){if(extensions.length){for(var ext of extensions){if(ext(attr,el,e,plus))return}}if(attr.charAt(0)==='@'){attr=attr.substring(1);var com=el.component();if(com&&typeof(com[attr])==='function')com[attr](el,e);return}if(attr.indexOf('?')!==-1){var tmp=scopepath(el);if(tmp){var isparent=regparent.test(attr);attr=tmp.makepath?tmp.makepath(attr):attr.replace(/\?/g,tmp.path);if(isparent&&attr.indexOf('/')!==-1)M.scope(attr.split('/')[0]);else M.scope(tmp.path)}if(scope&&scope.plugin){var index=attr.indexOf('/');if(index!==-1){var method=attr.substring(index+1).trim();if(method){var fn=scope.plugin[method];if(fn)fn.call(scope.plugin,el,e);else WARN('The method "{0}" not found'.format(attr));return}}}}EXEC(attr,el,e)}href&&REDIRECT(href);if(def){if(def.indexOf('?')!==-1)def=scopepath(el,def);DEFAULT(def)}if(reset){if(reset.indexOf('?')!==-1)reset=scopepath(el,reset);RESET(reset)}if(path){var val=el.attrd('value');if(val){if(path.indexOf('?')!==-1)path=scopepath(el,path);var v=GET(path);SET(path,new Function('value','return '+val)(v),true)}}}};var el=$(document.body);el.on('contextmenu',config.selector3||'.exec3',fn('3',true));el.on('dblclick',config.selector2||'.exec2',fn('2'));el.on('click',config.selector||'.exec',fn(''))}});

COMPONENT('filereader',function(self){var input;self.readonly();self.nocompile();self.singleton();self.make=function(){self.aclass('hidden');self.append('<input type="file" />');input=self.find('input');input.on('change',function(e){self.process(e.target.files)})};self.open=function(opt,callback){self.opt=opt;if(!opt.callback)opt.callback=callback;input.attr('accept',opt.accept||'*/*').prop('multiple',!!opt.multiple);input.trigger('click')};self.process=function(files){SETTER('loading','show');var arr=[];for(var i=0;i<files.length;i++)arr.push(i);arr.wait(function(index,next){var file=files[index],reader=new FileReader();reader.onload=function(){var data={body:reader.result,filename:file.name,type:file.type,size:file.size};if(self.opt.callback)self.opt.callback(data);else self.set(data);reader=null;setTimeout(next,500)};if(self.opt.base64)reader.readAsDataURL(file);else reader.readAsText(file)},function(){SETTER('loading','hide',1000);input[0].value=''})}});

COMPONENT('fileuploader',function(self){var input;self.singleton();self.readonly();self.nocompile();self.preparefilename=function(filename){var index=filename.lastIndexOf('/');if(index===-1)index=filename.lastIndexOf('\\');if(index!==-1)filename=filename.substring(index+1);return filename};self.upload=self.browse=function(opt){self.opt=opt;self.opt.fd=new FormData();self.opt.indexer=0;if(opt.files){self.uploadfiles(opt.files)}else{input[0].value='';self.find('input').attr('accept',opt.accept||'*/*').prop('multiple',!!opt.multiple);input.click()}};self.make=function(){self.aclass('hidden');self.append('<input type="file" multiple />');input=self.find('input');self.event('change','input',function(e){var files=e.target.files;if(self.opt.width||self.opt.height){var queue=[];for(var i=0;i<files.length;i++)queue.push(files[i]);queue.wait(function(item,next){self.processimage(item,function(filename,blob){self.opt.fd.append((self.opt.prefix||'file{0}').format(self.opt.indexer++),blob,filename);next()})},()=>self.uploadfiles())}else self.uploadfiles(files,()=>this.value='')})};self.uploadfiles=function(files){if(files){for(var i=0;i<files.length;i++){var filename=self.preparefilename(files[i].name);self.opt.fd.append((self.opt.prefix||'file{0}').format(self.opt.indexer++),files[i],filename)}}if(self.opt.data){for(var key in self.opt.data)self.opt.fd.append(key,self.opt.data[key])}SETTER('loading/show');UPLOAD(self.opt.url,self.opt.fd,function(response,err){input[0].value='';SETTER('loading/hide',500);if(!response&&err)self.opt.callback(null,err);else if(response instanceof Array&&response[0]&&response[0].error)self.opt.callback(null,response[0].error);else self.opt.callback(response)},self.opt.progress)};self.processimage=function(file,callback){var name=self.preparefilename(file.name.replace(/\.(ico|png|jpeg|gif|svg|webp)$/,self.opt.background==='transparent'?'.png':'.jpg'));self.getorientation(file,function(orient){var reader=new FileReader();reader.onload=function(){var img=new Image();img.onload=function(){if(self.opt.keeporiginal&&img.width==self.opt.width&&img.height==self.opt.height)fetch(reader.result).then(res=>res.blob()).then(blob=>callback(name,blob));else self.resizeimage(img,name,callback)};img.crossOrigin='anonymous';if(orient<2)img.src=reader.result;else self.resetorientation(reader.result,orient,url=>img.src=url)};reader.readAsDataURL(file)})};var resizewidth=function(w,h,size){return Math.ceil(w*(size/h))};var resizeheight=function(w,h,size){return Math.ceil(h*(size/w))};self.resizeimage=function(image,name,callback){var opt=self.opt,canvas=document.createElement('canvas');var ctx=canvas.getContext('2d');canvas.width=opt.width;canvas.height=opt.height;if(opt.background!=='transparent'){ctx.fillStyle=opt.background||'#FFFFFF';ctx.fillRect(0,0,opt.width,opt.height)}var w=0,h=0,x=0,y=0,is=false,diff=0;if(image.width>opt.width||image.height>opt.height){if(image.width>image.height){w=resizewidth(image.width,image.height,opt.height);h=opt.height;if(w<opt.width){w=opt.width;h=resizeheight(image.width,image.height,opt.width)}if(w>opt.width){diff=w-opt.width;x-=(diff/2)>>0}is=true}else if(image.height>image.width){w=opt.width;h=resizeheight(image.width,image.height,opt.width);if(h<opt.height){h=opt.height;w=resizewidth(image.width,image.height,opt.height)}if(h>opt.height){diff=h-opt.height;y-=(diff/2)>>0}is=true}}if(!is){if(image.width<opt.width&&image.height<opt.height){w=image.width;h=image.height;x=(opt.width/2)-(image.width/2);y=(opt.height/2)-(image.height/2)}else if(image.width>=image.height){w=opt.width;h=image.height*(opt.width/image.width);y=(opt.height/2)-(h/2)}else{h=opt.height;w=(image.width*(opt.height/image.height))>>0;x=(opt.width/2)-(w/2)}}ctx.drawImage(image,x,y,w,h);var base64=opt.background==='transparent'?canvas.toDataURL('image/png'):canvas.toDataURL('image/jpeg',(opt.quality||90)*0.01);fetch(base64).then(res=>res.blob()).then(blob=>callback(name,blob))};self.getorientation=function(file,callback){var reader=new FileReader();reader.onload=function(e){var view=new DataView(e.target.result);if(view.getUint16(0,false)!=0xFFD8)return callback(-2);var length=view.byteLength,offset=2;while(offset<length){var marker=view.getUint16(offset,false);offset+=2;if(marker==0xFFE1){if(view.getUint32(offset+=2,false)!=0x45786966)return callback(-1);var little=view.getUint16(offset+=6,false)==0x4949;offset+=view.getUint32(offset+4,little);var tags=view.getUint16(offset,little);offset+=2;for(var i=0;i<tags;i++)if(view.getUint16(offset+(i*12),little)==0x0112)return callback(view.getUint16(offset+(i*12)+8,little))}else if((marker&0xFF00)!=0xFF00)break;else offset+=view.getUint16(offset,false)}return callback(-1)};reader.readAsArrayBuffer(file.slice(0,64*1024))};self.resetorientation=function(src,srcOrientation,callback){var img=new Image();img.onload=function(){var width=img.width,height=img.height,canvas=document.createElement('canvas');var ctx=canvas.getContext('2d');canvas.width=width;canvas.height=height;switch(srcOrientation){case 2:ctx.transform(-1,0,0,1,width,0);break;case 3:ctx.transform(-1,0,0,-1,width,height);break;case 4:ctx.transform(1,0,0,-1,0,height);break;case 5:ctx.transform(0,1,1,0,0,0);break;case 6:ctx.transform(-1,0,0,1,width,0);break;case 7:ctx.transform(0,-1,-1,0,height,width);break;case 8:ctx.transform(0,-1,1,0,0,width);break}ctx.drawImage(img,0,0);if(srcOrientation===6){var canvas2=document.createElement('canvas');canvas2.width=width;canvas2.height=height;var ctx2=canvas2.getContext('2d');ctx2.scale(-1,1);ctx2.drawImage(canvas,-width,0);callback(canvas2.toDataURL())}else callback(canvas.toDataURL())};img.src=src}});

COMPONENT('floatingbox','zindex:10',function(self,config,cls){var clsvisible='floatingbox-visible',is=false,open=[],processed={},makepath=function(val,scope){return val.replace(/\?/g,scope)};self.readonly();self.singleton();self.make=function(){var e_click=function(e){if(e.target===self.dom)self.hide()};var e_resize=function(){is&&self.hide(true)};self.bindedevents=false;self.bindevents=function(){if(!self.bindedevents){$(document).on('click',e_click);$(W).on('resize',e_resize);self.bindedevents=true}};self.unbindevents=function(){if(self.bindedevents){self.bindedevents=false;$(document).off('click',e_click);$(W).off('resize',e_resize)}};var fn=function(){is&&self.hide(true)};self.css('z-index',config.zindex);self.on('reflow + resize + resize2',fn);self.aclass(cls+'-container');$(W).on('scroll',fn)};var animate=function(el){el.aclass(clsvisible)};self.show=function(opt){opt.box=$('.floatingbox[data-id="{0}"]'.format(opt.id));if(!opt.box.length){if(opt.url){if(!processed[opt.url]){processed[opt.url]=1;IMPORT(opt.url,function(){setTimeout(self.show,100,opt)},function(content){return ADAPT(opt.path,opt.ID||opt.id||'',content)});return}}setTimeout(self.show,500,opt);return}opt.config=(opt.box.attrd('config')||'').parseConfig();if(opt.config.scope)opt.scope=opt.config.scope;else if(opt.config.path)opt.path=opt.config.path;opt.initialized=1;if(!opt.box[0].$processed){opt.initialized=0;opt.box[0].$processed=true;self.dom.appendChild(opt.box[0]);opt.box.rclass('invisible hidden')}var element=opt.element?$(opt.element):null;setTimeout(self.bindevents,500);var w=opt.box.width();var offset=element?element.offset():null;var width=w+(opt.offsetWidth||0);var options={left:opt.x||0,top:opt.y||0};if(opt.minwidth&&width<opt.minwidth){width=opt.minwidth;options.width=width}else if(opt.maxwidth&&width>opt.maxwidth){width=opt.maxwidth;options.width=width}if(element){switch(opt.align){case'center':options.left=Math.ceil((offset.left-width/2)+(opt.element.innerWidth()/2));break;case'right':options.left=(offset.left-width)+opt.element.innerWidth();break;default:options.left=offset.left;break}options.top=opt.position==='bottom'?((offset.top-opt.box.height())+element.height()):offset.top}if(opt.offsetX)options.left+=opt.offsetX;if(opt.offsetY)options.top+=opt.offsetY;if(opt.scrolltop)options.top-=$(W).scrollTop();var mw=width,mh=opt.box.height();if(options.left<0)options.left=10;else if((mw+options.left)>WW)options.left=(WW-mw)-10;if(options.top<0)options.top=10;else if((mh+options.top)>WH)options.top=(WH-mh)-10;options['z-index']=opt.config.zindex||(config.zindex+open.length+1);opt.box.css(options);opt.box.SETTER('*/resize');setTimeout(animate,50,opt.box);if(!open.findItem('id',opt.id))open.push(opt);if(!opt.scope)opt.scope=opt.box.attrd('scope');opt.prevscope=M.scope();opt.scope&&M.scope(opt.scope);self.aclass(cls+'-visible',opt.delay||0);opt.init&&opt.init();if(!opt.initialized&&opt.config.init)EXEC(makepath(opt.config.init,opt.scope),opt.box);opt.config.reload&&EXEC(makepath(opt.config.reload,opt.scope),opt.box);opt.mouseleave&&opt.box.on('mouseleave',function(e){opt.mouseleave(e,function(){close(opt)})});opt.autofocus&&self.autofocus(opt.autofocus);is=true;opt.show&&opt.show(opt.box)};var close=function(item){if(item){item.box.rclass(clsvisible);item.hide&&item.hide(item.box);item.config.hide&&EXEC(makepath(item.config.hide,item.scope),item.box);item.mouseleave&&item.box.off('mouseleave',item.mouseleave);item.prevscope&&M.scope(item.prevscope)}};self.hide=function(all){if(all){if(typeof(all)==='string'){var index=open.findIndex('id',all);var count=open.length-index;for(var i=0;i<=count;i++)close(open.pop())}else{while(open.length)close(open.pop())}}else close(open.pop());if(!open.length){self.rclass(cls+'-visible');self.unbindevents()}}});

COMPONENT('floatinginput','minwidth:200',function(self,config,cls){var cls2='.'+cls,timeout,icon,plus,input,summary,area,is=false,plusvisible=false;self.readonly();self.singleton();self.nocompile&&self.nocompile();self.configure=function(key,value,init){if(init)return;switch(key){case'placeholder':self.find('input').prop('placeholder',value);break}};self.make=function(){self.aclass(cls+' hidden');self.append('<div class="{1}-summary hidden"></div><div class="{1}-input"><span class="{1}-add hidden"><i class="ti ti-plus"></i></span><span class="{1}-button"><i class="ti ti-pencil"></i></span><div class="{1}-control"><input type="text" placeholder="{0}" name="dir{2}" autocomplete="dir{2}" /><textarea name="dirt{2}" placeholder="{0}"></textarea></div></div'.format(config.placeholder,cls,Date.now()));input=self.find('input');icon=self.find(cls2+'-button').find('i');plus=self.find(cls2+'-add');summary=self.find(cls2+'-summary');area=self.find('textarea');self.event('click',cls2+'-button',function(e){input.val('');area.val('');e.stopPropagation();e.preventDefault()});self.event('click',cls2+'-add',function(){if(self.opt.callback){self.opt.scope&&M.scope(self.opt.scope);self.opt.callback(self.opt.multiline?area.val():input.val(),self.opt.element,true);self.hide()}});self.event('keydown','input,textarea',function(e){switch(e.which){case 27:self.hide();break;case 13:if(!self.opt.multiline){if(self.opt.callback){self.opt.scope&&M.scope(self.opt.scope);self.opt.callback(this.value,self.opt.element)}self.hide()}break}});var e_click=function(e){var node=e.target,count=0;if(is){while(true){var c=node.getAttribute('class')||'';if(c.indexOf(cls+'-input')!==-1)return;node=node.parentNode;if(!node||!node.tagName||node.tagName==='BODY'||count>3)break;count++}}else{is=true;while(true){var c=node.getAttribute('class')||'';if(c.indexOf(cls)!==-1){is=false;break}node=node.parentNode;if(!node||!node.tagName||node.tagName==='BODY'||count>4)break;count++}}is&&self.hide(0)};var e_resize=function(){is&&self.hide(0)};self.bindedevents=false;self.bindevents=function(){if(!self.bindedevents){$(document).on('click',e_click);$(W).on('resize',e_resize);self.bindedevents=true}};self.unbindevents=function(){if(self.bindedevents){self.bindedevents=false;$(document).off('click',e_click);$(W).off('resize',e_resize)}};self.event('input','input,textarea',function(){var is=!!this.value;if(plusvisible!==is){plusvisible=is;plus.tclass('hidden',!this.value)}});var fn=function(){is&&self.hide(1)};self.on('reflow + scroll + resize + resize2',fn)};self.show=function(opt){var el=opt.element instanceof jQuery?opt.element[0]:opt.element;self.tclass(cls+'-default',!opt.render);if(!opt.minwidth)opt.minwidth=200;if(is){clearTimeout(timeout);if(self.target===el){self.hide(1);return}}self.initializing=true;self.target=el;plusvisible=false;var element=$(opt.element);setTimeout(self.bindevents,500);self.opt=opt;opt.class&&self.aclass(opt.class);if(opt.multiline){area.val(opt.value||'');area.prop('maxlength',opt.maxlength||1000);input.val('')}else{input.val(opt.value||'');input.prop('maxlength',opt.maxlength||100);area.val('')}self.target=element[0];var w=element.width();var offset=element.offset();var width=w+(opt.offsetWidth||0);if(opt.minwidth&&width<opt.minwidth)width=opt.minwidth;else if(opt.maxwidth&&width>opt.maxwidth)width=opt.maxwidth;var ico=opt.icon?self.faicon(opt.icon):'ti ti-pencil-alt';icon.rclass2('ti').aclass(ico).rclass('hidden');if(opt.value){plusvisible=true;plus.rclass('hidden')}else plus.aclass('hidden');var tmp=opt.multiline?area:input;tmp.prop('placeholder',opt.placeholder||config.placeholder);var options={left:0,top:0,width:width};summary.tclass('hidden',!opt.summary).html(opt.summary||'');switch(opt.align){case'center':options.left=Math.ceil((offset.left+w/2)-(width/2));break;case'right':options.left=(offset.left-width)+w;break;default:options.left=offset.left;break}options.top=opt.position==='bottom'?((offset.top-self.height())+element.height()):offset.top;options.scope=M.scope?M.scope():'';area.tclass('hidden',opt.multiline!=true);input.tclass('hidden',opt.multiline==true);self.tclass(cls+'-multiline',opt.multiline==true);if(opt.multiline)area.css('height',(typeof(opt.height)==='number'?(opt.height+'px'):opt.height)||'100px');if(opt.offsetX)options.left+=opt.offsetX;if(opt.offsetY)options.top+=opt.offsetY;self.css(options);!isMOBILE&&setTimeout(function(){opt.select&&tmp[0].select();tmp.focus()},200);self.tclass(cls+'-monospace',!!opt.monospace);self.rclass('hidden');setTimeout(function(){self.initializing=false;is=true;if(self.opt&&self.target&&self.target.offsetParent)self.aclass(cls+'-visible');else self.hide(1)},100)};self.hide=function(sleep){if(!is||self.initializing)return;clearTimeout(timeout);timeout=setTimeout(function(){self.unbindevents();self.rclass(cls+'-visible').aclass('hidden');if(self.opt){self.opt.close&&self.opt.close();self.opt.class&&self.rclass(self.opt.class);self.opt=null}is=false},sleep?sleep:100)}});

COMPONENT('floatingsearch','height:46',function(self,config,cls){var is=false,input;self.make=function(){self.aclass(cls+' hidden');self.append('<div class="close"><i class="ti ti-times"></i></div><div class="icon"><i class="ti ti-search"></i></div><form action="#" onsubmit="return false" class="input"><input placeholder="{1}" data-jc-bind type="text" name="input{2}" autocomplete="new-password" /></form>'.format(cls,config.placeholder,Date.now()));if(config.height!==46){self.find('.close,.icon,input').css('line-height',(config.height-2)+'px');self.find('.close').css('width',config.height+'px');self.find('.input').css('margin-right',(config.height+5)+'px');self.css('height',config.height+'px')}input=self.find('input').on('keydown',function(e){if(e.which===27)self.hide()}).on('input',self.toggleicon)[0];self.event('click','.close',self.hide);self.event('click','.icon',function(){if(is){input.value&&self.set('',2);self.toggleicon();input.focus()}})};self.toggleicon=function(){var tmp=!!input.value;if(is!==tmp){is=tmp;self.find('.icon').find('i').tclass('ti-search',!is).tclass('ti-times',is);self.tclass(cls+'-filled',is)}};self.hide=function(){input.value&&self.set('',2);self.aclass('hidden')};self.show=function(){self.toggleicon();self.rclass('hidden');self.find('input').focus()}});

COMPONENT('flow','width:6000;height:6000;grid:25;markers:1;curvedlines:1;horizontal:1;steplines:1;snapping:0;animationradius:5;outputoffsetY:0;outputoffsetX:0;inputoffsetY:0;inputoffsetX:0;history:100;multiple:1;animationlimit:100;animationlimitconnection:5;allowpause:1',function(self,config,cls){var D='__',drag={};self.readonly();self.meta={};self.el={};self.op={};self.cache={};self.paused={};self.animations={};self.animations_token=0;self.info={zoom:100};self.undo=[];self.redo=[];self.focused=null;self.groupid='';self.make=function(){config.horizontal=1;self.aclass(cls);self.html(('<div class="{0}-selection hidden"></div><div class="{0}-groups"></div><svg width="{width}" height="{height}" xmlns="http://www.w3.org/2000/svg" class="{0}-connections"><defs><marker id="{0}-arrow" viewbox="0 0 10 10" refX="5" refY="5" markerwidth="4" markerheight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" /></marker></defs><g class="lines"></g><g class="anim"></g></svg><svg width="{width}" height="{height}" xmlns="http://www.w3.org/2000/svg">'+(config.grid?'<defs><pattern id="jflowgrid" width="{grid}" height="{grid}" patternunits="userSpaceOnUse"><path d="M {grid} 0 L 0 0 0 {grid}" fill="none" class="{0}-grid" shape-rendering="crispEdges" /></pattern></defs><rect width="100%" height="100%" fill="url(#jflowgrid)" shape-rendering="crispEdges" />':'')+'</svg>').format(cls).arg(config));var svg=self.find('svg');self.el.svg=svg.eq(0);self.el.grid=svg.eq(1);self.el.selection=self.find('.'+cls+'-selection');self.el.anim=self.el.svg.find('g.anim');self.el.lines=self.el.svg.find('g.lines');self.el.groups=self.find('.'+cls+'-groups');self.template=Tangular.compile('<div class="component invisible{{ if inputs && inputs.length}} hasinputs{{ fi}}{{ if outputs && outputs.length}} hasoutputs{{ fi}}{{ if component}} f-{{ component}}{{ fi}}" data-id="{{ id}}" style="top:{{ y}}px;left:{{ x}}px"><div class="area"><div class="content">{{ html | raw}}</div>{{ if inputs && inputs.length}}<div class="inputs">{{ foreach m in inputs}}<div class="input" data-index="{{ if m.id}}{{ m.id}}{{ else}}{{ $index}}{{ fi}}"><i class="component-io"></i><span>{{ if m.name}}{{ m.name | raw}}{{ else}}{{ m | raw}}{{ fi}}</span></div>{{ end}}</div>{{ fi}}{{ if outputs && outputs.length}}<div class="outputs">{{ foreach m in outputs}}<div class="output{{ if m.type}} output-{{ m.type}}{{ fi}}" data-index="{{ if m.id}}{{ m.id}}{{ else}}{{ $index}}{{ fi}}"><i class="component-io"></i><span>{{ if m.name}}{{ m.name | raw}}{{ else}}{{ m | raw}}{{ fi}}</span></div>{{ end}}</div>{{ fi}}</div></div>');self.aclass(cls+'-'+(config.horizontal?'h':'v'));drag.touchmove=function(e){var evt=e.touches[0];drag.lastX=evt.pageX;drag.lastY=evt.pageY};drag.touchend=function(e){drag.unbind();if(!drag.lastX||!drag.lastY)return;e.target=document.elementFromPoint(drag.lastX,drag.lastY);if(e.target&&e.target.tagName!=='SVG')e.target=$(e.target).closest('svg')[0];if(e.target){var pos=self.op.position();e.pageX=drag.lastX;e.pageY=drag.lastY;e.offsetX=e.pageX-pos.left;e.offsetY=e.pageY-pos.top;setTimeout(drag.drop,100,e)}};drag.bind=function(){$(document).on('touchmove',drag.touchmove).on('touchend',drag.touchend)};drag.unbind=function(){$(document).off('touchmove',drag.touchmove).off('touchend',drag.touchend)};drag.handler=function(e){if(!HIDDEN(self.element)){drag.el=$(e.target);self.aclass(cls+'-dragged');e.touches&&drag.bind();var dt=e.originalEvent.dataTransfer;dt&&dt.setData('text','1')}drag.lastX=0;drag.lastY=0;drag.clickX=e.offsetX;drag.clickY=e.offsetY};drag.handler_end=function(){self.rclass(cls+'-dragged')};drag.drop=function(e){var meta={};meta.pageX=e.pageX;meta.pageY=e.pageY;meta.offsetX=e.offsetX;meta.offsetY=e.offsetY;meta.clickX=drag.clickX;meta.clickY=drag.clickY;meta.el=drag.el;meta.target=$(e.target);config.ondrop&&self.EXEC(config.ondrop,meta,self)};var doc=$(document);doc.on('dragstart touchstart','[draggable]',drag.handler);doc.on('dragend touchend','[draggable]',drag.handler_end);self.el.grid.on('dragenter dragover dragexit drop dragleave',function(e){switch(e.type){case'drop':drag.drop(e);break}e.preventDefault()})};self.destroy=function(){$(document).off('dragstart touchstart',drag.handler).off('dragend touchend',drag.handler_end)};self.getOffset=function(){return self.element.offset()};var rebuilding=false,rebuildagain=false;self.setter=function(value,path,type){if(rebuilding){rebuildagain=true;return}if(type===2||!value)return;var keys=Object.keys(value);var onmake=config.onmake?GET(self.makepath(config.onmake)):null;var ondone=config.ondone?GET(self.makepath(config.ondone)):null;var onremove=config.onremove?GET(self.makepath(config.onremove)):null;var prev=self.cache,ischanged=false,recompile=false,tmp,el;rebuilding=true;self.cache={};self.paused={};self.animations_token=Date.now();self.animations={};for(var i=0;i<keys.length;i++){var key=keys[i];if(key==='paused'){self.paused=value[key];continue}if(key==='tabs')continue;if(key==='groups'){self.refresh_groups();continue}var com=value[key],checksum=self.helpers.checksum(com);var tmp=prev[key],rebuild=true;com.id=key;if(tmp){if(tmp.checksum===checksum)rebuild=false;else tmp.checksum=checksum;delete prev[key];el=tmp.el}if(rebuild){tmp&&tmp.el.aclass('removed').attrd('id','removed');var html=self.template(com);if(!recompile&&html&&html.COMPILABLE())recompile=true;html=$(html);self.append(html);el=self.find('.component[data-id="{id}"]'.arg(com));if(com.tab){el.aclass('tab-'+com.tab);el[0].$flowtab=com.tab}else el[0].$flowtab='';com.onmake&&com.onmake(el,com);onmake&&onmake(el,com);com.element=html.find('.content').eq(0);if(!ischanged&&com.connections&&Object.keys(com.connections).length)ischanged=true;if(type===1)self.op.undo({type:'component',id:com.id,instance:com})}else if(el){var tab=el[0].$flowtab;if(tab!==com.tab){tab&&el.rclass2(tab);if(com.tab){el.aclass('tab-'+com.tab);el[0].$flowtab=com.tab}else el[0].$flowtab=''}el.css({left:com.x,top:com.y})}if(!com.element)com.element=el.find('.content').eq(0);if(!com.connections)com.connections={};self.cache[key]={id:key,instance:com,el:el,checksum:checksum,actions:com.actions||{}}}if(!value.groups)self.el.groups.find('> div').remove();var removedconn=[];for(var key in prev){tmp=prev[key];tmp.instance.onremove&&tmp.instance.onremove(tmp.el,tmp.instance);onremove&&onremove(tmp.el,tmp.instance);var conn=self.el.lines.find('.from'+D+key+',.to'+D+key).aclass('connection removed hidden');for(var i=0;i<conn.length;i++){var dom=conn[i];removedconn.push({fromid:dom.getAttribute('data-from'),fromindex:dom.getAttribute('data-fromindex'),toid:dom.getAttribute('data-to'),toindex:dom.getAttribute('data-toindex')})}tmp.el.remove()}for(var key in self.cache){tmp=self.cache[key];tmp.instance.ondone&&tmp.instance.ondone(tmp.el,tmp.instance);ondone&&ondone(tmp.el,tmp.instance)}self.el.lines.find('path').aclass('removed');keys=Object.keys(self.cache);var reconnect=function(){for(var i=0;i<keys.length;i++){var key=keys[i];tmp=self.cache[key];if(tmp){tmp.el.rclass('invisible');tmp.width=tmp.el.width();tmp.instance.connections&&self.reconnect(tmp)}}self.find('.removed').remove();rebuilding=false;for(var i=0;i<removedconn.length;i++){var conn=removedconn[i];self.helpers.checkconnectedinput(conn.toid,conn.toindex);self.helpers.checkconnectedoutput(conn.fromid,conn.fromindex);var com=self.find('.component[data-id="'+conn.fromid+'"]');com.tclass('connected',self.el.lines.find('.from'+D+'_'+conn.fromid).length>0)}if(rebuildagain)self.refresh();rebuildagain=false};if(type==='refresh'){reconnect()}else{setTimeout(reconnect,300);self.undo=[];self.redo=[];self.op.undo();self.op.redo()}self.op.refreshinfo();COMPILE()};self.configure=function(key,value,init){if(!init){if(key==='curvedlines')setTimeout(self.op.reposition,100)}};self.reconnect=function(m){for(var index in m.instance.connections){var output=m.el.find('.output[data-index="{0}"]'.format(index));var inputs=m.instance.connections[index],problem=false;for(var j=0;j<inputs.length;j++){var com=inputs[j],el=self.find('.component[data-id="{0}"]'.format(com.id));var input=el.find('.input[data-index="{0}"]'.format(com.index));if(!self.el.connect(output,input,true,com)){inputs[j]=null;problem=true}}if(problem){index=0;while(true){var item=inputs[index];if(item===undefined)break;if(item===null)inputs.splice(index,1);else index++}}}};self.selected=function(callback){var output={},arr,tmp,el;output.components=[];output.connections=[];arr=self.find('.component-selected');for(var i=0;i<arr.length;i++){el=arr[i];tmp=self.cache[el.getAttribute('data-id')];tmp&&output.components.push(tmp)}arr=self.find('.connection-selected');for(var i=0;i<arr.length;i++){el=arr[i];var cls=el.getAttribute('class').split(' ');for(var j=0;j<cls.length;j++){var c=cls[j];if(c.substring(0,4+D.length)==='conn'+D){var a=c.split(D);var tmp={};tmp.output=self.cache[a[1]].instance;tmp.input=self.cache[a[2]].instance;tmp.fromid=a[1];tmp.toid=a[2];tmp.fromindex=a[3];tmp.toindex=a[4];output.connections.push(tmp)}}}callback&&callback(output);return output}});EXTENSION('flow:helpers',function(self,config){var D='__';self.helpers={};self.helpers.checksum=function(obj){var checksum=JSON.stringify({a:obj.outputs||EMPTYARRAY,b:obj.inputs||EMPTYARRAY,c:obj.html});return HASH(checksum,true).toString(36)};self.helpers.connect=function(x1,y1,x4,y4,findex,tindex,reverse){if(config.markers&&tindex!==-1&&findex!==-1){if(reverse)x1+=11;x4-=14}if(tindex===-1)tindex=0;if(findex===-1)findex=0;var y=(y4-y1)/2;var x2=x1,y2=y1+y,x3=x4,y3=y1+y,s=' ';if(config.curvedlines)return self.helpers.diagonal(x1,y1,x4,y4);var paddingO=config.steplines?Math.ceil(15*((findex+1)/100)*50):15;var paddingI=config.steplines?Math.ceil(15*((tindex+1)/100)*50):15;var can=config.steplines&&Math.abs(x1-x4)>50&&Math.abs(y1-y4)>50;var builder=[];builder.push('M'+(x1>>0)+s+(y1>>0));if(config.horizontal){if(can)x2+=paddingO;x2+=paddingO*2;builder.push('L'+(x2>>0)+s+(y1>>0));if(can){if((x1!==x4||y1!==y4)){var d=Math.abs(paddingO-paddingI)/2>>0;y2+=d;builder.push('L'+(x2>>0)+s+(y2>>0));y3+=d;x3-=paddingI*3;builder.push('L'+(x3>>0)+s+(y3>>0))}x4-=paddingI}if(can)x4-=paddingI*2;else x4-=paddingI;builder.push('L'+(x4>>0)+s+(y4>>0));if(can)x4+=paddingI*2;x4+=paddingI}else if(can){if((x1!==x4||y1!==y4)){builder.push('L'+(x2>>0)+s+(y2>>0));builder.push('L'+(x3>>0)+s+(y3>>0))}}builder.push('L'+(x4>>0)+s+(y4>>0));return builder.join(s)};self.helpers.move1=function(x1,y1,conn,findex,tindex){var pos=conn.attrd('offset').split(',');conn.attr('d',self.helpers.connect(x1,y1,+pos[2],+pos[3],findex,tindex,conn.hclass('connection-type-transform')));conn.attrd('offset',x1+','+y1+','+pos[2]+','+pos[3])};self.helpers.checkconnected=function(meta){meta.el.tclass('connected',Object.keys(meta.instance.connections).length>0)};self.helpers.checkconnectedoutput=function(id,index){var is=!!self.el.lines.find('.from'+D+id+D+index).length;self.find('.component[data-id="{0}"]'.format(id)).find('.output[data-index="{0}"]'.format(index)).tclass('connected',is)};self.helpers.checkconnectedinput=function(id,index){var is=!!self.el.lines.find('.to'+D+id+D+index).length;self.find('.component[data-id="{0}"]'.format(id)).find('.input[data-index="{0}"]'.format(index)).tclass('connected',is)};self.helpers.move2=function(x4,y4,conn,findex,tindex){var pos=conn.attrd('offset').split(',');conn.attr('d',self.helpers.connect(+pos[0],+pos[1],x4,y4,findex,tindex,conn.hclass('connection-type-transform')));conn.attrd('offset',pos[0]+','+pos[1]+','+x4+','+y4)};self.helpers.isconnected=function(output,input){var co=output.closest('.component');var ci=input.closest('.component');var coid=self.cache[co.attrd('id')];var ciid=self.cache[ci.attrd('id')];if(coid.id===ciid.id)return true;if(coid.actions.disabled||coid.actions.connect===false||ciid.actions.disabled||ciid.actions.connect===false)return true;var el=$('.conn'+D+co.attrd('id')+D+ci.attrd('id')+D+output.attrd('index')+D+input.attrd('index'));return el.length>0};self.helpers.position=function(el,isout){var component=self.op.cacheclosest(el,'.component');var conn=self.op.cacheclosest(el,isout?'.output':'.input');var container=self.op.cacheclosest(el,isout?'.outputs':'.inputs');var pos=component.position();var offset=conn.position();var containeroffset=container.position();var x=self.op.zoom(pos.left+offset.left,true)+(isout?config.outputoffsetX:config.inputoffsetX);var y=self.op.zoom(pos.top+containeroffset.top+offset.top,true)+(isout?config.outputoffsetY:config.inputoffsetY)+(el.height()/2+2);var plusX=0;if(config.horizontal){if(isout)plusX=conn.innerWidth()+2;else plusX+=self.op.zoom(6)}var id=component.attrd('id');var indexid=el.attrd('index');return{x:(x+plusX)>>0,y:y>>0,id:id,index:indexid,indexoffset:el.index()}};self.helpers.parseconnection=function(line){var arr=line.attr('class').split(' ');for(var i=0;i<arr.length;i++){if(arr[i].substring(0,4+D.length)==='conn'+D){var info=arr[i].split(D);var obj={};obj.fromid=info[1];obj.toid=info[2];obj.fromindex=info[3];obj.toindex=info[4];return obj}}};self.helpers.diagonal=function(x1,y1,x2,y2){var minx=Math.min(x1,x2);var miny=Math.min(y1,y2);var mx=minx+(Math.abs(x1-x2)/2);var my=miny+(Math.abs(y1-y2)/2);var distx=mx-minx,disty=my-miny;if(config.horizontal){var dist=range(range(20,70,disty),range(70,180,mx),distx);if(disty<distx){var d=distx-disty;d=distx/d;dist=dist-(dist/d)}return'M'+x1+','+y1+' Q '+(x1+dist)+' '+(y1)+' '+mx+' '+my+' T '+x2+' '+y2}else{var dist=range(range(20,70,distx),range(70,180,my),disty);return'M'+x1+','+y1+' Q '+x1+' '+(y1+dist)+' '+mx+' '+my+' Q '+x2+' '+(y2-dist)+' '+x2+' '+y2}};function range(min,max,val){if(val<min)return min;if(val>max)return max;return val}});EXTENSION('flow:operations',function(self,config,cls){var D='__';var removeconnections=function(next,removed){var connections=next.instance.connections,meta={},onremove=function(conn){var is=conn.id===removed.id;if(is){meta.output=next.instance;meta.input=removed.instance;meta.fromid=next.id;meta.toid=removed.id;meta.toindex=conn.index;next.instance.ondisconnect&&next.instance.ondisconnect.call(next.instance,meta);removed.instance.ondisconnect&&removed.instance.ondisconnect.call(removed.instance,meta);config.ondisconnect&&self.EXEC(config.ondisconnect,meta)}return is};for(var index in connections){var conn=connections[index];meta.fromindex=index;connections[index]=conn=conn.remove(onremove);if(conn.length===0){delete connections[index];self.helpers.checkconnectedoutput(next.id,index)}}self.helpers.checkconnected(next)};var isoutcache={};self.op.deselect=function(){var selection=W.getSelection?W.getSelection():null;selection&&selection.removeAllRanges()};self.op.isoutcache=function(){var parent=self.parent('auto');var offset=parent[0]===W?null:parent.offset();if(offset){if(!offset.left&&!offset.top)offset=parent.position();isoutcache.is=parent[0]!==W&&parent[0].tagName!=='BODY'&&parent[0].tagName!=='HTML';isoutcache.left=offset.left+10;isoutcache.top=offset.top+10;isoutcache.width=parent.width()-10;isoutcache.height=parent.height()-10}else isoutcache.is=false};self.op.isout=function(e){if(isoutcache.is){if(e.pageX<isoutcache.left||e.pageY<isoutcache.top)return true;if(isoutcache.width&&isoutcache.height){if(e.pageX>(isoutcache.left+isoutcache.width)||e.pageY>(isoutcache.top+isoutcache.height))return true}}};self.op.unselect=function(type,id){var cls='connection-selected';if(type==null||type==='connections'){self.el.lines.find('.'+cls).rclass(cls);self.el.lines.find('.highlight').rclass('highlight')}cls='component-selected';if(type==null||type==='component'){var el=id?self.find('.'+cls+'[data-id="'+id+'"]'):self.find('.'+cls);el.rclass(cls)}cls='group-selected';if(type==null||type==='group'){var el=id?self.find('.'+cls+'[data-id="'+id+'"]'):self.find('.'+cls);el.rclass(cls)}if(self.info.selected&&(!id||self.info.selected.id===id)){self.info.selected=null;self.info.type='';self.op.refreshinfo()}};self.op.modified=function(){self.change(true);self.update(true,2)};self.op.clean=function(){var model=self.get();for(var key in model){if(key==='paused'){var count=0;for(var subkey in model.paused){var tmp=subkey.split(D);var rem=false,m=model[tmp[1]];if(!m)rem=true;if(!rem){var arr=tmp[0]==='input'?m.inputs:m.outputs;if(arr&&arr.length>0){if(typeof(arr[0])==='object'){if(!arr.findItem('id',tmp[2]))rem=true}else if(!arr[+tmp[2]])rem=true}else rem=true}if(rem)delete model.paused[subkey];else count++}if(!count)delete model.paused;continue}var com=model[key];for(var subkey in com.connections){var tmp=model[key].connections[subkey],index=0;while(true){var conn=tmp[index];if(conn==null)break;if(!model[conn.id]||!model[conn.id].inputs){tmp.splice(index,1);continue}index++}if(!tmp.length)delete model[key].connections}}};self.op.remove=function(id,noundo){var tmp=self.cache[id];if(tmp==null){var arr=(self.get().groups||EMPTYARRAY);tmp=arr.findItem('id',id);if(tmp&&(!tmp.actions||tmp.actions.remove===false)){tmp.onremove&&tmp.onremove(null,tmp);config.onremove&&self.EXEC(config.onremove,null,tmp,'group');arr.splice(arr.indexOf(tmp),1);self.op.modified();self.find('.'+cls+'-group[data-id="{0}"]'.format(id)).remove();self.op.unselect();if(!noundo)self.op.undo({type:'remove',id:id,instance:tmp,place:'group'});return true}return false}if(tmp.actions.remove===false)return false;tmp.instance.onremove&&tmp.instance.onremove(tmp.el,tmp.instance);config.onremove&&self.EXEC(config.onremove,tmp.el,tmp.instance,'component');delete self.cache[id];delete self.get()[id];self.el.lines.find('.from'+D+id).remove();self.el.lines.find('.to'+D+id).remove();for(var key in self.cache)removeconnections(self.cache[key],tmp);var connections=tmp.instance.connections;for(var index in connections){var conns=connections[index];for(var j=0;j<conns.length;j++){var conn=conns[j];self.helpers.checkconnectedinput(conn.id,conn.index)}}if(!noundo)self.op.undo({type:'remove',id:id,instance:tmp.instance});self.find('.component[data-id="{0}"]'.format(id)).remove();self.op.modified();return true};self.op.select=function(id,noremove){var com=self.cache[id];if(com==null){var group=self.find('.'+cls+'-group[data-id="{0}"]'.format(id));if(group){self.find('.group-selected,.connection-selected,.component-selected').rclass('group-selected connection-selected component-selected');group.aclass('group-selected');self.info.selected=(self.get().groups||EMPTYARRAY).findItem('id',group.attrd('id'));self.info.type='group';self.op.refreshinfo();return true}else return false}var selected='component-selected';if(!noremove)self.find('.'+selected).rclass(selected);self.find('.component[data-id="{0}"]'.format(id)).aclass(selected);self.find('.group-selected,.connection-selected').rclass('group-selected connection-selected');var connections=self.el.lines.find('.from{0},.to{0}'.format(D+id)).aclass('highlight');var parent=self.el.lines[0];for(var i=0;i<connections.length;i++){var dom=connections[i];parent.removeChild(dom);parent.appendChild(dom)}self.info.selected=com.instance;self.info.type='component';self.op.refreshinfo();self.op.deselect();return true};self.op.modify=function(instance,type){if(!instance.changes)instance.changes={};instance.changes[type]=1};self.op.disconnect=function(fromid,toid,fromindex,toindex,noundo){if(typeof(fromid)==='object'){var meta=fromid;toid=meta.toid;fromindex=meta.fromindex;toindex=meta.toindex;fromid=meta.fromid}var a=self.cache[fromid],b=self.cache[toid];if(!a||!b)return false;var ac=a.instance;self.op.modify(a.instance,'disconnect');self.op.modify(b.instance,'disconnect');toindex+='';fromindex+='';var conn=ac.connections[fromindex].findItem(function(conn){return conn.id===toid&&conn.index===toindex});if(!conn||conn.disabled)return false;ac.connections[fromindex].splice(ac.connections[fromindex].indexOf(conn),1);if(!ac.connections[fromindex].length)delete ac.connections[fromindex];if(!noundo)self.op.undo({type:'disconnect',fromid:fromid,toid:toid,fromindex:fromindex,toindex:toindex});self.el.lines.find('.conn{0}{1}{2}{3}'.format(D+fromid,D+toid,D+fromindex,D+toindex)).remove();self.op.modified();self.helpers.checkconnected(a);self.helpers.checkconnectedoutput(fromid,fromindex);self.helpers.checkconnectedinput(toid,toindex);return true};var repositionpending=false,reposition=function(){if(self.$removed)return;if(HIDDEN(self.element)){repositionpending=true;setTimeout(reposition,300);return}repositionpending=false;var arr=self.el.lines.find('.connection');for(var i=0;i<arr.length;i++){var path=$(arr[i]);if(path.hclass('removed'))continue;var meta=self.helpers.parseconnection(path);if(!meta)continue;var output=self.find('.component[data-id="{0}"]'.format(meta.fromid)).find('.output[data-index="{0}"]'.format(meta.fromindex));if(!output.length)continue;var input=self.find('.component[data-id="{0}"]'.format(meta.toid)).find('.input[data-index="{0}"]'.format(meta.toindex));if(!input.length)continue;var a=self.helpers.position(output,true);var b=self.helpers.position(input);var tmp=self.cache[meta.fromid];if(tmp&&tmp.instance){var instance=tmp.instance,output=instance.outputs&&typeof(instance.outputs[0])==='object'?instance.outputs.findItem('id',meta.fromindex):null;var marker='';path.rclass2('connection-type-');if(output&&output.type){path.aclass('connection-type-'+output.type);if(config.markers&&output.type==='transform')marker='url(#{0}-arrow)'.format(cls)}path.attr('marker-start',marker)}else continue;path.attrd('offset',a.x+','+a.y+','+b.x+','+b.y);path.attrd('from',a.id);path.attrd('to',b.id);path.attrd('fromindex',a.index);path.attrd('toindex',b.index);path.attrd('fromindexoffset',a.indexoffset);path.attrd('toindexoffset',b.indexoffset);path.attr('d',self.helpers.connect(a.x,a.y,b.x,b.y,a.indexoffset,b.indexoffset,path.hclass('connection-type-transform')));path.rclass('hidden')}};self.op.cacheclosest=function(el,selector){var cache=el[0].$flowcache;if(!cache)cache=el[0].$flowcache={};return cache[selector]?cache[selector]:cache[selector]=el.closest(selector)};self.op.reposition=function(){if(!repositionpending){repositionpending=true;reposition()}};self.op.zoom=function(val,nooffset){if(self.info.zoom===100)return val;var zoom=self.info.zoom/100,offset=nooffset?0:(((100-self.info.zoom)/10)+(self.info.zoom>100?1:-1));return Math.ceil(val/zoom)-offset};self.op.zoom_reverse=function(val){if(self.info.zoom===100)return val;var zoom=self.info.zoom/100;return Math.ceil(val*zoom)};self.op.position=function(){var obj={},scroll=self.op.cacheclosest(self.element,'.ui-scrollbar-area')[0];if(scroll){obj.scrollTop=scroll.scrollTop;obj.scrollLeft=scroll.scrollLeft}else{obj.scrollTop=0;obj.scrollLeft=0}var offset=self.el.svg.offset();obj.left=offset.left;obj.top=offset.top;return obj};var notifytimeout=null,notifyinfo=function(){notifytimeout=null;config.infopath&&self.SEEX(config.infopath,self.info)};self.op.refreshinfo=function(){notifytimeout&&clearTimeout(notifytimeout);notifytimeout=setTimeout(notifyinfo,100)};self.op.undo=function(value){if(value){if(self.groupid)value.groupid=self.groupid;self.undo.push(value);if(self.undo.length>config.history)self.undo.shift()}config.undopath&&self.SEEX(config.undopath,self.undo)};self.op.redo=function(value){if(value){self.redo.push(value);if(self.redo.length>config.history)self.redo.shift()}config.redopath&&self.SEEX(config.redopath,self.redo)};self.op.resize=function(){setTimeout2(self.ID+'reposition',self.op.reposition,300)};self.on('resize + resize2',self.op.resize)});EXTENSION('flow:map',function(self,config,cls){var events={},drag={},css={};events.move=function(e){if(!drag.is){self.aclass(cls+'-drag');drag.is=true}var x=(drag.x+drag.offset.left)-(e.pageX+drag.offset.left);var y=(drag.y+drag.offset.top)-(e.pageY+drag.offset.top);if(drag.meta){if(x<0){css.left=self.op.zoom(drag.x);css.width=self.op.zoom((x*-1))}else{css.left=self.op.zoom(drag.x-x);css.width=self.op.zoom(drag.x)-css.left}if(y<0){css.top=self.op.zoom(drag.y);css.height=self.op.zoom(y*-1)}else{css.top=self.op.zoom(drag.y-y);css.height=self.op.zoom(drag.y)-css.top}css.left-=self.op.zoom(drag.offset.left);css.top-=self.op.zoom(drag.offset.top);self.el.selection.css(css)}else if(drag.target[0]){var plusY=(y/drag.zoom)>>0;var plusX=(x/drag.zoom)>>0;drag.target[0].scrollLeft=drag.left+plusX;drag.target[0].scrollTop=drag.top+plusY}};events.movetouch=function(e){events.move(e.touches[0])};events.up=function(){self.rclass(cls+'-drag');if(drag.meta){var sel=self.el.selection,pos=sel.position();var fromX=(self.op.zoom(pos.left))>>0;var fromY=(self.op.zoom(pos.top))>>0;var toX=fromX+sel.css('width').parseInt();var toY=fromY+sel.css('height').parseInt();sel.aclass('hidden');for(var key in self.cache){var cache=self.cache[key],instance=self.cache[key].instance,fx=instance.x,fy=instance.y,el=cache.el,tx=instance.x+el.width();var ty=instance.y+el.height();if(fromX<fx&&toX>tx&&fromY<fy&&toY>ty)self.op.select(key,true)}}events.unbind()};events.leave=function(e){if(!e.relatedTarget)events.up(e)};events.bind=function(){if(!events.is){events.is=true;self.element.on('mouseup',events.up);self.element.on('mousemove',events.move);self.element.on('touchend',events.up);self.element.on('touchmove',events.movetouch);$(W).on('mouseleave',events.leave)}};events.unbind=function(){if(events.is){events.is=false;self.element.off('mouseup',events.up);self.element.off('mousemove',events.move);self.element.off('touchend',events.up);self.element.off('touchmove',events.movetouch);$(W).off('mouseleave',events.leave)}};self.event('contextmenu',function(e){self.op.deselect();events.is&&events.up();config.contextmenu&&self.SEEX(config.contextmenu,e,'map');e.preventDefault();e.stopPropagation()});self.event('mousedown touchstart',function(e){if(events.is){events.up();return}if(e.button||e.target.tagName!=='rect')return;self.op.unselect();self.op.deselect();var evt=e.touches?e.touches[0]:e,et=$(e.target);var target=et.closest('.ui-scrollbar-area');drag.is=false;drag.target=target;drag.zoom=self.info.zoom/100;drag.x=evt.pageX;drag.y=evt.pageY;drag.left=0;drag.top=0;drag.meta=evt.metaKey||e.metaKey||evt.ctrlKey||e.ctrlKey;drag.offset=self.getOffset();if(drag.meta){if(target[0]){drag.top=drag.target[0].scrollTop;drag.left=drag.target[0].scrollLeft}css.left=self.op.zoom(drag.x);css.top=self.op.zoom(drag.y);css.width=0;css.height=0;self.el.selection.rclass('hidden').css(css)}else if(drag.target[0]){drag.top=drag.target[0].scrollTop;drag.left=drag.target[0].scrollLeft}events.bind();e.preventDefault();e.stopPropagation();self.el.svg.focus();self.op.deselect()})});EXTENSION('flow:components',function(self,config){var D='__',events={},drag={};drag.css={};self.components_reposition=function(obj){for(var j=0;j<obj.selected.length;j++){var node=obj.selected[j];for(var i=0;i<node.output.length;i++){var conn=$(node.output[i]);var pos=self.helpers.position(conn,true);var arr=self.el.lines.find('.from'+D+pos.id+D+pos.index);for(var k=0;k<arr.length;k++){var ce=$(arr[k]);var findex=+ce.attrd('fromindexoffset');var tindex=+ce.attrd('toindexoffset');self.helpers.move1(pos.x,pos.y,ce,findex,tindex)}}for(var i=0;i<node.input.length;i++){var conn=$(node.input[i]);var pos=self.helpers.position(conn);var arr=self.el.lines.find('.to'+D+pos.id+D+pos.index);var findex=+conn.attrd('fromindexoffset');var tindex=+conn.attrd('toindexoffset');for(var k=0;k<arr.length;k++){var ce=$(arr[k]);var findex=+ce.attrd('fromindexoffset');var tindex=+ce.attrd('toindexoffset');self.helpers.move2(pos.x,pos.y,ce,findex,tindex)}}}};events.move=function(e){if(self.op.isout(e)){events.up(e);return}var x=(e.pageX-drag.x);var y=(e.pageY-drag.y);for(var i=0;i<drag.selected.length;i++){var instance=drag.selected[i];instance.node.css({left:self.op.zoom(instance.pos.left+x),top:self.op.zoom(instance.pos.top+y)})}if(!drag.is)drag.is=true;self.components_reposition(drag)};events.movetouch=function(e){events.move(e.touches[0])};self.components_moved=events.up=function(e,obj,nosnapping){if(!obj)obj=drag;if(obj.is){var undo=[];for(var i=0;i<obj.selected.length;i++){var instance=obj.selected[i],pos=instance.node.position();if(config.snapping&&nosnapping!==true){pos.left=self.op.zoom(pos.left);pos.top=self.op.zoom(pos.top);pos.left+=pos.left%self.op.zoom_reverse(config.snapping);pos.top+=pos.top%self.op.zoom_reverse(config.snapping);instance.node.css(pos)}else{pos.left=self.op.zoom(pos.left);pos.top=self.op.zoom(pos.top)}var data=self.get()[instance.id];undo.push({id:instance.id,x:data.x,y:data.y,newx:pos.left,newy:pos.top,groupid:self.groupid});data.x=pos.left;data.y=pos.top;data.onmove&&data.onmove(instance.node,data);config.onmove&&self.EXEC(config.onmove,instance.node,data,'component');self.op.modify(data,'move')}self.op.undo({type:'move',multiple:undo});self.components_reposition(obj);setTimeout(self.op.modified,1)}events.unbind();var tmp=self.preventreposition;delete self.preventreposition;switch(tmp){case 2:case 3:self.op.reposition();break}};events.leave=function(e){events.up(e)};events.bind=function(){if(!events.is){events.is=true;self.op.isoutcache();self.element.on('mouseup',events.up);self.element.on('mousemove',events.move);self.element.on('touchend',events.up);self.element.on('touchmove',events.movetouch)}};events.unbind=function(){if(events.is){events.is=false;self.element.off('mouseup',events.up);self.element.off('mousemove',events.move);self.element.off('touchend',events.up);self.element.off('touchmove',events.movetouch)}};self.event('contextmenu','.area',function(e){var selected=document.getSelection().toString();if(!selected){events.is&&events.up();var tagName=e.target.tagName;if(tagName==='INPUT'||tagName==='TEXTAREA'||tagName==='SELECT')return;var el=$(this);var id=el.closest('.component').attrd('id');config.contextmenu&&self.SEEX(config.contextmenu,e,'component',self.cache[id].instance);e.preventDefault()}e.stopPropagation()});self.event('dblclick','.area',function(e){var parent=e.target,target;while(true){var cl=parent.classList;if(parent===self.dom||cl.contains('selectable')||parent.tagName==='BUTTON'||parent.tagName==='A'||cl.contains('output')||cl.contains('input'))return;if(cl.contains('component')){target=$(parent);break}parent=parent.parentNode}config.dblclick&&self.SEEX(config.dblclick,self.cache[target.attrd('id')].instance,e)});self.event('mousedown touchstart','.area',function(e){if(events.is){events.up();return}var parent=e.target,clssel='component-selected',target;while(true){var cl=parent.classList;if(parent===self.dom||cl.contains('selectable')||parent.tagName==='BUTTON'||parent.tagName==='A')return;if(cl.contains('component')){target=$(parent);break}parent=parent.parentNode}var selectconnections=function(){var clscon='highlight',more=self.find('.'+clssel);self.el.lines.find('.'+clscon).rclass(clscon);for(var i=0;i<more.length;i++){var sel=$(more[i]);var selid=sel.attrd('id');var selector='.from__{0},.to__{0}'.format(selid);self.el.lines.find(selector).aclass(clscon)}};drag.id=target.attrd('id');var more=self.find('.'+clssel);var ismeta=config.multiple&&(e.metaKey||e.ctrlKey||e.shiftKey);if(ismeta){if(target.hclass(clssel)){self.op.unselect('component',more.length>1?drag.id:null);setTimeout(selectconnections,5);return}}e.preventDefault();var evt=e.touches?e.touches[0]:e,tmp=self.cache[drag.id];self.op.unselect('connections');if(tmp.actions.select!==false){var is=ismeta;if(!is)is=target.hclass(clssel);self.op.select(drag.id,is)}setTimeout(selectconnections,5);if(tmp.actions.move===false)return;self.preventreposition=true;var nodes=self.find('.'+clssel);drag.target=target;drag.x=evt.pageX;drag.y=evt.pageY;drag.zoom=self.info.zoom/100;drag.zoomoffset=((100-self.info.zoom)/10)+(self.info.zoom>100?1:-1);drag.is=false;drag.selected=[];for(var i=0;i<nodes.length;i++){var node=$(nodes[i]);drag.selected.push({id:node.attrd('id'),node:node,pos:node.position(),output:node.find('.output'),input:node.find('.input')})}self.focused&&self.focused.rclass('component-focused');self.focused=target.aclass('component-focused');events.bind();self.op.deselect()})});EXTENSION('flow:connections',function(self,config,cls){var D='__',events={},drag={},prevselected=null;drag.css={};events.move=function(e){if(self.op.isout(e)){events.up(e);return}var x=drag.offsetX+(e.pageX-drag.x);var y=drag.offsetY+(e.pageY-drag.y);drag.path.attr('d',drag.input?self.helpers.connect(self.op.zoom(x),self.op.zoom(y),drag.pos.x,drag.pos.y,-1,drag.realindex):self.helpers.connect(drag.pos.x,drag.pos.y,self.op.zoom(x),self.op.zoom(y),drag.realindex,-1));if(drag.click)drag.click=false};events.movetouch=function(e){var evt=e.touches[0];drag.lastX=evt.pageX;drag.lastY=evt.pageY;events.move(evt)};events.up=function(e){drag.path.remove();events.unbind();if(config.allowpause&&e.target.tagName==='I'&&drag.click&&(Date.now()-drag.ticks)<150){var icon=drag.target.find('.component-io');var clsp='disabled';icon.tclass(clsp);var key=(drag.input?'input':'output')+D+drag.pos.id+D+drag.pos.index;var model=self.get();if(!model.paused)model.paused={};if(icon.hclass(clsp))model.paused[key]=1;else delete model.paused[key];self.op.modify(model[drag.pos.id],'pause');config.onpause&&self.SEEX(config.onpause,key,model.paused[key]===1);setTimeout2(self.ID+'clean',self.op.clean,2000);self.op.modified();return}if(drag.lastX!=null&&drag.lastY!=null)e.target=document.elementFromPoint(drag.lastX,drag.lastY);drag.target.add(drag.targetcomponent).rclass('connecting');if(drag.input){var output=$(e.target).closest('.output');if(!output.length)return;if(self.helpers.isconnected(output,drag.target))return;self.el.connect(output,drag.target)}else{var input=$(e.target).closest('.input');if(!input.length)return;if(self.helpers.isconnected(drag.target,input))return;self.el.connect(drag.target,input)}};events.bind=function(){if(!events.is){events.is=true;self.op.isoutcache();self.element.on('mouseup',events.up);self.element.on('mousemove',events.move);self.element.on('touchend',events.up);self.element.on('touchmove',events.movetouch)}};events.unbind=function(){if(events.is){events.is=false;self.element.off('mouseup',events.up);self.element.off('mousemove',events.move);self.element.off('touchend',events.up);self.element.off('touchmove',events.movetouch)}};self.event('mousedown touchstart','.output,.input',function(e){if(e.button)return;e.preventDefault();e.stopPropagation();drag.click=true;drag.ticks=Date.now();var target=$(this);var evt=e.touches?e.touches[0]:e,com=target.closest('.component');var tmp=self.cache[com.attrd('id')];if(tmp.actions.disabled||tmp.actions.connect===false)return;var offset=self.getOffset();drag.input=target.hclass('input');drag.target=target;drag.index=+target.attrd('index');drag.realindex=target.index();drag.reverse=target.hclass('connection-type-transform');drag.x=evt.pageX;drag.y=evt.pageY;drag.pos=self.helpers.position(target,!drag.input);drag.target.add(com).aclass('connecting');drag.targetcomponent=com;drag.lastX=null;drag.lastY=null;if(evt.offsetX==null||evt.offsetY==null){var off=self.op.position();drag.offsetX=drag.x-off.left;drag.offsetY=drag.y-off.top}else{drag.offsetX=drag.x-offset.left;drag.offsetY=drag.y-offset.top}drag.path=self.el.lines.asvg('path');drag.path.aclass('connection connection-draft');if(config.markers){if(drag.input)drag.path.attr('marker-start','url(#{0}-arrow)'.format(cls));else drag.path.attr('marker-end','url(#{0}-arrow)'.format(cls))}events.bind()});self.el.connect=function(output,input,init,conn){if(!output[0]||!input[0])return false;var a=self.helpers.position(output,true);var b=self.helpers.position(input);var path=self.el.lines.asvg('path');path.aclass('connection from'+D+a.id+' to'+D+b.id+' from'+D+a.id+D+a.index+' to'+D+b.id+D+b.index+' conn'+D+a.id+D+b.id+D+a.index+D+b.index+(HIDDEN(self.element)?' hidden':''));path.attrd('offset',a.x+','+a.y+','+b.x+','+b.y);path.attrd('fromindex',a.index);path.attrd('toindex',b.index);path.attrd('fromindexoffset',a.indexoffset);path.attrd('toindexoffset',b.indexoffset);path.attrd('from',a.id);path.attrd('to',b.id);if(config.markers)path.attr('marker-end','url(#{0}-arrow)'.format(cls));if(conn){var color=conn.color||'';path.attrd('color',color);path.css({stroke:color})}input.add(output).aclass('connected');if(init){var kp='input'+D+b.id+D+b.index;input.find('.component-io').tclass('disabled',!!self.paused[kp]);kp='output'+D+a.id+D+a.index;output.find('.component-io').tclass('disabled',!!self.paused[kp])}var data=self.get();var ac=data[a.id],bc=data[b.id],key=a.index+'',outputmeta=typeof(ac.outputs[0])==='object'?ac.outputs.findItem('id',a.index):null;if(outputmeta){path.aclass('connection-type-'+outputmeta.type);if(config.markers&&outputmeta.type==='transform')path.attr('marker-start','url(#{0}-arrow)'.format(cls))}path.attr('d',self.helpers.connect(a.x,a.y,b.x,b.y,a.indexoffset,b.indexoffset,outputmeta&&outputmeta.type==='transform'));ac.tab&&path.aclass('tab-'+ac.tab);bc.tab&&path.aclass('tab-'+bc.tab);if(ac.connections==null)ac.connections={};if(ac.connections[key]==null)ac.connections[key]=[];if(!init){self.op.modify(ac,'connect');self.op.modify(bc,'connect')}var arr=ac.connections[key],bindex=b.index+'',is=true;for(var i=0;i<arr.length;i++){var tmp=arr[i];if(tmp.id===b.id&&tmp.index===bindex){is=false;break}}if(is)ac.connections[key].push({id:b.id+'',index:bindex});output.closest('.component').aclass('connected');var meta={};meta.output=ac;meta.input=data[b.id];meta.fromid=a.id;meta.toid=b.id;meta.fromindex=a.index;meta.toindex=b.index;meta.path=path;meta.init=init;ac.onconnect&&ac.onconnect.call(ac,meta);bc.onconnect&&bc.onconnect.call(bc,meta);config.onconnect&&self.EXEC(config.onconnect,meta);if(!init){self.op.undo({type:'connect',fromid:meta.fromid,toid:meta.toid,fromindex:meta.fromindex+'',toindex:meta.toindex+''});self.op.modified()}return true};self.event('contextmenu','.connection',function(e){events.is&&events.up();var el=$(this);var meta={},classes=el.attr('class').split(' ');for(var i=0;i<classes.length;i++){var cls=classes[i];if(cls.substring(0,6)==='conn__'){var arr=cls.split('__');meta.fromid=arr[1];meta.toid=arr[2];meta.fromindex=arr[3];meta.toindex=arr[4];meta.from=self.cache[meta.fromid].instance;meta.to=self.cache[meta.toid].instance;break}}meta.fromid&&config.contextmenu&&self.SEEX(config.contextmenu,e,'connection',meta);e.preventDefault();e.stopPropagation()});self.event('mousedown touchstart','.connection',function(e){var el=$(this);var cls='connection-selected';self.op.unselect();if(el.hclass(cls))return;prevselected&&prevselected.rclass(cls);el.aclass(cls);prevselected=el;var conn=self.helpers.parseconnection(el);conn.isconnection=true;conn.frominstance=self.cache[conn.fromid].instance;conn.toinstance=self.cache[conn.toid].instance;self.info.selected=conn;self.info.type='connection';self.op.refreshinfo();var dom=el[0],parent=el.parent()[0];parent.removeChild(dom);parent.appendChild(dom);e.preventDefault()})});EXTENSION('flow:commands',function(self,config,cls){var zoom=1,animationcount=0,disconnect=function(){var arr=self.el.lines.find('.connection-selected');for(var i=0;i<arr.length;i++){var obj=self.helpers.parseconnection($(arr[i]));obj&&self.op.disconnect(obj.fromid,obj.toid,obj.fromindex,obj.toindex)}};var remove=function(){var arr=self.find('.component-selected,.group-selected');for(var i=0;i<arr.length;i++)self.op.remove($(arr[i]).attrd('id'))};self.command('flow.check',function(){for(var key in self.cache){var instance=self.cache[key],width=instance.el.width();if(instance.width!==width){instance.width=width;if(self.preventreposition){if(self.preventreposition===1)self.preventreposition=2}else self.op.reposition();break}}});self.command('flow.refresh',function(){if(self.preventreposition){if(self.preventreposition<3)self.preventreposition=3}else{self.op.reposition();self.refresh_groups()}});var flow_find_groups=function(id){var item=self.groups.findItem('id',id);if(item){var pos=self.el.groups.find('> div[data-id="{0}"]'.format(id)).offset();var scroll=self.closest('.ui-scrollbar-area');if(scroll){var offset=self.element.offset();scroll.animate({scrollLeft:pos.left-200-offset.left,scrollTop:pos.top-150-offset.top},300);self.op.unselect();self.op.select(id)}}};var flow_find_component=function(id){var com=self.cache[id];if(com){var pos=com.el.offset();var scroll=self.closest('.ui-scrollbar-area');if(scroll){var offset=self.element.offset();scroll.animate({scrollLeft:pos.left-200-offset.left,scrollTop:pos.top-150-offset.top},300);self.op.unselect();self.op.select(id)}}};self.command('flow.groups.find',flow_find_groups);self.command('flow.components.find',flow_find_component);self.command('flow.find',function(id){if(self.groups.findItem('id',id))flow_find_groups(id);else flow_find_component(id)});self.command('flow.selected.disconnect',function(){disconnect();self.op.unselect()});self.command('flow.selected.remove',function(){remove();self.op.unselect()});function translate_path(count,path,reverse){if(reverse)count=100-count;var l=path.getTotalLength();var t=(l/100)*count;var p=path.getPointAtLength(t);return'translate('+(p.x>>0)+','+(p.y>>0)+')'}self.command('flow.traffic',function(id,opt){var color='',index=id.lastIndexOf('#');if(index!==-1){color=id.substring(index);id=id.substring(0,index)}if(!opt)opt={speed:3,count:1,delay:50};if(!opt.limit)opt.limit=20;if(id.charAt(0)==='_'){opt.reverse=true;id=id.substring(1)}var path=self.el.lines.find('.from__'+id);var dark=document.body.classList.contains('ui-dark');if(opt.count>opt.limit)opt.count=opt.limit;if(!path.length||(self.animations[id]>opt.limit)||document.hidden)return;var add=function(next){for(var i=0;i<path.length;i++){if((config.animationlimit&&animationcount>=config.animationlimit))break;var line=path[i],linecolor=line.getAttribute('data-color')||'';if(linecolor&&color&&linecolor!==color)continue;if(line.$flowanimcount>config.animationlimitconnection)break;var el=self.el.anim.asvg('circle').aclass('traffic').attr('r',opt.radius||config.animationradius);var dom=el[0];el.attr({stroke:color||(dark?'#FFF':'#000')});animationcount++;if(line.$flowanimcount)line.$flowanimcount++;else line.$flowanimcount=1;dom.$path=line;dom.$count=0;dom.$token=self.animations_token;if(self.animations[id])self.animations[id]++;else self.animations[id]=1;(function(self,el,dom,opt,line2){var fn=function(){dom.$count+=(opt.speed||3);if(document.hidden||!dom.$path||!dom.$path.parentNode||dom.$token!==self.animations_token){el.remove();el=null;if(self.animations[id])self.animations[id]--;if(animationcount>0)animationcount--;if(line2.$flowanimcount>0)line2.$flowanimcount--;return}if(dom.$count>=100){if(animationcount>0)animationcount--;if(self.animations[id]>0)self.animations[id]--;if(line2.$flowanimcount>0)line2.$flowanimcount--;el.remove();el=null;return}else el.attr('transform',translate_path(dom.$count,dom.$path,opt.reverse));requestAnimationFrame(fn)};requestAnimationFrame(fn)})(self,el,dom,opt,line)}next&&setTimeout(next,opt.delay||50)};if(!opt.count||opt.count===1){add();return}var arr=[];for(var i=0;i<opt.count;i++)arr.push(add);arr.wait(function(fn,next){fn(next)})});self.command('flow.selected.clear',function(){self.groupid=GUID(5);disconnect();remove();self.op.unselect();self.groupid=''});self.command('flow.clean',function(){self.op.clean()});self.command('flow.components.add',function(com){if(!com.id)com.id='f'+Date.now().toString(36);var data=self.get();data[com.id]=com;self.op.modify(com,'newbie');self.op.modified();self.refresh(true);self.op.undo({type:'component',id:com.id})});self.command('flow.groups.add',function(item){if(!item.id)item.id='g'+Date.now().toString(36);var data=self.get();if(data.groups)data.groups.push(item);else data.groups=[item];self.op.modified();self.refresh(true);self.op.undo({type:'group',id:item.id})});self.command('flow.zoom',function(type,value){if(typeof(type)==='number'){zoom=type/100}else{switch(type){case'in':if(value)zoom=value/100;else zoom+=0.05;break;case'out':if(value)zoom=value/100;else zoom-=0.05;break;case'reset':zoom=1;break}}if(zoom>=0.3||zoom<=1.7){self.info.zoom=100*zoom;self.op.refreshinfo();self.element.css('transform','scale({0})'.format(zoom))}});self.command('flow.undo',function(){var item,prev,is=false;while(true){prev=self.undo.pop();if(!prev){is&&COMPILE();return}self.op.undo();self.op.redo(prev);if(prev.type==='disconnect'){var output=self.find('.component[data-id="{0}"]'.format(prev.fromid)).find('.output[data-index="{0}"]'.format(prev.fromindex));var input=self.find('.component[data-id="{0}"]'.format(prev.toid)).find('.input[data-index="{0}"]'.format(prev.toindex));self.el.connect(output,input,true)}else if(prev.type==='connect'){self.op.disconnect(prev.fromid,prev.toid,prev.fromindex,prev.toindex,true)}else if(prev.type==='component'||prev.type==='group'){self.op.remove(prev.id,true);is=true}else if(prev.type==='move'){var arr=prev.multiple||[prev];for(var i=0;i<arr.length;i++){var tmp=arr[i];if(tmp.type==='group'){item=(self.get().groups||EMPTYARRAY).findItem('id',tmp.id);if(item){var el=self.find('.'+cls+'-group[data-id="{0}"]'.format(tmp.id)).css({left:tmp.x,top:tmp.y,width:tmp.width,height:tmp.height});item.x=tmp.x;item.y=tmp.y;item.width=tmp.width;item.height=tmp.height;item.onmove&&item.onmove(el,item);config.onmove&&self.EXEC(config.onmove,el,item,'group')}}else{self.find('.component[data-id="{0}"]'.format(tmp.id)).css({left:tmp.x,top:tmp.y});item=self.get()[tmp.id];item.x=tmp.x;item.y=tmp.y;item.onmove&&item.onmove(item.element,item);config.onmove&&self.EXEC(config.onmove,item.element,item,'component')}}self.op.reposition();is=true}else if(prev.type==='remove'){var com=prev.instance;com.id=prev.id;var data=self.get();if(prev.place==='group'){if(!data.groups)data.groups={};data.groups.push(com)}else data[com.id]=com;self.op.modified();self.update('refresh');is=true}if(!prev.groupid||(!self.undo.length||prev.groupid!==self.undo[self.undo.length-1].groupid)){is&&COMPILE();return}}});self.command('flow.redo',function(){var next,item,is=false;while(true){next=self.redo.pop();if(next==null){is&&COMPILE();return}self.op.redo();self.op.undo(next);self.op.refreshinfo();if(next.type==='disconnect'){self.op.disconnect(next.fromid,next.toid,next.fromindex,next.toindex,true)}else if(next.type==='connect'){var output=self.find('.component[data-id="{0}"]'.format(next.fromid)).find('.output[data-index="{0}"]'.format(next.fromindex));var input=self.find('.component[data-id="{0}"]'.format(next.toid)).find('.input[data-index="{0}"]'.format(next.toindex));self.el.connect(output,input,true)}else if(next.type==='component'){var com=next.instance;com.id=next.id;var data=self.get();data[com.id]=com;self.op.modified();self.refresh(true);is=true}else if(next.type==='group'){var com=next.instance;com.id=next.id;var data=self.get().groups;data.push(com);self.op.modified();self.refresh(true);is=true}else if(next.type==='move'){var arr=next.multiple||[next];for(var i=0;i<arr.length;i++){var tmp=arr[i];if(tmp.type==='group'){item=(self.get().groups||EMPTYARRAY).findItem('id',tmp.id);if(item){var el=self.find('.'+cls+'-group[data-id="{0}"]'.format(tmp.id)).css({left:tmp.newx,top:tmp.newy,width:tmp.newwidth,height:tmp.newheight});item.x=tmp.newx;item.y=tmp.newy;item.width=tmp.newwidth;item.height=tmp.newheight;item.onmove&&item.onmove(el,item);config.onmove&&self.EXEC(config.onmove,el,item,'group')}}else{self.find('.component[data-id="{0}"]'.format(tmp.id)).css({left:tmp.newx,top:tmp.newy});item=self.get()[tmp.id];item.x=tmp.newx;item.y=tmp.newy;item.onmove&&item.onmove(item.element,item);config.onmove&&self.EXEC(config.onmove,item.element,item,'component')}}self.op.reposition();is=true}else if(next.type==='remove'){self.op.remove(next.id,true);is=true}if(!next.groupid||(!self.redo.length||next.groupid!==self.redo[self.redo.length-1].groupid)){is&&COMPILE();return}}});self.command('flow.reset',function(){self.refresh();self.info.selected=null;self.info.type='';self.op.refreshinfo();self.undo=[];self.redo=[];self.op.undo();self.op.redo()})});EXTENSION('flow:groups',function(self,config,cls){var events={},drag={};events.bind=function(){if(!events.is){self.op.isoutcache();events.is=true;self.element.on('mousemove touchmove',events.move).on('mouseup touchend',events.up);self.element.on('mouseleave',events.leave)}};events.unbind=function(){if(events.is){events.is=false;self.element.off('mousemove touchmove',events.move).off('mouseup touchend',events.up);self.element.off('mouseleave',events.leave)}};events.leave=function(e){events.up(e)};events.move=function(e){var evt=e.type==='touchmove'?e.touches[0]:e,x=(evt.pageX+drag.plusX)-drag.pageX;var y=(evt.pageY+drag.plusY)-drag.pageY;if(drag.type==='move'){if(self.op.isout(evt)){events.up(evt);return}drag.element.css({left:self.op.zoom(drag.pos.left+x),top:self.op.zoom(drag.pos.top+y)});if(drag.selected.length){for(var i=0;i<drag.selected.length;i++){var instance=drag.selected[i];instance.node.css({left:self.op.zoom(instance.pos.left+x),top:self.op.zoom(instance.pos.top+y)})}self.components_reposition(drag)}}else if(drag.type==='resize'){var obj={},w,h;switch(drag.dir){case'tl':w=drag.width-self.op.zoom(x);h=drag.height-self.op.zoom(y);if(w<drag.min||h<drag.min)break;obj.left=self.op.zoom(drag.pos.left+x);obj.top=self.op.zoom(drag.pos.top+y);obj.width=w;obj.height=h;drag.element.css(obj);break;case'tr':w=drag.width+self.op.zoom(x);h=drag.height-self.op.zoom(y);if(w<drag.min||h<drag.min)break;obj.top=self.op.zoom(drag.pos.top+y);obj.width=w;obj.height=h;drag.element.css(obj);break;case'bl':w=drag.width+self.op.zoom(x);h=drag.height+self.op.zoom(y);if(w<drag.min||h<drag.min)break;obj.left=self.op.zoom(drag.pos.left+x);obj.width=drag.width-self.op.zoom(x);obj.height=h;drag.element.css(obj);break;case'br':w=drag.width+self.op.zoom(x);h=drag.height+self.op.zoom(y);if(w<drag.min||h<drag.min)break;obj.width=w;obj.height=h;drag.element.css(obj);break}}if(!drag.is)drag.is=true};events.up=function(e){var evt=e.type==='touchend'?e.touches[0]:e;if(drag.is){var id=drag.element.attrd('id');var group=self.groups.findItem('id',id);var pos=drag.element.position();var w=drag.element.width();var h=drag.element.height();var history={id:id,x:group.x,y:group.y,newx:pos.left,newy:pos.top,width:group.width,height:group.height,newwidth:w,newheight:h,type:'group'};if(drag.selected.length){self.components_moved(evt,drag,true);self.undo.last().multiple.push(history)}else self.op.undo({type:'move',multiple:[history]});group.x=self.op.zoom(pos.left);group.y=self.op.zoom(pos.top);group.width=w;group.height=h;group.onmove&&group.onmove(drag.element,group);config.onmove&&self.EXEC(config.onmove,drag.element,group,'group')}events.unbind();var tmp=self.preventreposition;delete self.preventreposition;switch(tmp){case 2:case 3:self.op.reposition();break}};self.event('dblclick','.'+cls+'-group',function(e){var item=(self.get().groups||EMPTYARRAY).findItem('id',$(this).attrd('id'));item&&config.dblclickgroup&&self.SEEX(config.dblclickgroup,item,e)});self.event('mousedown touchstart','.'+cls+'-group',function(e){var evt=e.type==='touchstart'?e.touches[0]:e;self.preventreposition=true;self.op.unselect();e.preventDefault();var parent=self.op.position();var plusX=(parent.scrollLeft||0)+parent.left;var plusY=(parent.scrollTop||0)+parent.top;events.bind();drag.element=$(this);drag.id=drag.element.attrd('id');drag.element.aclass('group-selected');self.info.selected=(self.get().groups||EMPTYARRAY).findItem('id',drag.id);self.info.type='group';self.op.refreshinfo();drag.css={};drag.is=false;drag.plusX=plusX;drag.plusY=plusY;drag.pageX=evt.pageX+plusX;drag.pageY=evt.pageY+plusY;drag.type='';drag.offset=self.getOffset();drag.zoom=self.info.zoom/100;drag.zoomoffset=((100-self.info.zoom)/10)+(self.info.zoom>100?1:-1);drag.min=100;drag.pos=drag.element.position();drag.ismeta=(evt.metaKey||evt.ctrlKey||evt.shiftKey);drag.selected=[];var rect1={x:self.op.zoom(drag.pos.left),y:self.op.zoom(drag.pos.top),width:drag.element.width(),height:drag.element.height()};if(evt.target.tagName==='SPAN'){if(self.info.selected.actions&&self.info.selected.actions.resize===false)return;drag.type='resize';drag.width=rect1.width;drag.height=rect1.height;drag.dir=evt.target.getAttribute('class').replace(cls+'-resize-','');return}if(self.info.selected.actions&&self.info.selected.actions.move===false)return;drag.type='move';if(!drag.ismeta){for(var key in self.cache){var item=self.cache[key],w=item.el.width();var h=item.el.height();var node=item.el,pos=node.position();var rect2={x:self.op.zoom(pos.left),y:self.op.zoom(pos.top),width:w,height:h};if(rect1.x<rect2.x+rect2.width&&rect1.x+rect1.width>rect2.x&&rect1.y<rect2.y+rect2.height&&rect1.y+rect1.height>rect2.y){if(!item.actions||item.actions.move!==false)drag.selected.push({id:node.attrd('id'),node:node,pos:pos,output:node.find('.output'),input:node.find('.input')})}}}});self.refresh_groups=function(){self.groups=self.get().groups||EMPTYARRAY;var groups=self.el.groups.find('> div');var db={};for(var i=0;i<groups.length;i++){var tmp=$(groups[i]);db[tmp.attrd('id')]=tmp}for(var i=0;i<self.groups.length;i++){var g=self.groups[i],css=[];if(!g.id)g.id='g'+GUID(10);css.push('left:{0}px'.format(g.x));css.push('top:{0}px'.format(g.y));css.push('width:{0}px'.format(g.width));css.push('height:{0}px'.format(g.height));g.background&&css.push('background:{0}'.format(g.background));g.color&&css.push('color:{0}'.format(g.color));g.border&&css.push('border-color:{0}'.format(g.border));if(db[g.id]){db[g.id].attr('style',css.join(';')).find('label').text(g.name);delete db[g.id]}else self.el.groups.append('<div class="{0}-group{4}" style="{1}" data-id="{3}"><div><span class="{0}-resize-tl"></span><span class="{0}-resize-tr"></span><span class="{0}-resize-bl"></span><span class="{0}-resize-br"></span><label>{2}</label></div></div>'.format(cls,css.join(';'),g.name.encode(),g.id,g.tab?(' tab-'+g.tab):''))}for(var key in db)db[key].remove()}});

COMPONENT('form','zindex:12;scrollbar:1',function(self,config,cls){var cls2='.'+cls,container,csspos={};if(!W.$$form){W.$$form_level=W.$$form_level||1;W.$$form=true;$(document).on('click',cls2+'-button-close',function(){SET($(this).attrd('path'),'')});var resize=function(){setTimeout2('form',function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='form'&&!HIDDEN(com.dom)&&com.$ready&&!com.$removed)com.resize()}},200)};ON('resize2',resize);$(document).on('click',cls2+'-container',function(e){var el=$(e.target);if(e.target===this||el.hclass(cls+'-container-padding')){var com=$(this).component();if(com&&com.config.closeoutside){com.set('');return}}if(!(el.hclass(cls+'-container-padding')||el.hclass(cls+'-container')))return;var form=$(this).find(cls2);var c=cls+'-animate-click';form.aclass(c);setTimeout(function(){form.rclass(c)},300)})}self.readonly();self.submit=function(){if(config.submit)self.EXEC(config.submit,self.hide,self.element);else self.hide()};self.cancel=function(){if(config.cancel)self.EXEC(config.cancel,self.hide);else self.hide()};self.hide=function(){config.close&&self.EXEC(config.close);if(config.independent)self.hideforce();self.set('')};self.resize=function(){if(self.scrollbar){container.css('height',WH);self.scrollbar.resize()}if(!config.center||self.hclass('hidden'))return;var ui=self.find(cls2);var fh=ui.innerHeight();var wh=WH,r=(wh/2)-(fh/2);csspos.marginTop=(r>30?(r-15):20)+'px';ui.css(csspos)};self.make=function(){$(document.body).append('<div id="{0}" class="hidden {4}-container invisible"><div class="{4}-scrollbar"><div class="{4}-container-padding"><div class="{4}" style="max-width:{1}px"><div class="{4}-title"><button name="cancel" class="{4}-button-close{3}" data-path="{2}"><i class="ti ti-times"></i></button><i class="{4}-icon hidden"></i><span></span></div></div></div></div>'.format(self.ID,config.width||800,self.path,config.closebutton==false?' hidden':'',cls));var scr=self.find('> script');self.template=scr.length?scr.html().trim():'';if(scr.length)scr.remove();var el=$('#'+self.ID);var body=el.find(cls2)[0];container=el.find(cls2+'-scrollbar');if(config.scrollbar){el.css('overflow','hidden');self.scrollbar=SCROLLBAR(el.find(cls2+'-scrollbar'),{visibleY:1,orientation:'y'})}while(self.dom.children.length)body.appendChild(self.dom.children[0]);self.rclass('hidden invisible');var csscls=self.attr('class');csscls&&el.aclass(csscls);self.replace(el,true);self.event('scroll',function(){EMIT('scroll',self.name);EMIT('reflow',self.name)});self.event('click','button[name]',function(){var t=this;switch(t.name){case'submit':self.submit(self.hide);break;case'cancel':!t.disabled&&self[t.name](self.hide);break}});config.enter&&self.event('keydown','input',function(e){e.which===13&&!self.find('button[name="submit"]')[0].disabled&&setTimeout2(self.ID+'enter',self.submit,500)})};self.configure=function(key,value,init,prev){switch(key){case'title':self.find(cls2+'-title > span').text(value);break;case'icon':var icon=self.find(cls2+'-icon');icon.rclass2('fa ti');if(value)icon.aclass(self.faicon(value)).rclass('hidden');else icon.aclass('hidden');break;case'width':!init&&value!==prev&&self.find(cls2).css('max-width',value+'px');break;case'closebutton':!init&&self.find(cls2+'-button-close').tclass('hidden',value!==true);break}};self.esc=function(bind){if(bind){if(!self.$esc){self.$esc=true;$(W).on('keydown',self.esc_keydown)}}else{if(self.$esc){self.$esc=false;$(W).off('keydown',self.esc_keydown)}}};self.esc_keydown=function(e){if(e.which===27&&!e.isPropagationStopped()){var val=self.get();if(!val||config.if===val){e.preventDefault();e.stopPropagation();self.hide()}}};self.hideforce=function(){if(!self.hclass('hidden')){self.aclass('hidden');self.release(true);self.esc(false);self.find(cls2).rclass(cls+'-animate');W.$$form_level--}};var allowscrollbars=function(){$('html').tclass(cls+'-noscroll',!!$(cls2+'-container').not('.hidden').length)};self.setter=function(value){setTimeout2(self.name+'-noscroll',allowscrollbars,50);var isHidden=value!==config.if;if(self.hclass('hidden')===isHidden){if(!isHidden){config.reload&&self.EXEC(config.reload,self);config.default&&DEFAULT(self.makepath(config.default),true)}return}setTimeout2(cls,function(){EMIT('reflow',self.name)},10);if(isHidden){if(!config.independent)self.hideforce();return}if(self.template){var is=self.template.COMPILABLE();self.find(cls2).append(self.template);self.template=null;is&&COMPILE()}if(W.$$form_level<1)W.$$form_level=1;W.$$form_level++;self.css('z-index',W.$$form_level*config.zindex);self.aclass('invisible');self.rclass('hidden');self.resize();self.release(false);if(self.scrollbar)self.scrollbar.scrollTop(0);else self.element.scrollTop(0);config.reload&&self.EXEC(config.reload,self);config.default&&DEFAULT(self.makepath(config.default),true);setTimeout(function(){self.rclass('invisible');if(self.scrollbar)self.scrollbar.scrollTop(0);else self.element.scrollTop(0);self.find(cls2).aclass(cls+'-animate');config.autofocus&&self.autofocus(config.autofocus)},200);setTimeout2(self.ID,function(){self.css('z-index',(W.$$form_level*config.zindex)+1)},500);config.closeesc&&self.esc(true)}});

COMPONENT('icons','search:Search;scrollbarshadow:0',function(self,config,cls){var cls2='.'+cls,template='<span data-search="{0}"><i class="{1}"></i></span>',events={},container,is=false,cachekey;self.singleton();self.readonly();self.blind();self.nocompile();self.redraw=function(){self.html('<div class="{0}"><div class="{0}-header"><div class="{0}-search"><span><i class="ti ti-search clearsearch"></i></span><div><input type="text" placeholder="{1}" class="{0}-search-input"></div></div></div><div class="{0}-scrollbar"><div class="{0}-content"></div></div></div>'.format(cls,config.search));container=self.find(cls2+'-content');self.scrollbar=SCROLLBAR(self.find(cls2+'-scrollbar'),{visibleY:1,shadow:config.scrollbarshadow})};self.rendericons=function(empty){var key=empty?'1':'0';if(cachekey===key)return;cachekey=key;var builder=[];empty&&builder.push(template.format('',''));AJAX('GET '+(config.list||'https://cdn.componentator.com/icons-db.html'),function(response){response=response.split(',');for(var icon of response)builder.push(template.format(icon.toSearch(),'ti ti-'+icon));if(config.custom){AJAX('GET '+config.custom,function(response){response=response.split(',');for(var icon of response)builder.push(template.format(icon.toSearch(),'tic ti-'+icon));self.find(cls2+'-content').html(builder.join(''))})}else self.find(cls2+'-content').html(builder.join(''))})};self.search=function(value){var search=self.find('.clearsearch');search.rclass2('ti-');if(!value.length){search.aclass('ti-search');container.find('.hidden').rclass('hidden');return}value=value.toSearch();search.aclass('ti-times');self.scrollbar.scrollTop(0);var icons=container.find('span');for(var i=0;i<icons.length;i++){var el=$(icons[i]);el.tclass('hidden',el.attrd('search').indexOf(value)===-1)}};self.make=function(){self.aclass(cls+'-container hidden');self.event('keydown','input',function(){var t=this;setTimeout2(self.ID,function(){self.search(t.value)},300)});self.event('click','.ti-times',function(){self.find('input').val('');self.search('')});self.event('click',cls2+'-content span',function(){self.opt.scope&&M.scope(self.opt.scope);self.opt.callback&&self.opt.callback($(this).find('i').attr('class'));self.hide()});events.click=function(e){var el=e.target,parent=self.dom;do{if(el==parent)return;el=el.parentNode}while(el);self.hide()};self.on('reflow + resize + resize2',self.hide);self.on('scroll',function(e){if(e&&e[0]!==self.scrollbar.area[0])self.hide()});self.redraw()};self.bindevents=function(){if(!events.is){events.is=true;$(document).on('click',events.click)}};self.unbindevents=function(){if(events.is){events.is=false;$(document).off('click',events.click)}};self.show=function(opt){var tmp=opt.element?opt.element instanceof jQuery?opt.element[0]:opt.element.element?opt.element.dom:opt.element:null;if(is&&tmp&&self.target===tmp){self.hide();return}var search=self.find(cls2+'-search-input');search.val('');self.find('.clearsearch').rclass2('ti-').aclass('ti-search');if(M.scope)opt.scope=M.scope();self.target=tmp;self.opt=opt;var css={};if(is){css.left=0;css.top=0;self.css(css)}else self.rclass('hidden');var target=$(opt.element);var w=self.element.width();var offset=target.offset();if(opt.element){switch(opt.align){case'center':css.left=Math.ceil((offset.left-w/2)+(target.innerWidth()/2));break;case'right':css.left=(offset.left-w)+target.innerWidth();break;default:css.left=offset.left;break}css.top=opt.position==='bottom'?(offset.top-self.element.height()-10):(offset.top+target.innerHeight()+10)}else{css.left=opt.x;css.top=opt.y}if(opt.offsetX)css.left+=opt.offsetX;if(opt.offsetY)css.top+=opt.offsetY;is=true;self.rendericons(opt.empty);self.css(css);if(opt.scrolltop==null||opt.scrolltop)self.scrollbar.scrollTop(0);search.focus();setTimeout(self.bindevents,50);clearTimeout2(self.ID)};self.clear=function(){container.empty();cachekey=null};self.hide=function(){is=false;self.target=null;self.opt=null;self.unbindevents();self.aclass('hidden');container.find('.hidden').rclass('hidden');setTimeout2(self.ID,self.clear,1000*10)}});

COMPONENT('importer',function(self,config){var init=false,clid=null,pending=false,content='',replace=function(value){return self.scope?self.makepath(value):value.replace(/\?/g,config.path||config.if)};var replace2=function(value){return value?ADAPT(config.path||config.if,config.id,value):value};self.readonly();self.make=function(){var scr=self.find('script');content=scr.length?scr.html():''};self.reload=function(recompile){config.reload&&EXEC(replace(config.reload));recompile&&COMPILE();setTimeout(function(){pending=false;init=true},1000)};self.setter=function(value){if(pending)return;if(config.if!==value){if(config.cleaner&&init&&!clid)clid=setTimeout(self.clean,config.cleaner*60000);return}pending=true;if(clid){clearTimeout(clid);clid=null}if(init){self.reload();return}if(content){self.html(replace2(content));setTimeout(self.reload,50,true)}else self.import(config.url,self.reload,true,replace2)};self.clean=function(){config.clean&&EXEC(replace(config.clean));setTimeout(function(){self.empty();init=false;clid=null},1000)}});

COMPONENT('inlinedatepicker','today:Set today;firstday:0',function(self,config,cls){var cls2='.'+cls,skip=false,visible=false,current,elyears,elmonths,elbody;self.days=EMPTYARRAY;self.days_short=EMPTYARRAY;self.months=EMPTYARRAY;self.months_short=EMPTYARRAY;self.years_from;self.years_to;self.nocompile();self.validate=function(value){if(!config.required||config.disabled)return true;return value instanceof Date&&!isNaN(value.getTime())};self.configure=function(key,value){switch(key){case'days':if(value instanceof Array)self.days=value;else self.days=value.split(',').trim();self.days_short=[];for(var i=0;i<DAYS.length;i++){DAYS[i]=self.days[i];self.days_short[i]=DAYS[i].substring(0,2).toUpperCase()}break;case'months':if(value instanceof Array)self.months=value;else self.months=value.split(',').trim();self.months_short=[];for(var i=0,length=self.months.length;i<length;i++){var m=self.months[i];MONTHS[i]=m;if(m.length>4)m=m.substring(0,3)+'.';self.months_short.push(m)}break;case'yearfrom':if(value.indexOf('current')!==-1)self.years_from=+(NOW.format('yyyy'));else self.years_from=+(NOW.add(value).format('yyyy'));break;case'yearto':if(value.indexOf('current')!==-1)self.years_to=+(NOW.format('yyyy'));else self.years_to=+(NOW.add(value).format('yyyy'));break}};function getMonthDays(dt){var m=dt.getMonth();var y=dt.getFullYear();if(m===-1){m=11;y--}return(32-new Date(y,m,32).getDate())}self.calculate=function(year,month,selected){var d=new Date(year,month,1,12,0);var output={header:[],days:[],month:month,year:year},firstday=config.firstday,firstcount=0,frm=d.getDay()-firstday;var today=NOW,ty=today.getFullYear();var tm=today.getMonth();var td=today.getDate();var sy=selected?selected.getFullYear():-1;var sm=selected?selected.getMonth():-1;var sd=selected?selected.getDate():-1;var days=getMonthDays(d);if(frm<0)frm=7+frm;while(firstcount++<7){output.header.push({index:firstday,name:self.days_short[firstday]});firstday++;if(firstday>6)firstday=0}var index=0,indexEmpty=0,count=0,prev=getMonthDays(new Date(year,month-1,1,12,0))-frm;var cur;for(var i=0;i<days+frm;i++){var obj={today:false,selected:false,empty:false,future:false,number:0,index:++count};if(i>=frm){obj.number=++index;obj.selected=sy===year&&sm===month&&sd===index;obj.today=ty===year&&tm===month&&td===index;obj.future=ty<year;if(!obj.future&&year===ty){if(tm<month)obj.future=true;else if(tm===month)obj.future=td<index}}else{indexEmpty++;obj.number=prev+indexEmpty;obj.empty=true;cur=d.add('-'+indexEmpty+' days')}if(!obj.empty)cur=d.add(i+' days');obj.month=i>=frm&&obj.number<=days?d.getMonth():cur.getMonth();obj.year=i>=frm&&obj.number<=days?d.getFullYear():cur.getFullYear();obj.date=cur;output.days.push(obj)}indexEmpty=0;for(var i=count;i<42;i++){var cur=d.add(i+' days');var obj={today:false,selected:false,empty:true,future:true,number:++indexEmpty,index:++count};obj.month=cur.getMonth();obj.year=cur.getFullYear();obj.date=cur;output.days.push(obj)}return output};self.setdate=function(dt){var time=self.time.split(':');if(time.length>1){dt.setHours(+(time[0]||'0'));dt.setMinutes(+(time[1]||'0'));dt.setSeconds(+(time[2]||'0'))}self.change(true);self.set(dt)};self.make=function(){self.aclass(cls);var conf={},reconfigure=false;if(!config.days){conf.days=[];for(var i=0;i<DAYS.length;i++)conf.days.push(DAYS[i]);reconfigure=true}if(!config.months){conf.months=MONTHS;reconfigure=true}reconfigure&&self.reconfigure(conf);self.event('click',function(e){e.stopPropagation()})};self.makehtml=function(){var builder=[];builder.push('<div class="{0}-header"><span class="{0}-next"><i class="ti ti-angle-right"></i></span><span class="{0}-prev"><i class="ti ti-angle-left"></i></span><div class="{0}-info"><span class="{0}-month">---</span><span class="{0}-year">---</span></div></div><div class="{0}-years hidden"></div><div class="{0}-months"></div><div class="{0}-body hidden"><div class="{0}-week">'.format(cls));for(var i=0;i<7;i++)builder.push('<div></div>');builder.push('</div><div class="{0}-days">'.format(cls));for(var i=0;i<42;i++)builder.push('<div class="{0}-date"><div></div></div>'.format(cls,i));builder.push('</div></div><div class="{0}-footer"><span class="{0}-now">{2}</span></div>'.format(cls,config.close,config.today));self.html(builder.join(''));builder=[];elbody=self.find(cls2+'-body');elmonths=self.find(cls2+'-months');for(var i=0;i<12;i++)builder.push('<div class="{0}-month" data-index="{1}"><div></div></div>'.format(cls,i));elmonths.html(builder.join(''));builder=[];elyears=self.find(cls2+'-years');for(var i=0;i<25;i++)builder.push('<div class="{0}-year"><div></div></div>'.format(cls));elyears.html(builder.join(''));self.makehtml=null;self.find(cls2+'-month').on('click',function(e){var el=$(this);var index=el.attrd('index');var h='hidden';if(index){current.setMonth(+index);self.date(current,true)}else if(!elmonths.hclass(h))index=1;elyears.aclass(h);if(index)elmonths.aclass(h);else{elmonths.find(cls2+'-today').rclass(cls+'-today');elmonths.find(cls2+'-month').eq(current.getMonth()).aclass(cls+'-today');elmonths.rclass(h)}elbody.tclass(h,!elmonths.hclass(h));e.preventDefault();e.stopPropagation()});self.find(cls2+'-year').on('click',function(e){var el=$(this);var year=el.attrd('year');var h='hidden';if(year){current.setFullYear(+year);self.date(current,true)}else if(!elyears.hclass(h))year=1;elmonths.aclass(h);if(year)elyears.aclass(h);else{self.years();elyears.rclass(h)}elbody.tclass(h,!elyears.hclass(h));e.preventDefault();e.stopPropagation()});self.years=function(){var dom=self.find(cls2+'-years').find(cls2+'-year');var year=current.getFullYear();var index=12;for(var i=0;i<25;i++){var val=year-(index--);$(dom[i]).tclass(cls+'-today',val===year).attrd('year',val).find('div')[0].innerHTML=val}};self.find(cls2+'-date').on('click',function(){var dt=$(this).attrd('date').split('-');self.setdate(new Date(+dt[0],+dt[1],+dt[2],12,0,0))});self.find(cls2+'-now').on('click',function(){self.setdate(new Date())});self.find(cls2+'-next').on('click',function(e){if(elyears.hclass('hidden')){current.setMonth(current.getMonth()+1);self.date(current,true)}else{current.setFullYear(current.getFullYear()+25);self.years()}e.preventDefault();e.stopPropagation()});self.find(cls2+'-prev').on('click',function(e){if(elyears.hclass('hidden')){current.setMonth(current.getMonth()-1);self.date(current,true)}else{current.setFullYear(current.getFullYear()-25);self.years()}e.preventDefault();e.stopPropagation()})};self.date=function(value,skipday){var clssel=cls+'-selected';self.makehtml&&self.makehtml();if(typeof(value)==='string')value=value.parseDate();var year=value==null?null:value.getFullYear();if(year&&(year<self.years_from||year>self.years_to))return;if(!value||isNaN(value.getTime())){self.find('.'+clssel).rclass(clssel);value=NOW}var empty=!value;if(skipday){skipday=false;empty=true}if(skip){skip=false;return}value=new Date((value||NOW).getTime());var output=self.calculate(value.getFullYear(),value.getMonth(),value);var dom=self.find(cls2+'-date');self.find(cls2+'-body').rclass('hidden');self.find(cls2+'-months,'+cls2+'-years').aclass('hidden');current=value;for(var i=0;i<42;i++){var item=output.days[i],classes=[cls+'-date'];if(item.empty)classes.push(cls+'-disabled');if(!empty&&item.selected)classes.push(cls+'-selected');if(item.today)classes.push(cls+'-day-today');var el=$(dom[i]);el.attrd('date',item.year+'-'+item.month+'-'+item.number);el.find('div').html(item.number);el.find('i').remove();el.rclass().aclass(classes.join(' '))}if(!skipday){dom=self.find(cls2+'-week').find('div');for(var i=0;i<7;i++)dom[i].innerHTML=output.header[i].name;dom=self.find(cls2+'-months').find(cls2+'-month');for(var i=0;i<12;i++)$(dom[i]).find('div').attrd('index',i)[0].innerHTML=self.months_short[i]}config.badges&&self.SEEX(config.badges,current,function(date){if(!(date instanceof Array))date=[date];for(var i=0;i<date.length;i++){var dt=date[i].getFullYear()+'-'+date[i].getMonth()+'-'+date[i].getDate();var el=self.find(cls2+'-date[data-date="{0}"]'.format(dt));if(el.length&&!el.find('i').length)el.append('<i class="ti ti-bull"></i>')}});var info=self.find(cls2+'-info');info.find(cls2+'-month').html(self.months[current.getMonth()]);info.find(cls2+'-year').html(current.getFullYear())};self.getter=null;self.setter=function(value){if(!value)value=NOW;self.time=value.format('HH:mm:ss');self.date(value)}});

COMPONENT('input','maxlength:200;innerlabel:0;tabindex:0;dirkey:name;dirvalue:id;increment:1;format:auto;autovalue:name;direxclude:false;checkicon:ti ti-check;forcevalidation:1;searchalign:1;height:80;tabs:1;after:\\:',function(self,config,cls){var cls2='.'+cls,input,placeholder,dirsource,binded,customvalidator,mask,rawvalue,isdirvisible=false,nobindcamouflage=false,focused=false;self.nocompile();self.init=function(){Thelpers.ui_input_icon=function(val){return val.charAt(0)==='!'||val.indexOf(' ')!==-1?('<span class="ui-input-icon-custom">'+(val.charAt(0)==='!'?val.substring(1):('<i class="'+val)+'"></i>')+'</span>'):('<i class="ti ti-'+val+'"></i>')};W.ui_input_template=Tangular.compile(('{{ if label}}<div class="{0}-label">{{ if icon}}<i class="{{ icon}}"></i>{{ fi}}{{ label | raw}}{{ after | raw}}</div>{{ fi}}<div class="{0}-control{{ if licon}} {0}-licon{{ fi}}{{ if ricon || (type === \'number\' && increment) }} {0}-ricon{{ fi}}">{{ if ricon || (type === \'number\' && increment) }}<div class="{0}-icon-right{{ if type === \'number\' && increment && !ricon}} {0}-increment{{ else if riconclick || type === \'date\' || type === \'time\' || (type === \'search\' && searchalign === 1) || type === \'password\' }} {0}-click{{ fi}}">{{ if type === \'number\' && !ricon}}<i class="ti ti-caret-up"></i><i class="ti ti-caret-down"></i>{{ else}}{{ ricon | ui_input_icon}}{{ fi}}</div>{{ fi}}{{ if licon}}<div class="{0}-icon-left{{ if liconclick || (type === \'search\' && searchalign !== 1) }} {0}-click{{ fi}}">{{ licon | ui_input_icon}}</div>{{ fi}}<div class="{0}-input{{ if align === 1 || align === \'center\' }} center{{ else if align === 2 || align === \'right\' }} right{{ fi}}">{{ if placeholder}}<div class="{0}-placeholder">{{ placeholder}}</div>{{ fi}}{{ if dirsource || type === \'icon\' || type === \'emoji\' || type === \'color\' }}<div class="{0}-value" tabindex="{{ tabindex}}"></div>{{ else}}{{ if type === \'multiline\' }}<textarea data-jc-bind="" style="height:{{ height}}px" tabindex="{{ tabindex}}"></textarea>{{ else}}<input type="{{ if type === \'password\' }}password{{ else}}text{{ fi}}" tabindex="{{ tabindex}}" {{ if autofill}} autocomplete="on" name="{{ NAME}}"{{ else}} name="input'+Date.now()+'" autocomplete="new-password"{{ fi}} data-jc-bind=""{{ if maxlength > 0}} maxlength="{{ maxlength}}"{{ fi}}{{ if autofocus}} autofocus{{ fi}} />{{ fi}}{{ fi}}</div></div>{{ if error}}<div class="{0}-error hidden"><i class="ti ti-warning"></i> {{ error}}</div>{{ fi}}').format(cls))};self.make=function(){if(config.innerlabel&&config.after)config.after='';if(!config.label)config.label=self.html();if(isMOBILE&&config.autofocus)config.autofocus=false;if(config.placeholder==0)config.placeholder='0';if(config.autofill){if(typeof(config.autofill)==='string'){config.NAME=config.autofill}else{var index=self.path.lastIndexOf('.');config.NAME=index===-1?self.path:self.path.substring(index+1)}}self.aclass(cls+' invisible');self.rclass('invisible',100);self.redraw();self.event('input change',function(){if(nobindcamouflage)nobindcamouflage=false;else self.check()});self.event('click',cls2+'-checkbox',function(){if(config.disabled){$(this).blur();return}self.change(true);var val=self.get();if(val===1)val=0;else if(val===0)val=1;else if(val===true)val=false;else val=true;self.set(val,2)});self.event('focus','input,textarea,'+cls2+'-value',function(){if(config.disabled){$(this).blur();return}focused=true;self.camouflage(false);self.aclass(cls+'-focused');config.autocomplete&&self.EXEC(config.autocomplete,self,input.parent());if(config.autosource){var opt={};opt.element=self.element;opt.search=GET(self.makepath(config.autosource));opt.callback=function(value){var val=typeof(value)==='string'?value:value[config.autovalue];if(config.autoexec){self.EXEC(config.autoexec,value,function(val){self.set(val,2);self.change();self.bindvalue()})}else{self.set(val,2);self.change();self.bindvalue()}};SETTER('autocomplete','show',opt)}else if(config.mask){setTimeout(function(input){input.selectionStart=input.selectionEnd=0},50,this)}else if(config.dirsource&&(config.autofocus!=false&&config.autofocus!=0)){if(!isdirvisible)self.find(cls2+'-control').trigger('click')}else if(config.type==='date'||config.type==='time'){setTimeout(function(){self.element.find(cls2+'-icon-right').trigger('click')},300)}});self.event('paste','input,textarea',function(e){if(config.mask){var val=(e.originalEvent.clipboardData||window.clipboardData).getData('text');self.set(val.replace(/\s|\t/g,''));e.preventDefault()}self.check()});self.event('keydown','input,textarea',function(e){var t=this,code=e.which;if(t.readOnly||config.readonly||config.disabled){if(e.keyCode!==9){if(config.dirsource){self.find(cls2+'-control').trigger('click');return}e.preventDefault();e.stopPropagation()}return}if(config.tabs&&t.tagName==='TEXTAREA'&&e.keyCode===9){t.setRangeText('\t',t.selectionStart,t.selectionEnd,'end');self.check();e.preventDefault();return}if(!config.disabled&&config.dirsource&&(code===13||code>30)){self.find(cls2+'-control').trigger('click');return}if(config.mask){if(e.metaKey){if(code===8||code===127){e.preventDefault();e.stopPropagation()}return}if(code===32){e.preventDefault();e.stopPropagation();return}var beg=e.target.selectionStart,end=e.target.selectionEnd,val=t.value,c;if(code===8||code===127){if(beg===end){c=config.mask.substring(beg-1,beg);t.value=val.substring(0,beg-1)+c+val.substring(beg);self.curpos(beg-1)}else{for(var i=beg;i<=end;i++){c=config.mask.substring(i-1,i);val=val.substring(0,i-1)+c+val.substring(i)}t.value=val;self.curpos(beg)}e.preventDefault();return}if(code>40){var cur=String.fromCharCode(code);if(mask&&mask[beg]){if(!mask[beg].test(cur)){e.preventDefault();return}}c=config.mask.charCodeAt(beg);if(c!==95){beg++;while(true){c=config.mask.charCodeAt(beg);if(c===95||isNaN(c))break;else beg++}}if(c===95){val=val.substring(0,beg)+cur+val.substring(beg+1);t.value=val;beg++;while(beg<config.mask.length){c=config.mask.charCodeAt(beg);if(c===95)break;else beg++}self.curpos(beg)}else self.curpos(beg+1);e.preventDefault();e.stopPropagation()}}});self.event('blur','input,textarea,'+cls2+'-value',function(){focused=false;self.camouflage(true);self.rclass(cls+'-focused')});self.event('click',cls2+'-control',function(){if(config.disabled||isdirvisible)return;if(config.type==='icon'){opt={};opt.element=self.element;opt.value=self.get();opt.empty=true;opt.callback=function(val){self.change(true);self.set(val,2);self.check();rawvalue[0].focus()};SETTER((self.caniuse('icons')?'icons':'faicons')+'/show',opt);return}else if(config.type==='color'){opt={};opt.element=self.element;opt.value=self.get();opt.empty=true;opt.callback=function(al){self.change(true);self.set(al,2);self.check();rawvalue[0].focus()};SETTER('colorpicker/show',opt);return}else if(config.type==='emoji'){opt={};opt.element=self.element;opt.value=self.get();opt.empty=true;opt.callback=function(al){self.change(true);self.set(al,2);self.check();rawvalue[0].focus()};SETTER('emoji/show',opt);return}if(!config.dirsource)return;isdirvisible=true;setTimeout(function(){isdirvisible=false},500);var opt={};opt.element=self.find(cls2+'-control');opt.items=dirsource||GET(self.makepath(config.dirsource));opt.offsetY=-1+(config.diroffsety||0);opt.offsetX=0+(config.diroffsetx||0);opt.placeholder=config.dirplaceholder;opt.render=config.dirrender?GET(self.makepath(config.dirrender)):null;opt.custom=!!config.dircustom;opt.offsetWidth=2;opt.minwidth=config.dirminwidth||200;opt.maxwidth=config.dirmaxwidth;opt.key=config.dirkey||config.key;opt.empty=config.dirempty;opt.checkbox=!!config.multiple;var val=self.get();if(config.multiple){for(var i=0;i<opt.items.length;i++){var item=opt.items[i];if(val instanceof Array){item.selectedts=val.indexOf(item[config.dirvalue||config.value]);item.selected=item.selectedts!==-1}else item.selected=false}}else opt.selected=val;if(config.dirraw)opt.raw=true;if(config.dirsearch!=null)opt.search=config.dirsearch;if(dirsource&&config.direxclude==false&&!config.multiple){for(var i=0;i<dirsource.length;i++){var item=dirsource[i];if(item)item.selected=typeof(item)==='object'&&item[config.dirvalue]===val}}else if(config.direxclude){opt.exclude=function(item){return item?item[config.dirvalue]===val:false}}opt.callback=function(item,el,custom){if(item==null||(config.multiple&&!item.length)){rawvalue.html('');self.set(config.multiple?[]:null,2);self.change();self.check();return}if(config.multiple){var arr=[];for(var i=0;i<item.length;i++){var m=item[i];arr.push(m[config.dirvalue||config.value])}self.set(arr,2);self.change(true);return}var val=custom||typeof(item)==='string'?item:item[config.dirvalue||config.value];if(custom&&typeof(config.dircustom)==='string'){var fn=GET(self.makepath(config.dircustom));fn(val,function(val){self.set(val,2);self.change(true);self.bindvalue()})}else if(custom){if(val){self.set(val,2);self.change(true);if(dirsource)self.bindvalue();else input.val(val)}}else{self.set(val,2);self.change(true);if(dirsource)self.bindvalue();else input.val(val)}rawvalue[0].focus()};SETTER('directory/show',opt)});self.event('click',cls2+'-placeholder,'+cls2+'-label',function(e){if(!config.disabled){if(config.dirsource){e.preventDefault();e.stopPropagation();self.find(cls2+'-control').trigger('click')}else if(!config.camouflage||$(e.target).hclass(cls+'-placeholder')){if(input.length){input[0].focus()}else rawvalue[0].focus()}}});self.event('click',cls2+'-icon-left,'+cls2+'-icon-right',function(e){if(config.disabled)return;var el=$(this);var left=el.hclass(cls+'-icon-left');var opt;if(config.dirsource&&left&&config.liconclick){e.preventDefault();e.stopPropagation()}if(!left&&!config.riconclick){if(config.type==='date'){opt={};opt.element=self.element;opt.value=self.get();opt.callback=function(val){self.change(true);self.set(val)};SETTER('datepicker/show',opt)}else if(config.type==='time'){opt={};opt.element=self.element;opt.value=self.get();opt.callback=function(val){self.change(true);self.set(val)};SETTER('timepicker/show',opt)}else if(config.type==='search')self.set('');else if(config.type==='password')self.password();else if(config.type==='number'||config.type==='number2'){var tmp=$(e.target);if(tmp.attr('class').indexOf('ti-')!==-1){var n=tmp.hclass('ti-caret-up')?1:-1;self.change(true);var val=self.preparevalue((self.get()||0)+(config.increment*n));self.set(val,2)}}return}if(left&&config.liconclick)self.EXEC(config.liconclick,self,el);else if(config.riconclick)self.EXEC(config.riconclick,self,el);else if(left&&config.type==='search')self.set('')})};self.camouflage=function(is){if(config.camouflage){if(is){var t=input[0],arr=t.value.split('');for(var i=0;i<arr.length;i++)arr[i]=typeof(config.camouflage)==='string'?config.camouflage:'•';nobindcamouflage=true;t.value=arr.join('')}else{nobindcamouflage=true;var val=self.get();input[0].value=val==null?'':val}self.tclass(cls+'-camouflaged',is)}};self.curpos=function(pos){var el=input[0];if(el.createTextRange){var range=el.createTextRange();range.move('character',pos);range.select()}else if(el.selectionStart){el.focus();el.setSelectionRange(pos,pos)}};self.validate=function(value){if((!config.required||config.disabled)&&!self.forcedvalidation())return true;if(config.disabled)return true;if(config.dirsource)return!!value;if(customvalidator)return customvalidator(value);if(config.type==='date')return value instanceof Date&&!isNaN(value.getTime());if(config.type==='checkbox')return value===true||value===1;if(value==null)value='';else value=value.toString();if(config.mask&&typeof(value)==='string'&&value.indexOf('_')!==-1)return false;if(config.minlength&&value.length<config.minlength)return false;switch(config.type){case'email':return value.isEmail();case'phone':return value.isPhone();case'url':return value.isURL();case'zip':return(/^\d{5}(?:[-\s]\d{4})?$/).test(value);case'currency':case'number':case'number2':if(config.type==='number2'&&(value==null||value==''))return false;value=value.parseFloat();if((config.minvalue!=null&&value<config.minvalue)||(config.maxvalue!=null&&value>config.maxvalue))return false;return config.minvalue==null?value>0:true}return value.length>0};self.offset=function(){var offset=self.element.offset();var control=self.find(cls2+'-control');var width=control.width()+2;return{left:offset.left,top:control.offset().top+control.height(),width:width}};self.password=function(show){var visible=show==null?input.attr('type')==='text':show;input.attr('type',visible?'password':'text');self.find(cls2+'-icon-right').find('i').tclass(config.ricon,visible).tclass('ti-eye-slash',!visible).tclass('ti-eye',visible)};self.preparevalue=function(value){if(config.type==='number'&&(config.type!=='number2'||value)&&(config.minvalue!=null||config.maxvalue!=null)){var tmp=typeof(value)==='string'?+value.replace(',','.'):value;if(isNaN(tmp))tmp=0;if(config.minvalue>tmp)value=config.minvalue;if(config.maxvalue<tmp)value=config.maxvalue}return value};self.getterin=self.getter;self.getter=function(value,realtime,nobind){if(nobindcamouflage)return;if(config.mask&&config.masktidy){var val=[];for(var i=0;i<value.length;i++){if(config.mask.charAt(i)==='_')val.push(value.charAt(i))}value=val.join('')}self.getterin(self.preparevalue(value),realtime,nobind)};self.setterin=self.setter;self.setter=function(value,path,type){if(config.mask){if(value){if(config.masktidy){var index=0,val=[];for(var i=0;i<config.mask.length;i++){var c=config.mask.charAt(i);val.push(c==='_'?(value.charAt(index++)||'_'):c)}value=val.join('')}if(mask){var arr=[];for(var i=0;i<mask.length;i++){var c=value.charAt(i);if(mask[i]&&mask[i].test(c))arr.push(c);else arr.push(config.mask.charAt(i))}value=arr.join('')}}else value=config.mask}self.setterin(value,path,type);self.bindvalue();config.camouflage&&!focused&&setTimeout(self.camouflage,type==='show'?2000:1,true);if(config.type==='password')self.password(true)};self.check=function(){var is=false;if(config.dirsource)is=!!rawvalue.text();else is=input&&input.length?!!input[0].value:!!self.get();if(binded===is)return;binded=is;placeholder&&placeholder.tclass('hidden',is);self.tclass(cls+'-binded',is);if(config.type==='search')self.find(cls2+'-icon-'+(config.searchalign===1?'right':'left')).find('i').tclass(config.searchalign===1?config.ricon:config.licon,!is).tclass('ti-times',is)};self.bindvalue=function(){var value=self.get();if(dirsource){var item,text=[];for(var i=0;i<dirsource.length;i++){item=dirsource[i];if(typeof(item)==='string'){if(item===value)break;item=null}else if(config.multiple){var v=item[config.dirvalue||config.value],index=value instanceof Array?value.indexOf(v):-1;if(index!==-1)text.push({index:index,value:item[config.dirkey||config.key]})}else if(item[config.dirvalue||config.value]===value){item=item[config.dirkey||config.key];break}else item=null}if(config.multiple){text.quicksort('index');for(var i=0;i<text.length;i++)text[i]=text[i].value;item=text.join(', ')}else if(value&&item==null&&config.dircustom)item=value;if(config.dirraw)rawvalue.html(item||'');else rawvalue.text(item||'')}else if(config.dirsource){if(config.dirdetail){self.EXEC(config.dirdetail,value,function(val){if(config.dirraw)rawvalue.html(val||'');else rawvalue.text(val||'');self.check()});return}else if(config.dirraw)rawvalue.html(value||'');else rawvalue.text(value||'')}else{switch(config.type){case'color':rawvalue.css('background-color',value||'');break;case'icon':rawvalue.html('<i class="{0}"></i>'.format(value||''));break;case'emoji':rawvalue.html(value);break;case'checkbox':self.tclass(cls+'-checked',value===true||value===1);break}}self.check()};self.redraw=function(){if(!config.ricon){if(config.dirsource)config.ricon='angle-down';else if(config.type==='date'){config.ricon='calendar';if(!config.align&&!config.innerlabel)config.align=1}else if(config.type==='icon'||config.type==='color'||config.type==='emoji'){config.ricon='angle-down';if(!config.align&&!config.innerlabel)config.align=1}else if(config.type==='time'){config.ricon='clock';if(!config.align&&!config.innerlabel)config.align=1}else if(config.type==='search')if(config.searchalign===1)config.ricon='search';else config.licon='search';else if(config.type==='password')config.ricon='eye';else if(config.type==='number'||config.type==='number2'){if(!config.align&&!config.innerlabel)config.align=1}}self.tclass(cls+'-masked',!!config.mask);self.rclass2(cls+'-type-');if(config.type)self.aclass(cls+'-type-'+config.type);var html,is=false;if(config.type==='checkbox'){html='<div class="{0}-checkbox"><span><i class="{checkicon}"></i></span><label>{label}</label></div>'.format(cls).arg(config)}else{is=true;var opt=CLONE(config);if(opt.type==='number2')opt.type='number';html=W.ui_input_template(opt)}self.html(html);if(is){input=self.find('input,textarea');rawvalue=self.find(cls2+'-value');placeholder=self.find(cls2+'-placeholder')}else input=rawvalue=placeholder=null};self.configure=function(key,value){switch(key){case'icon':if(value&&value.indexOf(' ')===-1)config.icon='ti ti-'+value;break;case'dirsource':if(config.dirajax||value.indexOf('/')!==-1){dirsource=null;self.bindvalue()}else{if(value.indexOf(',')!==-1){dirsource=self.parsesource(value);self.bindvalue()}else{self.datasource(value,function(path,value){dirsource=value;self.bindvalue()})}}self.tclass(cls+'-dropdown',!!value);input.prop('readonly',!!config.disabled||!!config.dirsource);break;case'disabled':self.tclass('ui-disabled',!!value);input&&input.prop('readonly',!!value||!!config.dirsource);self.reset();break;case'required':self.tclass(cls+'-required',!!value);self.reset();break;case'type':self.type=value;break;case'validate':customvalidator=value?(/\(|=|>|<|\+|-|\)/).test(value)?FN('value=>'+value):(function(path){path=self.makepath(path);return function(value){return GET(path)(value)}})(value):null;break;case'innerlabel':self.tclass(cls+'-inner',!!value);self.tclass(cls+'-raw',!value);break;case'monospace':self.tclass(cls+'-monospace',!!value);break;case'maskregexp':if(value){mask=value.toLowerCase().split(',');for(var i=0;i<mask.length;i++){var m=mask[i];if(!m||m==='null')mask[i]='';else mask[i]=new RegExp(m)}}else mask=null;break;case'mask':config.mask=value.replace(/#/g,'_');break}};self.formatter(function(path,value){if(value){switch(config.type){case'lower':return(value+'').toLowerCase();case'upper':return(value+'').toUpperCase();case'phone':return(value+'').replace(/\s/g,'');case'email':return(value+'').toLowerCase();case'date':var format=config.format;if(format==='auto')format='';return value.format(format||DEF.dateformat||'yyyy-MM-dd');case'time':var format=config.format;if(format==='auto')format='';return value.format(format||'HH:mm');case'number':return config.format?(config.format==='auto'?value.format():value.format(config.format)):value;case'number2':return value==null?'':config.format?(config.format==='auto'?value.format():value.format(config.format)):value}}return value});self.parser(function(path,value){if(value){var tmp;switch(config.type){case'date':tmp=self.get();if(tmp)tmp=tmp.format('HH:mm');else tmp='';return value+(tmp?(' '+tmp):'');case'lower':case'email':value=value.toLowerCase();break;case'upper':value=value.toUpperCase();break;case'phone':value=value.replace(/\s/g,'');break;case'number2':if(value){var type=typeof(value);if(type==='string'&&(/^[\-0-9\.\,]+$/).test(value))value=value.parseFloat();else if(type!=='number')value=null}else value=null;break;case'time':tmp=value.split(':');var dt=self.get();value=dt?new Date(dt.getTime()):new Date();value.setHours((tmp[0]||'0').parseInt());value.setMinutes((tmp[1]||'0').parseInt());value.setSeconds((tmp[2]||'0').parseInt());break;case'slug':value=value.slug();break}}else{switch(config.type){case'number':value=0;break;case'number2':case'date':value=null;break}}return value?config.spaces===false?value.replace(/\s/g,''):value:value});self.state=function(type,what){if(type){if(type===1&&what===4){self.rclass(cls+'-ok '+cls+'-invalid');self.$oldstate=null;return}var invalid=config.required?self.isInvalid():self.forcedvalidation()?self.isInvalid():false;if(invalid!==self.$oldstate){self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid);self.tclass(cls+'-ok',!invalid);config.error&&self.find(cls2+'-error').tclass('hidden',!invalid)}}};self.forcedvalidation=function(){if(!config.forcevalidation)return false;if(config.type==='number'||config.type==='number2')return false;var val=self.get();var type=typeof(val);if(config.type==='checkbox')return val===true||val===1;if(type==='string'&&val&&(config.minlength!=null||config.maxlength!=null)){if((config.minlength!=null&&val.length<config.minlength)||(config.maxlength!=null&&val.length>config.maxlength))return true;if(!config.type||(config.type==='string'||config.type==='multiline'))return false}return(config.type==='phone'||config.type==='email')&&(val!=null&&(type==='string'&&val.length!==0))}});

COMPONENT('intro','closebutton:0;width:400;height:300;nexticon:ti ti-chevron-right;doneicon:ti ti-check-circle;delay:500',function(self,config,cls){var cls2='.'+cls,container='intro'+GUID(4);var content,figures,buttons,button=null,index=0,visible=false,body;self.readonly();self.hide=function(){if(visible){self.set('');config.exec&&self.EXEC(config.exec,true);config.remove&&self.remove()}};self.make=function(){$(document.body).append('<div id="{0}" class="hidden {1}"><div class="{1}-body" style="max-width:{2}px;height:{3}px;top:{4}px"></div></div>'.format(container,cls,config.width,config.height,(WH/2>>0)-config.height/2>>0));content=self.element;container=$('#'+container);content.rclass('hidden');body=container.find(cls2+'-body');body[0].appendChild(self.element[0]);self.replace(container);content.aclass(cls+'-figures');figures=content.find('figure');var items=[];figures.each(function(index){items.push('<i class="ti ti-circle-alt {0}-button" data-index="{1}"></i>'.format(cls,index))});if(config.closebutton){body.prepend('<span><i class="ti ti-times"></i></span>');body.find('span').on('click',self.hide)}body.append('<div class="{0}-pagination"><button name="next"></button>{1}</div>'.format(cls,items.join('')));buttons=self.find(cls2+'-button');button=self.find(cls2+'-pagination').find('button');self.event('click','button[name="next"],.next',function(){if(config.delay&&BLOCKED(self.ID,config.delay))return;index++;if(index>=figures.length){var done=function(){self.set('');config.exec&&self.EXEC(config.exec);config.remove&&self.remove()};if(config.check){self.EXEC(config.check,done)}else done()}else{self.move(index);config.page&&self.EXEC(config.page,index)}});self.event('click','button[name="close"],.close',self.hide);self.event('click',cls2+'-button',function(){self.move(+$(this).attrd('index'))});self.on('resize2',self.resize);self.resize()};self.resize=function(){setTimeout2(self.ID,self.resizeforce,300)};self.resizeforce=function(){if(!visible)return;var css={},footer=self.find(cls2+'-pagination').innerHeight();css.top=(WH/2>>0)-(config.height+footer)/2>>0;if(WIDTH()==='xs'){css['max-width']='auto';css.width='86%'}else css.width='';css.height=config.height+footer;body.css(css);figures.css('height',config.height)};self.move=function(indexer){figures.filter('.visible').rclass('visible');buttons.filter('.selected').rclass('selected');figures.eq(indexer).aclass('visible');buttons.eq(indexer).aclass('selected');var isnext=indexer<buttons.length-1;button.html(isnext?((config.next||'Next')+'<i class="{0}"></i>'.format(config.nexticon)):('<i class="{0}"></i>'.format(config.doneicon)+(config.close||'Done')));button.tclass('next',isnext);button.tclass('done',!isnext);index=indexer;return self};self.setter=function(value){var is=value==config.if;if(is===visible)return;index=0;self.move(0);visible=is;self.tclass('hidden',!is);self.resizeforce();setTimeout(function(){self.find(cls2+'-body').tclass(cls+'-body-visible',is)},200)}});

COMPONENT('keyvalue','maxlength:100',function(self,config,cls){var cls2='.'+cls,container,content=null,cempty='empty',skip=false,empty={};self.nocompile&&self.nocompile();self.template=Tangular.compile('<div class="{0}-item"><div class="{0}-item-remove"><i class="ti ti-times"></i></div><div class="{0}-item-key"><input type="text" name="key" maxlength="{{ max}}"{{ if disabled}} disabled="disabled"{{ fi}} placeholder="{{ placeholder_key}}" value="{{ key}}" autocomplete="new-password" /></div><div class="{0}-item-value"><input type="text" maxlength="{{ max}}" placeholder="{{ placeholder_value}}" value="{{ value}}" autocomplete="new-password" /></div></div>'.format(cls));self.binder=function(fn){self.binder2=fn};self.binder2=function(type,value){return value};self.configure=function(key,value,init,prev){if(init)return;var redraw=false;switch(key){case'disabled':self.tclass('ui-disabled',value);self.find('input').prop('disabled',value);empty.disabled=value;break;case'maxlength':self.find('input').prop('maxlength',value);break;case'placeholderkey':self.find('input[name="key"]').prop('placeholder',value);break;case'placeholdervalue':self.find('input[name="value"]').prop('placeholder',value);break;case'icon':if(value&&prev)self.find('i').rclass2('ti').aclass(value.indexOf(' ')===-1?('ti ti-'+value):value);else redraw=true;break;case'label':redraw=true;break}if(redraw){self.redraw();self.refresh()}};self.redraw=function(){var icon=config.icon,label=config.label||content;if(icon)icon='<i class="{0}"></i>'.format(self.faicon(icon));empty.value='';self.html((label?'<div class="'+cls+'-label">{1}{0}:</div>'.format(label,icon):'')+'<div class="'+cls+'-items"></div>'+self.template(empty).replace('-item"','-item '+cls+'-base"'));container=self.find(cls2+'-items')};self.make=function(){empty.max=config.maxlength;empty.placeholder_key=config.placeholderkey;empty.placeholder_value=config.placeholdervalue;empty.value='';empty.disabled=config.disabled;content=self.html();self.aclass(cls);self.disabled&&self.aclass('ui-disabled');self.redraw();self.event('click','.ti-times',function(){if(config.disabled)return;var el=$(this);var parent=el.closest(cls2+'-item');var inputs=parent.find('input');var obj=self.get();!obj&&(obj={});var key=inputs[0].value;parent.remove();delete obj[key];SET(self.path,obj,2);self.change(true)});self.event('focus','input',function(){config.autocomplete&&self.EXEC(config.autocomplete,$(this),self)});self.event('change keydown','input',function(e){if(config.disabled||(e.type==='keydown'&&e.which!==13))return;var el=$(this);var inputs=el.closest(cls2+'-item').find('input');var key=self.binder2('key',inputs[0].value);var value=self.binder2('value',inputs.get(1).value);if(!key||!value)return;var base=el.closest(cls2+'-base').length>0;if(base){var tmp=self.get();!tmp&&(tmp={});tmp[key]=value;self.set(tmp);self.change(true);inputs.val('');inputs.eq(0).focus();return}var keyvalue={},k,arr=container.find('input');for(var m of arr){if(m.name==='key'){k=m.value.trim()}else if(k){keyvalue[k]=m.value.trim();k=''}}skip=true;SET(self.path,keyvalue,2);self.change(true)})};self.setter=function(value){if(skip){skip=false;return}if(!value){container.empty();self.aclass(cempty);return}var builder=[],keys=Object.keys(value);for(var i=0;i<keys.length;i++){empty.key=keys[i];empty.value=value[empty.key];builder.push(self.template(empty))}self.tclass(cempty,!builder.length);container.empty().append(builder.join(''))}});

COMPONENT('layout','space:1;border:0;parent:window;margin:0;remember:1;autoresize:1;minsize:50',function(self,config,cls){var cls2='.'+cls,cache={},drag={},s={},events={},istop2=false,isbottom2=false,isright2=false,loaded=false,resizecache='',settings,prefkey='',prefexpire='1 month',isreset=false,layout=null;self.readonly();self.init=function(){ON('resize2 + resize',function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='layout'&&com.dom.offsetParent&&com.$ready&&!com.$removed&&com.config.autoresize)com.resize()}})};self.make=function(){self.aclass(cls);self.find('> section').each(function(){var el=$(this);var type=el.attrd('type');if(type.charAt(type.length-1)==='2'){type=type.substring(0,type.length-1);switch(type){case'top':istop2=true;break;case'bottom':isbottom2=true;break;case'right':isright2=true;break}}el.aclass('{0}-{1} hidden {0}-section'.format(cls,type));el.after('<div class="{0}-resize-{1} {0}-resize" data-type="{1}"></div>'.format(cls,type));el.after('<div class="{0}-lock hidden" data-type="{1}"></div>'.format(cls,type));s[type]=el});self.find('> .{0}-resize'.format(cls)).each(function(){var el=$(this);s[el.attrd('type')+'resize']=el});self.find('> .{0}-lock'.format(cls)).each(function(){var el=$(this);s[el.attrd('type')+'lock']=el});var tmp=self.find('> script');if(tmp.length){self.rebind(tmp.html(),true);tmp.remove()}events.bind=function(){var el=$(W);el.bind('mousemove',events.mmove);el.bind('mouseup',events.mup);self.element.bind('mouseleave',events.mup)};events.unbind=function(){var el=$(W);el.unbind('mousemove',events.mmove);el.unbind('mouseup',events.mup);self.element.unbind('mouseleave',events.mup)};events.mdown=function(e){var target=$(e.target);var type=target.attrd('type');var w=self.width();var h=self.height();var m=2;self.element.find('iframe').css('pointer-events','none');drag.cur=self.element.offset();drag.cur.top-=10;drag.cur.left-=8;drag.offset=target.position();drag.el=target;drag.x=e.pageX;drag.y=e.pageY;drag.horizontal=type==='left'||type==='right'?1:0;drag.type=type;drag.plusX=10;drag.plusY=10;drag.newx=-1;drag.newy=-1;drag.w=w;drag.h=h;var ch=cache[type],min=ch.minsize?(ch.minsize.value-1):0;var max=ch.maxsize?(ch.maxsize.value-1):0;target.aclass(cls+'-drag');switch(type){case'top':drag.min=min||(ch.size-m);drag.max=(cache.bottom?(h-s.bottom.height()-config.minsize):0);if(max&&drag.max>max)drag.max=max;break;case'right':drag.min=(min||ch.size);drag.max=(cache.left?(w-s.left.width()-config.minsize):0);if(max&&drag.max>max)drag.max=max;break;case'bottom':drag.min=(min||ch.size);drag.max=(cache.top?(h-s.top.height()-config.minsize):0);if(max&&drag.max>max)drag.max=max;break;case'left':drag.min=min||(ch.size-m);if(drag.min<config.minsize)drag.min=config.minsize;drag.max=(cache.right?(w-s.right.width()-config.minsize):0);if(max&&drag.max>max)drag.max=max;break}events.bind()};events.mmove=function(e){if(drag.horizontal){var x=drag.offset.left+(e.pageX-drag.x);if(drag.type==='right')x=drag.w-x;if(x<drag.min)x=drag.min+1;if(drag.max&&x>drag.max)x=drag.max-1;if(drag.type==='right')x=drag.w-x;drag.newy=x;drag.el.css('left',x+'px')}else{var y=drag.offset.top+(e.pageY-drag.y);if(drag.type==='bottom')y=drag.h-y;if(y<drag.min)y=drag.min+1;if(drag.max&&y>drag.max)y=drag.max-1;if(drag.type==='bottom')y=drag.h-y;drag.newy=y;drag.el.css('top',y+'px')}};events.mup=function(){self.element.find('iframe').css('pointer-events','');var offset=drag.el.position();var d=WIDTH();var pk=prefkey+'_'+layout+'_'+drag.type+'_'+d;drag.el.rclass(cls+'-drag');if(drag.horizontal){var w=offset.left;if(!isright2&&drag.type==='right')w=self.width()-w;s[drag.type].css('width',w);config.remember&&PREF.set(pk,w,prefexpire)}else{var h=offset.top;if(drag.type==='bottom'||drag.type==='preview')h=self.height()-h;s[drag.type].css('height',h);config.remember&&PREF.set(pk,h,prefexpire)}events.unbind();self.refresh()};self.find('> '+cls2+'-resize').on('mousedown',events.mdown)};self.lock=function(type,b){var el=s[type+'lock'];el&&el.tclass('hidden',b==null?b:!b)};self.rebind=function(code,noresize){code=code.trim();prefkey='L'+HASH(code);resizecache='';settings=new Function('return '+code)();!noresize&&self.resize()};var getSize=function(display,data){var obj=data[display];if(obj)return obj;switch(display){case'md':return getSize('lg',data);case'sm':return getSize('md',data);case'xs':return getSize('sm',data)}return data};var checktimeout=null,check=function(){checktimeout=null;self.resize()};self.resize=function(){if(self.dom.offsetParent==null){if(!checktimeout)checktimeout=setTimeout(check,500);return}if(checktimeout){clearTimeout(checktimeout);checktimeout=null}if(settings==null)return;var d=WIDTH();var el=self.parent(config.parent);var width=el.width();var height=el.height();var key=d+'x'+width+'x'+height;if(resizecache===key)return;var tmp=layout?settings[layout]:settings;if(tmp==null){WARN('j-Layout: layout "{0}" not found'.format(layout));tmp=settings}var size=getSize(d,tmp);height-=config.margin;resizecache=key;self.css({width:width,height:height});for(var k in s){el=s[k];self.update(k,size[k]?size[k]:settings[k])}config.resize&&self.EXEC(config.resize,d,width,height)};var parseSize=function(val,size){var str=typeof(val)==='string';var obj={raw:str?val.parseFloat():val,percentage:str?val.charAt(val.length-1)==='%':false};obj.value=obj.percentage?((((size/100)*obj.raw)>>0)-config.space):obj.raw;return obj};self.reset=function(){isreset=true;resizecache='';self.resize()};self.layout=function(name){if(name==null)name='';if(layout!=name){layout=name;resizecache='';self.resize()}};self.update=function(type,opt){if(opt==null)return;if(typeof(opt)==='string')opt=opt.parseConfig();if(s[type]==null)return;var el=s[type],css={},is=0,size=null,d=WIDTH();var c=cache[type];if(c==null)c=cache[type]={};var w=self.width();var h=self.height();var pk=prefkey+'_'+layout+'_'+type+'_'+d,cached=PREF.get(pk,prefexpire);if(isreset){cached&&PREF.set(pk);cached=0}var def=getSize(d,settings);var width=(opt.size||opt.width)||(def[type]?def[type].width:0);var height=(opt.size||opt.height)||(def[type]?def[type].height:0);if(width&&(type==='left'||type==='right')){size=parseSize(width,w);c.size=size.value;css.width=cached?cached:size.value;is=1}if(type==='left'||type==='right'){c.minsize=opt.minsize?parseSize(opt.minsize,w):0;c.maxsize=opt.maxsize?parseSize(opt.maxsize,w):0}else if(type==='top'||type==='bottom'){c.minsize=opt.minsize?parseSize(opt.minsize,h):0;c.maxsize=opt.maxsize?parseSize(opt.maxsize,h):0}if(height&&(type==='top'||type==='bottom')){size=parseSize(height,h);c.size=size.value;css.height=(cached?cached:size.value);is=1}if(opt.show==null)opt.show=true;el.tclass('hidden',!opt.show);c.show=!!opt.show;c.resize=opt.resize==null?false:!!opt.resize;el.tclass(cls+'-resizable',c.resize);s[type+'resize'].tclass('hidden',!c.show||!c.resize);is&&el.css(css);setTimeout2(self.ID+'refresh',self.refresh,50)};var getWidth=function(el){return el.hclass('hidden')?0:el.width()};var getHeight=function(el){return el.hclass('hidden')?0:el.height()};self.refresh=function(){var top=0,bottom=0,right=0,left=0,hidden='hidden',top2=0,bottom2=0,space=2,topbottomoffset=0,right2visible=isright2&&!s.right.hclass(hidden);if(s.top)top=top2=getHeight(s.top);if(s.bottom)bottom=bottom2=getHeight(s.bottom);var width=self.width()-(config.border*2);var height=self.height()-(config.border*2);if(istop2){topbottomoffset++;top2=0}if(isbottom2){topbottomoffset--;bottom2=0}if(s.left&&!s.left.hclass(hidden)){var cssleft={};space=top&&bottom?2:top||bottom?1:0;cssleft.left=0;cssleft.top=istop2?config.border:(top?(top+config.space):0);cssleft.height=isbottom2?(height-top2-config.border):(height-top2-bottom2-(config.space*space));cssleft.height+=topbottomoffset;s.left.css(cssleft);cssleft.width=s.left.width();s.leftlock.css(cssleft);delete cssleft.width;left=s.left.width();cssleft.left=s.left.width();s.leftresize.css(cssleft);s.leftresize.tclass(hidden,!s.left.hclass(cls+'-resizable'))}if(s.right&&!s.right.hclass(hidden)){right=s.right.width();space=top&&bottom?2:top||bottom?1:0;var cssright={};cssright.left=right2visible?(getWidth(s.left)+config.border+config.space):(width-right);cssright.top=istop2?config.border:(top?(top+config.space):0);cssright.height=isbottom2?(height-top2-config.border):(height-top2-bottom2-(config.space*space));cssright.height+=topbottomoffset;s.right.css(cssright);cssright.width=s.right.width();if(!isright2&&(width-cssright.left)<=0){s.right.css('left',0);cssright.width++}s.rightlock.css(cssright);delete cssright.width;if(right2visible)cssright.left+=s.right.width();else cssright.left=width-right-2;s.rightresize.css(cssright);s.rightresize.tclass(hidden,!s.right.hclass(cls+'-resizable'))}if(s.top){var csstop={};space=left?config.space:0;csstop.left=istop2?(left+space):0;if(right2visible&&istop2)csstop.left+=getWidth(s.right)+config.space;space=left&&right?2:left||right?1:0;csstop.width=istop2?(width-right-left-(config.space*space)):width;csstop.top=0;s.top.css(csstop);s.topresize.css(csstop);csstop.height=s.top.height();s.toplock.css(csstop);delete csstop.height;csstop.top=s.top.height();s.topresize.css(csstop);s.topresize.tclass(hidden,!s.top.hclass(cls+'-resizable'))}if(s.bottom){var cssbottom={};cssbottom.top=height-bottom;space=left?config.space:0;cssbottom.left=isbottom2?(left+space):0;if(right2visible&&isbottom2)cssbottom.left+=getWidth(s.right)+config.space;space=left&&right?2:left||right?1:0;cssbottom.width=isbottom2?(width-right-left-(config.space*space)):width;s.bottom.css(cssbottom);cssbottom.height=s.bottom.height();s.bottomlock.css(cssbottom);delete cssbottom.height;cssbottom.top=cssbottom.top-2;s.bottomresize.css(cssbottom);s.bottomresize.tclass(hidden,!s.bottom.hclass(cls+'-resizable'))}var space=left&&right?2:left?1:right?1:0,css={};css.left=left?left+config.space:0;if(right2visible)css.left+=getWidth(s.right)+config.space;css.width=(width-left-right-(config.space*space));css.top=top?top+config.space:0;space=top&&bottom?2:top||bottom?1:0;css.height=height-top-bottom-(config.space*space);s.main&&s.main.css(css);s.mainlock&&s.mainlock.css(css);self.element.SETTER('*/resize');config.resize&&self.EXEC(config.resize,WIDTH(),width,height);if(loaded==false){loaded=true;self.rclass('invisible')}isreset=false};self.setter=function(value){self.layout(value)}});

COMPONENT('listform','empty:---;default:1;',function(self,config,cls){var cls2='.'+cls,skip=false,container,form,items;self.validate=function(value){return config.disabled||!config.required?true:!!(value&&value.length>0)};self.make=function(){self.aclass(cls+' invisible');if(config.selector){var customselector=$(document).find(config.selector);self.html(customselector.html())}var scr=self.find('script');var tmp;self.template=Tangular.compile(scr.eq(0).html());form='<div class="{0}-form-container hidden{2}"><ui-plugin path="{1}" config="isolated:1"><div class="{0}-form">{3}</div></ui-plugin></div>'.format(cls,self.ID,config.formclass?(' '+config.formclass):'',scr.eq(1).html());tmp=scr.eq(2).html();scr.remove();var footer=tmp?'<div class="{0}-footer">{1}</div>'.format(cls,tmp):'';if(footer&&config.footertop)self.append(tmp);self.append('<div class="{0}-container"><div class="{0}-emptylabel">{1}</div><div class="{0}-items"></div></div>'.format(cls,config.empty));if(footer&&!config.footertop)self.append(tmp);container=self.find(cls2+'-items');var entersubmit=function(){self.find('button[name="submit"]').trigger('click')};config.enter&&self.event('keydown','input',function(e){if(config.enter&&e.which===13)setTimeout2(self.ID,entersubmit,200)});self.event('click',cls2+'-item',function(){if(config.disabled)return;var t=this;if(form.$target===t)self.cancel();else self.edit(t)});self.event('click','button',function(e){if(config.disabled)return;var el=$(this);var parent=el.closest(cls2+'-item');var tmp;if(parent.length){var tmp=parent[0].$data;self.cancel();e.stopPropagation();switch(this.name){case'up':case'down':el.closest('.ui-listform-item').aclass('ui-listform-item-highlight');el.closest('.ui-listform-item').rclass(('ui-listform-item-highlight'),1000);var index=items.indexOf(tmp);var tmp=index+(this.name==='up'?-1:1);if(tmp<0||index>items.length)return;var a=items[tmp];items[tmp]=items[index];items[index]=a;NODEMOVE(parent[0],this.name==='up');skip=true;self.set(items,2);self.change(true);break;case'remove':items.splice(items.indexOf(tmp),1);skip=true;self.set(items,2);self.change(true);parent.remove();break}return}var is=false,fn;switch(this.name){case'create':self.check();if(!$(form).hclass('hidden')&&!form.$data){self.cancel();return}fn=function(obj){if(config.create||!config.default)SET('{0} @reset'.format(self.ID),obj);else DEFAULT(self.ID+'__{}');self.edit()};if(config.create)self.EXEC(config.create,fn);else fn({});is=true;break;case'submit':case'update':tmp=GET('{0} @reset'.format(self.ID));fn=function(tmp){if(tmp){if(!items)items=[];if(form.$target){COPY(tmp,form.$data);self.redraw(form.$target,form.$data)}else{items.push(tmp);self.create(tmp)}skip=true;self.set(items,2);self.change(true)}self.cancel()};if(config[this.name])self.EXEC(config[this.name],tmp,fn);else fn(tmp);is=true;break;case'cancel':self.cancel();is=true;break;case'remove':var el=form.$target,data=form.$data;fn=function(is){self.cancel();if(is!==false&&data){el.parentNode.removeChild(el);items.splice(items.indexOf(data),1);skip=true;self.set(items,2);self.change(true)}};if(config.remove)self.EXEC(config.remove,data,fn);else fn();is=true;break}if(is){e.preventDefault();e.stopPropagation()}})};self.configure=function(key,value){switch(key){case'disabled':self.tclass('ui-'+key,!!value);self.find('button[name="create"]').prop('disabled',!!value);break;case'required':self.tclass(cls+'-'+key,!!value);break}};self.check=function(){if(!self.$$check){form=$(form)[0];container.append(form);self.compile();self.$$check=true}};self.edit=function(el){self.check();self.cancel();var before,parent;if(el){parent=el.parentNode;var children=parent.children;for(var i=0;i<children.length;i++){if(children[i]===el){before=children[i+1];break}}form.$target=el;form.$data=el.$data;SET('{0} @reset'.format(self.ID),CLONE(el.$data));$(el).aclass(cls+'-selected')}else{parent=container[0];form.$target=form.$data=null}if(before)parent.insertBefore(form,before);else parent.appendChild(form);setTimeout(function(){$(form).tclass(cls+'-new',!el).rclass('hidden');config.autofocus&&self.autofocus(config.autofocus)},150)};self.cancel=function(){if(self.$$check){if(form.parentNode!==self.dom)self.dom.appendChild(form);form.$target&&$(form.$target).rclass(cls+'-selected');form.$target=form.$data=null;$(form).aclass('hidden')}};self.redraw=function(el,data){el.innerHTML=self.template(data)};self.create=function(item){var dom=document.createElement('DIV');dom.setAttribute('class',cls+'-item'+(config.itemclass?(' '+config.itemclass):''));dom.innerHTML=self.template(item);dom.$data=item;container[0].appendChild(dom)};self.setter=function(value,path,type){if(!type)self.rclass('invisible');items=value;self.tclass(cls+'-empty',!value||!value.length);self.cancel();if(skip){skip=false;return}form.$data&&self.cancel();container.find(cls2+'-item').remove();if(value){for(var i=0;i<value.length;i++)self.create(value[i])}};self.state=function(type){if(!type)return;var invalid=config.required?self.isInvalid():false;if(invalid===self.$oldstate)return;self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid)}});

COMPONENT('loadcontent','wait:0',function(self,config){self.readonly();self.blind();self.make=function(){var template=$(config.selector);if(template.length){var content=template.html().replace(/SCR/g,'scr'+'ipt');var replace=(config.replace||'').split(',').trim();for(var m of replace){var tmp=m.split('=');content=content.replace(new RegExp(tmp[0],'g'),tmp[1])}self.html(content);COMPILE();config.exec&&self.SEEX(config.exec,self.element)}else if(config.wait&&self.dom)setTimeout(self.make,config.wait)}});

COMPONENT('loading',function(self,config,cls){var delay,prev;self.readonly();self.singleton();self.nocompile();self.make=function(){self.aclass(cls+' '+cls+'-'+(config.style||1));self.append('<div><div class="'+cls+'-text hellip"></div></div>')};self.show=function(text){clearTimeout(delay);if(prev!==text){prev=text;self.find('.'+cls+'-text').html(text||'')}self.rclass('hidden');document.activeElement&&document.activeElement.blur();return self};self.hide=function(timeout){clearTimeout(delay);delay=setTimeout(function(){self.aclass('hidden')},timeout||1);return self}});

COMPONENT('locale',function(self,config){self.singleton();self.nocompile();self.readonly();self.use=function(language){if(!language)return;if(config.requests)DEF.languagehtml=language;var fdw=0;var nf=1;var tf=24;var df='';switch(language){case'af':nf=2;df='dd/MM/yyyy';tf=24;fdw=0;break;case'sq':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'ar':nf=4;df='yyyy/MM/dd';tf=24;fdw=6;break;case'ar-dz':nf=3;df='dd/yyyy/MM';tf=24;fdw=1;break;case'ar-kw':nf=4;df='dd/MM/yyyy';tf=24;fdw=6;break;case'ar-ly':nf=3;df='dd/yyyy/MM';tf=24;fdw=6;break;case'ar-ma':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'ar-sa':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'ar-tn':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'hy-am':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'az':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'bm':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'eu':nf=3;df='yyyy-MM-dd';tf=24;fdw=1;break;case'be':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'bn':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'bn-bd':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'bs':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'br':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'bg':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'my':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'km':nf=3;df='dd/MM/yyyy';tf=24;fdw=0;break;case'ca':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'tzm':nf=3;df='dd/MM/yyyy';tf=24;fdw=6;break;case'tzm-latn':nf=3;df='dd/MM/yyyy';tf=24;fdw=6;break;case'zh-cn':nf=4;df='yyyy/MM/dd';tf=24;fdw=0;break;case'zh-hk':nf=4;df='yyyy/MM/dd';tf=24;fdw=0;break;case'zh-mo':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'zh-tw':nf=4;df='yyyy/MM/dd';tf=24;fdw=0;break;case'cv':nf=2;df='dd-MM-yyyy';tf=24;fdw=1;break;case'hr':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'cs':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'da':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'nl':nf=3;df='dd-MM-yyyy';tf=24;fdw=1;break;case'nl-be':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'en-au':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'en-ca':nf=4;df='yyyy-MM-dd';tf=12;fdw=0;break;case'en-in':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'en-ie':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'en-il':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'en-nz':nf=4;df='dd/MM/yyyy';tf=12;fdw=1;break;case'en-sg':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'en-gb':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'en':nf=4;df='MM/dd/yyyy';tf=12;fdw=0;break;case'eo':nf=2;df='yyyy-MM-dd';tf=24;fdw=1;break;case'et':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'fo':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'fil':nf=4;df='MM/dd/yyyy';tf=24;fdw=0;break;case'fi':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'fr':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'fr-ca':nf=4;df='yyyy-MM-dd';tf=24;fdw=0;break;case'fr-ch':nf=1;df='dd.MM.yyyy';tf=24;fdw=1;break;case'fy':nf=3;df='dd-MM-yyyy';tf=24;fdw=1;break;case'gl':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'ka':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'de':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'de-at':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'de-ch':nf=1;df='dd.MM.yyyy';tf=24;fdw=1;break;case'el':nf=3;df='dd/MM/yyyy';tf=12;fdw=1;break;case'gu':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'he':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'hi':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'hu':nf=2;df='yyyy.MM.dd';tf=24;fdw=1;break;case'is':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'id':nf=3;df='dd/MM/yyyy';tf=24;fdw=0;break;case'ga':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'it':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'it-ch':nf=1;df='dd.MM.yyyy';tf=24;fdw=1;break;case'ja':nf=4;df='yyyy/MM/dd';tf=24;fdw=0;break;case'jv':nf=3;df='dd/MM/yyyy';tf=24;fdw=0;break;case'kn':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'kk':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'tlh':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'gom-deva':nf=4;df='dd-MM-yyyy';tf=12;fdw=0;break;case'gom-latn':nf=4;df='dd-MM-yyyy';tf=12;fdw=0;break;case'ko':nf=4;df='yyyy.MM.dd';tf=12;fdw=0;break;case'ku':nf=4;df='dd/MM/yyyy';tf=24;fdw=6;break;case'ky':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'lo':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'lv':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'lt':nf=2;df='yyyy-MM-dd';tf=24;fdw=1;break;case'lb':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'mk':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'ms-my':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'ms':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'ml':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'dv':nf=4;df='dd/MM/yyyy';tf=24;fdw=5;break;case'mt':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'mi':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'mr':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'mn':nf=4;df='yyyy-MM-dd';tf=24;fdw=1;break;case'me':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'ne':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'se':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'nb':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'nn':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'oc-lnc':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'fa':nf=4;df='dd/MM/yyyy';tf=24;fdw=6;break;case'pl':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'pt':nf=2;df='dd/MM/yyyy';tf=24;fdw=0;break;case'pt-br':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'x-pseudo':nf=2;df='dd/MM/yyyy';tf=12;fdw=1;break;case'pa-in':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'ro':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'ru':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'gd':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'sr':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'sr-cyrl':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'sd':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'si':nf=4;df='yyyy/MM/dd';tf=12;fdw=1;break;case'sk':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'sl':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'es':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'es-do':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'es-mx':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'es-us':nf=4;df='MM/dd/yyyy';tf=12;fdw=0;break;case'sw':nf=4;df='dd.MM.yyyy';tf=24;fdw=1;break;case'sv':nf=2;df='yyyy-MM-dd';tf=24;fdw=1;break;case'tl-ph':nf=4;df='MM/dd/yyyy';tf=24;fdw=0;break;case'tg':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'tzl':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'ta':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'te':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'tet':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'th':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'bo':nf=4;df='dd/MM/yyyy';tf=12;fdw=0;break;case'tr':nf=3;df='dd.MM.yyyy';tf=24;fdw=1;break;case'tk':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'uk':nf=2;df='dd.MM.yyyy';tf=24;fdw=1;break;case'ur':nf=4;df='dd/MM/yyyy';tf=24;fdw=0;break;case'ug-cn':nf=4;df='yyyy-MM-dd';tf=24;fdw=0;break;case'uz':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'uz-latn':nf=2;df='dd/MM/yyyy';tf=24;fdw=1;break;case'vi':nf=3;df='dd/MM/yyyy';tf=24;fdw=1;break;case'cy':nf=4;df='dd/MM/yyyy';tf=24;fdw=1;break;case'yo':nf=4;df='dd/MM/yyyy';tf=12;fdw=1;break;case'ss':nf=4;df='dd/MM/yyyy';tf=12;fdw=1;break}if(!df)return false;DEF.dateformat=df;DEF.timeformat=tf===12?'!HH:mm a':'HH:mm';DEF.firtdayofweek=fdw;DEF.decimalseparator=nf===2||nf===3?',':'.';DEF.thousandsseparator=nf===4?',':nf===3?'.':' ';ENV('ts',(tf===12?'!':'')+df+' - '+(tf===12?DEF.timeformat.substring(1):DEF.timeformat));ENV('date',DEF.dateformat);ENV('time',DEF.timeformat);CONFIG('datepicker,firstday','firstday:'+fdw);CONFIG('timepicker','ampm:'+tf===12?'true':'false');self.path&&self.set({df:df,tf:tf,fdw:fdw,nf:nf});return true};self.make=function(){var language=navigator.language.toLowerCase();if(config.language)self.use(config.language);else if(!self.use(language))self.use(language.split('-')[0])}});

COMPONENT('markdown','highlight:true;charts:false',function(self,config){self.readonly();self.singleton();self.blind();self.nocompile();self.make=function(){if(config.highlight){IMPORT('https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js');IMPORT('https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css')}if(config.charts)IMPORT('https://cdn.componentator.com/apexcharts.min@310.js');setTimeout(function(){self.remove()},500);$(document).on('click','.markdown-showsecret,.markdown-showblock',function(){var el=$(this);var next=el.next();next.tclass('hidden');var is=next.hclass('hidden');var icons=el.find('i');if(el.hclass('markdown-showsecret')){icons.eq(0).tclass('ti-unlock',!is).tclass('ti-lock',is);icons.eq(1).tclass('ti-angle-up',!is).tclass('ti-angle-down',is)}else{icons.eq(0).tclass('ti-minus',!is).tclass('ti-plus',is);el.tclass('markdown-showblock-visible',!is)}el.find('b').html(el.attrd(is?'show':'hide'))})};(function Markdown(){var keywords=/\{.*?\}\(.*?\)/g;var linksexternal=/(https|http):\/\//;var format=/__.*?__|_.*?_|\*\*.*?\*\*|\*.*?\*|~~.*?~~|~.*?~/g,ordered=/^[a-z|0-9]{1}\.\s|^-\s/i,orderedsize=/^(\s|\t)+/;var code=/`.*?`/g,encodetags=/<|>/g,regdash=/-{2,}/g,regicons=/(^|[^\w]):((fab\s|far\s|fas\s|fal\s|fad|fa\s)fa-)?[a-z-]+:([^\w]|$)/g;var regemptychar=/\s|\W/,regtags=/<[^>]*>/g,encode=function(val){return'&'+(val==='<'?'lt':'gt')+';'};function markdown_code(value){return value?('<code>'+value.substring(1,value.length-1)+'</code>'):''}function markdown_imagelinks(value){if(!value)return'';var end=value.lastIndexOf(')')+1;var img=value.substring(0,end);var url=value.substring(end+2,value.length-1);var label=markdown_links(img);var footnote=label.substring(0,13);if(footnote==='<sup data-id='||footnote==='<span data-id'||label.substring(0,9)==='<a href="')return label;return'<a href="'+url+'"'+(linksexternal.test(url)?' target="_blank"':'')+'>'+label+'</a>'}function markdown_table(value,align,ishead){var columns=value.substring(1,value.length-1).split('|');var builder='';for(var i=0;i<columns.length;i++){var column=columns[i].trim();if(column.charAt(0)!='-'){var a=align[i];builder+='<'+(ishead?'th':'td')+(a&&a!=='left'?(' class="'+a+'"'):'')+'>'+column+'</'+(ishead?'th':'td')+'>'}}return'<tr>'+builder+'</tr>'}function markdown_links(value){if(!value)return'';var end=value.lastIndexOf(']');var img=value.charAt(0)==='!';var text=value.substring(img?2:1,end);var link=value.substring(end+2,value.length-1);if((/^#\d+$/).test(link)){return(/^\d+$/).test(text)?'<sup data-id="{0}" class="markdown-footnote">{1}</sup>'.format(link.substring(1),text):'<span data-id="{0}" class="markdown-footnote">{1}</span>'.format(link.substring(1),text)}if(link.substring(0,4)==='www.')link='https://'+link;var nofollow=link.charAt(0)==='@'?' rel="nofollow"':linksexternal.test(link)?' target="_blank"':'';return'<a href="'+link+'"'+nofollow+'>'+text+'</a>'}function markdown_image(value){var end=value.lastIndexOf(']');var text=value.substring(2,end);var link=value.substring(end+2,value.length-1);var responsive=1,f=text.charAt(0);if(f==='+'){responsive=2;text=text.substring(1)}else if(f==='-'){responsive=3;text=text.substring(1)}return'<img src="'+link+'" alt="'+text+'"'+(responsive===1?' class="img-responsive"':responsive===3?' class="markdown-gallery"':'')+' border="0" loading="lazy" />'}function markdown_keywords(value){var keyword=value.substring(1,value.indexOf('}'));var type=value.substring(value.lastIndexOf('(')+1,value.lastIndexOf(')'));return'<span class="markdown-keyword" data-type="{0}">{1}</span>'.format(type,keyword)}function markdown_links2(value){value=value.substring(4,value.length-4);return'<a href="'+(value.isEmail()?'mailto:':linksexternal.test(value)?'':'http://')+value+'" target="_blank">'+value+'</a>'}function markdown_format(value,index,text){var p=text.charAt(index-1);var n=text.charAt(index+value.length);if((!p||regemptychar.test(p))&&(!n||regemptychar.test(n))){var beg='',end='',tag;if(value.indexOf('*')!==-1){tag=value.indexOf('**')===-1?'em':'strong';beg+='<'+tag+'>';end='</'+tag+'>'+end}if(value.indexOf('_')!==-1){tag=value.indexOf('__')===-1?'u':'b';beg+='<'+tag+'>';end='</'+tag+'>'+end}if(value.indexOf('~')!==-1){beg+='<strike>';end='</strike>'+end}var count=value.charAt(1)===value.charAt(0)?2:1;return beg+value.substring(count,value.length-count)+end}return value}function markdown_id(value){value=value.replace(regtags,'');return value.slug().replace(regdash,'-')}function markdown_icon(value){var beg=-1,end=-1;for(var i=0;i<value.length;i++){var code=value.charCodeAt(i);if(code===58){if(beg===-1)beg=i+1;else end=i}}var icon=value.substring(beg,end);if(icon.indexOf(' ')===-1)icon='ti ti-'+icon;return value.substring(0,beg-1)+'<i class="'+icon+'"></i>'+value.substring(end+1)}function markdown_urlify(str){return str.replace(/(^|\s)+(((https?:\/\/)|(www\.))[^\s]+)/g,function(url,b,c){var len=url.length,l=url.charAt(len-1);var f=url.charAt(0);if(l==='.'||l===',')url=url.substring(0,len-1);else l='';url=(c==='www.'?'http://'+url:url).trim();return(f.charCodeAt(0)<40?f:'')+'['+url+']('+url+')'+l})}FUNC.markdownredraw=function(el,opt){if(!opt)opt=EMPTYOBJECT;if(!el)el=opt.element||$('body');var arr;if(!opt.nosecret){arr=el.find('.lang-secret');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;var el=$(t);el.parent().replaceWith('<div class="markdown-secret" data-show="{0}" data-hide="{1}"><span class="markdown-showsecret"><i class="ti ti-lock"></i><i class="ti pull-right ti-angle-down"></i><b>{0}</b></span><div class="hidden">'.format(opt.showsecret||'Show secret data',opt.hidesecret||'Hide secret data')+el.html().trim().markdown(opt.secretoptions,true)+'</div></div>')}}}if(!opt.novideo){arr=el.find('.lang-video');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;var el=$(t);var html=el.html();if(html.indexOf('youtube')!==-1)el.parent().replaceWith('<div class="markdown-video"><iframe src="https://www.youtube.com/embed/'+html.split('v=')[1]+'" frameborder="0" allowfullscreen></iframe></div>');else if(html.indexOf('vimeo')!==-1)el.parent().replaceWith('<div class="markdown-video"><iframe src="//player.vimeo.com/video/'+html.substring(html.lastIndexOf('/')+1)+'" frameborder="0" allowfullscreen></iframe></div>')}}}if(!opt.nochart&&W.ApexCharts){arr=el.find('.lang-barchart');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;var el=$(t);var arr=el.html().split('\n').trim();var series=[],categories=[],y='';for(var i=0;i<arr.length;i++){var line=arr[i].split('|').trim();for(var j=1;j<line.length;j++){if(i===0)series.push({name:line[j],data:[]});else series[j-1].data.push(+line[j])}if(i)categories.push(line[0]);else y=line[0]}var options={chart:{height:300,type:'bar',},yaxis:{title:{text:y}},series:series,xaxis:{categories:categories,},fill:{opacity:1},},chart=new W.ApexCharts(el.parent().empty()[0],options);chart.render()}}arr=el.find('.lang-linechart');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;if(!W.ApexCharts)return;var el=$(t);var arr=el.html().split('\n').trim();var series=[],categories=[],y='';for(var i=0;i<arr.length;i++){var line=arr[i].split('|').trim();for(var j=1;j<line.length;j++){if(i===0)series.push({name:line[j],data:[]});else series[j-1].data.push(+line[j])}if(i)categories.push(line[0]);else y=line[0]}var options={chart:{height:300,type:'line',},yaxis:{title:{text:y}},series:series,xaxis:{categories:categories,},fill:{opacity:1},},chart=new W.ApexCharts(el.parent().empty()[0],options);chart.render()}}}if(!opt.noiframe){arr=el.find('.lang-iframe');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;var el=$(t);el.parent().replaceWith('<div class="markdown-iframe">'+el.html().replace(/&lt;/g,'<').replace(/&gt;/g,'>')+'</div>')}}}if(!opt.nocode&&config.highlight){WAIT('hljs',function(){arr=el.find('.markdown-code');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;var sub=$(t).find('pre code');for(var block of sub)W.hljs.highlightBlock(block)}}})}arr=el.find('a');for(var t of arr){if(!t.$mdloaded){t.$mdloaded=1;var a=$(t);var href=a.attr('href');var c=href.substring(0,1);if(href==='#'){var beg='',end='',text=el.html();if(text.substring(0,1)==='<')beg='-';if(text.substring(text.length-1)==='>')end='-';a.attr('href','#'+(beg+markdown_id(a.text())+end))}else if(c!=='/'&&c!=='#')a.attr('target','_blank')}}EMIT('markdown',el,opt);el.find('.markdown-code').rclass('hidden')};Thelpers.markdown=function(val,opt){return val?(val+'').markdown(opt):val};String.prototype.markdown=function(opt,nested){var str=this;if(!opt)opt={};var lines=str.split('\n');var builder=[],ul=[],table=false,iscode=false,isblock=false,ishead=0,isprevblock=false,prev,prevsize=0,previndex,tmp;if(opt.wrap==null)opt.wrap=true;if(opt.linetag==null)opt.linetag='p';var closeul=function(){while(ul.length){var text=ul.pop();builder.push('</'+text+'>')}};var formatlinks=function(val){return markdown_links(val,opt.images)};var linkscope=function(val,index,callback){var beg=-1,beg2=-1,can=false,skip=false,find=false,n;for(var i=index;i<val.length;i++){var c=val.charAt(i);if(c==='['){beg=i;can=false;find=true;continue}var codescope=val.substring(i,i+6);if(skip&&codescope==='</code'){skip=false;i+=7;continue}if(skip)continue;if(!find&&codescope==='<code>'){skip=true;continue}var il=val.substring(i,i+4);if(il==='&lt;'){beg2=i;continue}else if(beg2>-1&&il==='&gt;'){callback(val.substring(beg2,i+4),true);beg2=-1;continue}if(c===']'){can=false;find=false;if(beg===-1)continue;n=val.charAt(i+1);if(n===' ')n=val.charAt(i+2);can=n==='('}if(beg>-1&&can&&c===')'){n=val.charAt(beg-1);callback(val.substring(beg-(n==='!'?1:0),i+1));can=false;find=false;beg=-1}}};var formatline=function(line){var tmp=[];return line.replace(code,function(text){tmp.push(text);return'\0'}).replace(format,markdown_format).replace(/\0/g,function(){return markdown_code(tmp.shift())})};var imagescope=function(val){var beg=-1,can=false,n;for(var i=0;i<val.length;i++){var c=val.charAt(i);if(c==='['){beg=i;can=false;continue}if(c===']'){can=false;if(beg===-1)continue;n=val.charAt(i+1);if(n===' ')n=val.charAt(i+2);can=n==='('}if(beg>-1&&can&&c===')'){n=val.charAt(beg-1);var tmp=val.substring(beg-(n==='!'?1:0),i+1);if(tmp.charAt(0)==='!')val=val.replace(tmp,markdown_image(tmp));can=false;beg=-1}}return val};for(var i=0;i<lines.length;i++){lines[i]=lines[i].replace(encodetags,encode);var three=lines[i].substring(0,3);if(!iscode&&(three===':::'||(three==='==='))){if(isblock){if(opt.blocks!==false)builder[builder.length-1]+='</div></div>';isblock=false;isprevblock=true;continue}closeul();isblock=true;if(opt.blocks!==false){line=lines[i].substring(3).trim();if(opt.formatting!==false)line=formatline(line);builder.push('<div class="markdown-block"><span class="markdown-showblock"><i class="ti ti-plus"></i>{0}</span><div class="hidden">'.format(line))}prev='';continue}if(!isblock&&lines[i]&&isprevblock){builder.push('<br />');isprevblock=false}if(three==='```'){if(iscode){if(opt.code!==false)builder[builder.length-1]+='</code></pre></div>';iscode=false;continue}closeul();iscode=true;if(opt.code!==false)tmp='<div class="markdown-code hidden"><pre class="noscrollbar"><code class="lang-'+lines[i].substring(3)+'">';prev='code';continue}if(iscode){if(opt.code!==false)builder.push(tmp+lines[i]);if(tmp)tmp='';continue}var line=lines[i];if(opt.br!==false)line=line.replace(/&lt;br(\s\/)?&gt;/g,'<br />');if(line.length>10&&opt.urlify!==false&&opt.links!==false)line=markdown_urlify(line);if(opt.custom)line=opt.custom(line);if(line.length>2&&line!=='***'&&line!=='---'){if(opt.formatting!==false)line=formatline(line);if(opt.images!==false)line=imagescope(line);if(opt.links!==false){linkscope(line,0,function(text,inline){if(inline)line=line.replace(text,markdown_links2);else if(opt.images!==false)line=line.replace(text,markdown_imagelinks);else line=line.replace(text,formatlinks)})}if(opt.keywords!==false)line=line.replace(keywords,markdown_keywords);if(opt.icons!==false)line=line.replace(regicons,markdown_icon)}if(!line){if(table){table=null;if(opt.tables!==false)builder.push('</tbody></table>')}}if(line===''&&lines[i-1]===''){closeul();if(opt.emptynewline!==false)builder.push('<br />');prev='br';continue}if(line[0]==='|'){closeul();if(!table){var next=lines[i+1];if(next[0]==='|'){if(next.indexOf('--')===-1){if(opt.tables!==false)builder.push('<table class="table table-bordered"><thead>');table=[];prev='table';ishead=2}else{table=[];var columns=next.substring(1,next.length-1).split('|');for(var j=0;j<columns.length;j++){var column=columns[j].trim();var align='left';if(column.charAt(column.length-1)===':')align=column[0]===':'?'center':'right';table.push(align)}if(opt.tables!==false)builder.push('<table class="table table-bordered"><thead>');prev='table';ishead=1;i++}}else continue}if(opt.tables!==false){if(ishead===1)builder.push(markdown_table(line,table,true)+'</thead><tbody>');else if(ishead===2)builder.push('<tbody>'+markdown_table(line,table));else builder.push(markdown_table(line,table))}ishead=0;continue}if(line.charAt(0)==='#'){closeul();if(line.substring(0,2)==='# '){tmp=line.substring(2).trim();if(opt.headlines!==false)builder.push('<h1 id="'+markdown_id(tmp)+'">'+tmp+'</h1>');prev='#';continue}if(line.substring(0,3)==='## '){tmp=line.substring(3).trim();if(opt.headlines!==false)builder.push('<h2 id="'+markdown_id(tmp)+'">'+tmp+'</h2>');prev='##';continue}if(line.substring(0,4)==='### '){tmp=line.substring(4).trim();if(opt.headlines!==false)builder.push('<h3 id="'+markdown_id(tmp)+'">'+tmp+'</h3>');prev='###';continue}if(line.substring(0,5)==='#### '){tmp=line.substring(5).trim();if(opt.headlines!==false)builder.push('<h4 id="'+markdown_id(tmp)+'">'+tmp+'</h4>');prev='####';continue}if(line.substring(0,6)==='##### '){tmp=line.substring(6).trim();if(opt.headlines!==false)builder.push('<h5 id="'+markdown_id(tmp)+'">'+tmp+'</h5>');prev='#####';continue}}tmp=line.substring(0,3);if(tmp==='---'||tmp==='***'){prev='hr';if(opt.hr!==false)builder.push('<hr class="markdown-line'+(tmp.charAt(0)==='-'?'1':'2')+'" />');continue}if((/^#\d+:(\s)+/).test(line)){if(opt.footnotes!==false){tmp=line.indexOf(':');builder.push('<div class="markdown-footnotebody" data-id="{0}"><span>{0}:</span> {1}</div>'.format(line.substring(1,tmp).trim(),line.substring(tmp+1).trim()))}continue}if(line.substring(0,5)==='&gt; '){if(opt.blockquotes!==false)builder.push('<blockquote>'+line.substring(5).trim()+'</blockquote>');prev='>';continue}if(line.substring(0,5)==='&lt; '){if(opt.sections!==false)builder.push('<section>'+line.substring(5).trim()+'</section>');prev='<';continue}var tmpline=line.trim();if(opt.ul!==false&&ordered.test(tmpline)){var size=line.match(orderedsize);if(size)size=size[0].length;else size=0;var append=false;if(prevsize!==size){if(size>prevsize){prevsize=size;append=true;var index=builder.length-1;builder[index]=builder[index].substring(0,builder[index].length-5);prev=''}else{prevsize=size;builder.push('</'+ul.pop()+'>')}}var type=tmpline.charAt(0)==='-'?'ul':'ol';if(prev!==type){var subtype;if(type==='ol')subtype=tmpline.charAt(0);previndex=builder.push('<'+type+(subtype?(' type="'+subtype+'"'):'')+'>')-1;ul.push(type+(append?'></li':''));prev=type;prevsize=size}var tmpstr=(type==='ol'?tmpline.substring(tmpline.indexOf('.')+1):tmpline.substring(2));if(type!=='ol'){var tt=tmpstr.substring(0,3);if(tt==='[ ]'||tt==='[x]'){if(previndex!=null)builder[previndex]=builder[previndex].replace('<ul','<ul class="markdown-tasks"');previndex=null}}builder.push('<li>'+tmpstr.trim().replace(/\[x\]/g,'<i class="ti ti-check-square green"></i>').replace(/\[\s\]/g,'<i class="ti ti-square"></i>')+'</li>')}else{closeul();line&&builder.push((opt.linetag?('<'+opt.linetag+'>'):'')+line.trim()+(opt.linetag?('</'+opt.linetag+'>'):''));prev='p'}}closeul();table&&opt.tables!==false&&builder.push('</tbody></table>');iscode&&opt.code!==false&&builder.push('</code></pre>');if(!opt.noredraw&&typeof(window)==='object')setTimeout(FUNC.markdownredraw,1,null,opt);return(opt.wrap?('<div class="markdown'+(nested?'':' markdown-container')+'">'):'')+builder.join('\n').replace(/\t/g,'    ')+(opt.wrap?'</div>':'')}})()});

COMPONENT('menu','style:2',function(self,config,cls){self.singleton();self.readonly();self.nocompile&&self.nocompile();var cls2='.'+cls,is=false,issubmenu=false,events={},ul,children,prevsub,parentclass,container;self.make=function(){self.aclass('hidden '+cls+'-area');self.append('<div class="{0} {0}-style-{1}"><div class="{0}-items"><ul></ul></div><div class="{0}-submenu hidden"><ul></ul></div>'.format(cls,config.style));container=self.find('> '+cls2);ul=self.find(cls2+'-items').find('ul');children=self.find(cls2+'-submenu');self.element.on('click',function(e){if(e.target===self.dom)self.hide()});self.event('click','li',function(e){var el=$(this);if(!el.hclass(cls+'-divider')&&!el.hclass(cls+'-disabled')){self.opt.scope&&M.scope(self.opt.scope);var index=el.attrd('index').split('-');if(index.length>1){self.opt.callback(self.opt.items[+index[0]].children[+index[1]]);self.hide()}else if(!issubmenu){self.opt.callback(self.opt.items[+index[0]]);self.hide()}}e.preventDefault();e.stopPropagation()});self.event('contextmenu',function(e){e.preventDefault();e.stopPropagation();self.hide()});events.hide=function(){is&&self.hide()};self.event('scroll',events.hide);self.on('reflow + scroll + resize + resize2',events.hide);events.hidechildren=function(){if($(this.parentNode.parentNode).hclass(cls+'-items')){if(prevsub&&prevsub[0]!==this){prevsub.rclass(cls+'-selected');prevsub=null;children.aclass('hidden');issubmenu=false}}};events.children=function(){if(prevsub&&prevsub[0]!==this){prevsub.rclass(cls+'-selected');prevsub=null}issubmenu=true;var el=prevsub=$(this);var index=+el.attrd('index');var item=self.opt.items[index];el.aclass(cls+'-selected');var html=self.makehtml(item.children,index);children.find('ul').html(html);children.rclass('hidden');var css={},offset=el.position();css.left=ul.width()-5;css.top=offset.top-5;var offsetX=offset.left;offset=self.element.offset();var w=children.width();var left=offset.left+css.left+w;if(left>(WW+30))css.left=(offsetX-w)+5;children.css(css);var leftoffset=children.offset().left;var childrenwidth=children.width();var suboffset=childrenwidth+leftoffset;if(suboffset>WW)children.css('left',-childrenwidth)}};self.bindevents=function(){events.is=true;$(document).on('touchstart mouseenter mousedown',cls2+'-children',events.children);$(W).on('scroll',events.hide);self.element.on('mouseenter','li',events.hidechildren)};self.unbindevents=function(){events.is=false;$(document).off('touchstart mouseenter mousedown',cls2+'-children',events.children);$(W).off('scroll',events.hide);self.element.off('mouseenter','li',events.hidechildren)};self.showxy=function(x,y,items,callback){var opt={};opt.x=x;opt.y=y;opt.items=items;opt.callback=callback;self.show(opt)};self.makehtml=function(items,index){var builder=[],tmp;for(var i=0;i<items.length;i++){var item=items[i];if(typeof(item)==='string'){if(item==='-')tmp='<hr />';else tmp='<span>{0}</span>'.format(item);builder.push('<li class="{0}-divider">{1}</li>'.format(cls,tmp));continue}var cn=item.classname||item.class||'',icon='',color=item.color?'style="color:{color}"'.arg(item):'';if(item.icon)icon='<i class="{0}" {1}></i>'.format(item.icon.charAt(0)==='!'?item.icon.substring(1):item.icon.indexOf(' ')===-1?('ti ti-'+item.icon):item.icon,color);else cn=(cn?(cn+' '):'')+cls+'-nofa';tmp='';if(index==null&&item.children&&item.children.length){cn+=(cn?' ':'')+cls+'-children';tmp+='<i class="ti ti-angle-right pull-right"></i>'}if(item.selected)cn+=(cn?' ':'')+cls+'-selected';if(item.disabled)cn+=(cn?' ':'')+cls+'-disabled';tmp+='<div class="{0}-name">{1}{2}{3}</div>'.format(cls,icon,item.name,item.shortcut?'<b>{0}</b>'.format(item.shortcut):'');if(item.note)tmp+='<div class="ui-menu-note">{0}</div>'.format(item.note);builder.push('<li class="{0}" data-index="{2}">{1}</li>'.format(cn,tmp,(index!=null?(index+'-'):'')+i))}return builder.join('')};self.show=function(opt){if(typeof(opt)==='string'){opt={align:opt};opt.element=arguments[1];opt.items=arguments[2];opt.callback=arguments[3];opt.offsetX=arguments[4];opt.offsetY=arguments[5]}var tmp=opt.element?opt.element instanceof jQuery?opt.element[0]:opt.element.element?opt.element.dom:opt.element:null;if(is&&tmp&&self.target===tmp){self.hide();return}var tmp;self.target=tmp;self.opt=opt;opt.scope=M.scope();var c=opt.classname||opt.class;if(parentclass&&c!==parentclass){self.rclass(parentclass);parentclass=null}self.tclass('ui-large',opt.large==true);if(!opt.nomobile){self.find('{0}'.format(cls2)).aclass('{0}-mobile'.format(cls))}issubmenu=false;prevsub=null;var css={};children.aclass('hidden');children.find('ul').empty();ul.html(self.makehtml(opt.items));if(!parentclass&&c){self.aclass(c);parentclass=c}if(is){css.left=0;css.top=0;container.css(css)}else{self.rclass('hidden');self.aclass(cls+'-visible',100);is=true;if(!events.is)self.bindevents()}var target=$(opt.element);var plusW=opt.offsetWidth||0;if(opt.fixedwidth){var tmpw=target.width()+plusW;container.css({'max-width':tmpw,width:tmpw});plusW=0}else container.css({'max-width':'',width:''});var w=container.width();var offset=target.offset();if(opt.element){switch(opt.align){case'center':css.left=Math.ceil((offset.left-w/2)+(target.innerWidth()/2));break;case'right':css.left=(offset.left-w)+target.innerWidth();break;default:css.left=offset.left;break}css.top=opt.position==='bottom'?(offset.top-container.height()-10):(offset.top+target.innerHeight()+10)}else{css.left=opt.x;css.top=opt.y}if(opt.position==='bottom')css.top+=10;else css.top-=10;if(opt.offsetX)css.left+=opt.offsetX;if(opt.offsetY)css.top+=opt.offsetY;var mw=w,mh=container.height();if(css.left<0)css.left=10;else if((mw+css.left)>WW)css.left=(WW-mw)-10;if(css.top<0)css.top=10;else if((mh+css.top)>WH)css.top=(WH-mh)-10;container.css(css)};self.hide=function(){events.is&&self.unbindevents();is=false;self.opt&&self.opt.hide&&self.opt.hide();self.target=null;self.opt=null;self.aclass('hidden');self.rclass(cls+'-visible')}});

COMPONENT('message','button:OK;style:2',function(self,config,cls){var cls2='.'+cls,is,events={};self.readonly();self.singleton();self.nocompile&&self.nocompile();self.make=function(){var pls=(config.style===2?(' '+cls+'2'):'');self.aclass(cls+' hidden'+pls);if(config.closeoutside)self.event('click',function(e){var node=e.target,skip={SPAN:1,A:1,I:1};if(!skip[node.tagName])self.hide()});else self.event('click','button',self.hide)};events.keyup=function(e){if(e.which===27)self.hide()};events.bind=function(){if(!events.is){$(W).on('keyup',events.keyup);events.is=false}};events.unbind=function(){if(events.is){events.is=false;$(W).off('keyup',events.keyup)}};self.warning=function(message,icon,fn){if(typeof(icon)==='function'){fn=icon;icon=undefined}if(message instanceof Array){var builder=[];for(var i=0;i<message.length;i++){var err=message[i].error;err&&builder.push(err)}message=builder.join('<br />')}self.callback=fn;self.content(cls+'-warning',message,icon||'warning')};self.info=function(message,icon,fn){if(typeof(icon)==='function'){fn=icon;icon=undefined}if(message instanceof Array){var builder=[];for(var i=0;i<message.length;i++){var err=message[i].error;err&&builder.push(err)}message=builder.join('<br />')}self.callback=fn;self.content(cls+'-info',message,icon||'info-circle')};self.success=function(message,icon,fn){if(typeof(icon)==='function'){fn=icon;icon=undefined}self.callback=fn;self.content(cls+'-success',message,icon||'check-circle')};self.response=function(message,callback,response){var fn;if(typeof(message)==='function'){response=callback;fn=message;message=null}else if(typeof(callback)==='function')fn=callback;else{response=callback;fn=null}if(response instanceof Array){var builder=[];for(var i=0;i<response.length;i++){var err=response[i].error;err&&builder.push(err)}self.warning(builder.join('<br />'));SETTER('!loading/hide')}else if(typeof(response)==='string'){self.warning(response);SETTER('!loading/hide')}else{if(message){if(message.length<40&&message.charAt(0)==='?')SET(message,response);else self.success(message)}if(typeof(fn)==='string')SET(fn,response);else if(fn)fn(response)}};self.hide=function(){events.unbind();self.callback&&self.callback();self.aclass('hidden')};self.content=function(classname,text,icon){if(icon.indexOf(' ')===-1)icon='ti ti-'+icon;!is&&self.html('<div><div class="{0}-icon"><i class="{1}"></i></div><div class="{0}-body"><div class="{0}-text"></div><hr /><button>{2}</button></div></div>'.format(cls,icon,config.button));self.rclass2(cls+'-').aclass(classname);self.find(cls2+'-body').rclass().aclass(cls+'-body');is&&self.find(cls2+'-icon').find('.ti').rclass2('ti').aclass(icon);self.find(cls2+'-text').html(text);self.rclass('hidden');self.element.focus();is=true;events.bind();document.activeElement&&document.activeElement.blur();setTimeout(function(){self.aclass(cls+'-visible');setTimeout(function(){self.find(cls2+'-icon').aclass(cls+'-icon-animate');document.activeElement&&document.activeElement.blur()},300)},100)}});

COMPONENT('miniform','zindex:12',function(self,config,cls){var cls2='.'+cls,csspos={};if(!W.$$miniform){W.$$miniform_level=W.$$miniform_level||1;W.$$miniform=true;$(document).on('click',cls2+'-button-close',function(){SET($(this).attrd('path'),'')});var resize=function(){setTimeout2(self.name,function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='miniform'&&!HIDDEN(com.dom)&&com.$ready&&!com.$removed)com.resize()}},200)};ON('resize2',resize);$(document).on('click',cls2+'-container',function(e){if(e.target===this){var com=$(this).component();if(com&&com.config.closeoutside){com.set('');return}}var el=$(e.target);if(el.hclass(cls+'-container-cell')){var form=$(this).find(cls2);var c=cls+'-animate-click';form.aclass(c).rclass(c,300);var com=el.parent().component();if(com&&com.config.closeoutside)com.set('')}})}self.readonly();self.submit=function(){if(config.submit)self.EXEC(config.submit,self.hide,self.element);else self.hide()};self.cancel=function(){if(config.cancel)self.EXEC(config.cancel,self.hide);else self.hide()};self.hide=function(){config.close&&self.EXEC(config.close);if(config.independent)self.hideforce();self.esc(false);self.set('')};self.esc=function(bind){if(bind){if(!self.$esc){self.$esc=true;$(W).on('keydown',self.esc_keydown)}}else{if(self.$esc){self.$esc=false;$(W).off('keydown',self.esc_keydown)}}};self.esc_keydown=function(e){if(e.which===27&&!e.isPropagationStopped()){var val=self.get();if(!val||config.if===val){e.preventDefault();e.stopPropagation();self.hide()}}};self.hideforce=function(){if(!self.hclass('hidden')){self.aclass('hidden');self.release(true);self.find(cls2).rclass(cls+'-animate');W.$$miniform_level--}};self.resize=function(){if(!config.center||self.hclass('hidden'))return;var ui=self.find(cls2);var fh=ui.innerHeight();var wh=WH,r=(wh/2)-(fh/2);csspos.marginTop=(r>30?(r-15):20)+'px';ui.css(csspos)};self.make=function(){$(document.body).append('<div id="{0}" class="hidden {4}-container invisible"><div class="{4}-container-table"><div class="{4}-container-cell"><div class="{4}" style="max-width:{1}px"><div class="{4}-title"><button name="cancel" class="{4}-button-close{3}" data-path="{2}"><i class="ti ti-times"></i></button><i class="{4}-icon hidden"></i><span></span></div></div></div></div>'.format(self.ID,config.width||800,self.path,config.closebutton==false?' hidden':'',cls));var scr=self.find('> script');self.template=scr.length?scr.html().trim():'';if(scr.length)scr.remove();var el=$('#'+self.ID);var body=el.find(cls2)[0];while(self.dom.children.length)body.appendChild(self.dom.children[0]);self.rclass('hidden invisible');var csscls=self.attr('class');csscls&&el.aclass(csscls);self.replace(el,true);self.event('scroll',function(){EMIT('scroll',self.name);EMIT('reflow',self.name)});self.event('click','button[name]',function(){var t=this;switch(t.name){case'submit':self.submit(self.hide);break;case'cancel':!t.disabled&&self[t.name](self.hide);break}});config.enter&&self.event('keydown','input',function(e){e.which===13&&!self.find('button[name="submit"]')[0].disabled&&setTimeout2(self.ID+'enter',self.submit,500)})};self.configure=function(key,value,init,prev){switch(key){case'title':self.find(cls2+'-title > span').text(value);break;case'icon':var icon=self.find(cls2+'-icon');icon.rclass2('fa ti');if(value)icon.aclass(self.faicon(value)).rclass('hidden');else icon.aclass('hidden');break;case'width':!init&&value!==prev&&self.find(cls2).css('max-width',value+'px');break;case'closebutton':!init&&self.find(cls2+'-button-close').tclass('hidden',value!==true);break}};self.setter=function(value){setTimeout2(cls+'-noscroll',function(){$('html').tclass(cls+'-noscroll',!!$(cls2+'-container').not('.hidden').length)},50);var isHidden=value!==config.if;if(self.hclass('hidden')===isHidden){if(!isHidden){config.reload&&self.EXEC(config.reload,self);config.default&&DEFAULT(self.makepath(config.default),true)}return}setTimeout2(cls,function(){EMIT('reflow',self.name)},10);if(isHidden){if(!config.independent)self.hideforce();return}if(self.template){var is=self.template.COMPILABLE();self.find(cls2).append(self.template);self.template=null;is&&COMPILE()}if(W.$$miniform_level<1)W.$$miniform_level=1;W.$$miniform_level++;self.css('z-index',W.$$miniform_level*config.zindex);self.rclass('hidden');self.resize();self.release(false);config.reload&&self.EXEC(config.reload,self);config.default&&DEFAULT(self.makepath(config.default),true);setTimeout(function(){self.rclass('invisible');self.find(cls2).aclass(cls+'-animate');config.autofocus&&self.autofocus(config.autofocus)},200);setTimeout2(self.ID,function(){self.css('z-index',(W.$$miniform_level*config.zindex)+1)},400);config.closeesc&&self.esc(true)}});

COMPONENT('noscrollbar','margin:0;invisible:1;delay:100;initdelay:250',function(self,config,cls){var container,init=false,cache='',scrolltoforce;self.readonly();self.init=function(){var resize=function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='noscrollbar'&&com.dom.offsetParent&&com.$ready&&!com.$removed)com.resizeforce()}};ON('resize2',function(){setTimeout2('noscrollbarresize',resize,200)})};self.configure=function(key,value,init){switch(key){case'minheight':case'margin':case'marginxs':case'marginsm':case'marginmd':case'marginlg':!init&&self.resizeforce();break}};self.scrollbottom=function(val){if(val==null)return self.dom.scrollTop;if(container)self.dom.scrollTop=self.dom.scrollHeight-container.height()-(val||0);return self.dom.scrollTop};self.scrolltop=function(val){if(val==null)return self.dom.scrollTop;self.dom.scrollTop=(val||0);return self.dom.scrollTop};self.make=function(){self.aclass('noscrollbar '+cls);self.css('overflow','auto');config.invisible&&self.aclass('invisible');self.resize()};self.resize=function(){setTimeout2(self.ID,self.resizeforce,200)};self.resizeforce=function(){var el=self.parent(config.parent);var h=el.height();var width=WIDTH();container=el;var key=width+'x'+h+'x'+config.margin;if(cache===key){if(scrolltoforce){if(scrolltoforce==='bottom')self.scrollbottom(0);else self.scrolltop(0);scrolltoforce=null}return}cache=key;var margin=config.margin,responsivemargin=config['margin'+width];if(responsivemargin!=null)margin=responsivemargin;if(margin==='auto')margin=self.element.offset().top;if(h===0){self.$waiting&&clearTimeout(self.$waiting);self.$waiting=setTimeout(self.resize,234);return}if(margin)h-=margin;if(config.minheight&&h<config.minheight)h=config.minheight;self.css('height',h);self.element.SETTER('*','resize');var c=cls+'-hidden';self.hclass(c)&&self.rclass(c,100);if(scrolltoforce){if(scrolltoforce==='bottom')self.scrollbottom(0);else self.scrolltop(0);scrolltoforce=null}if(!init){self.rclass('invisible',config.initdelay);init=true}};self.setter=function(){scrolltoforce=config.scrollto||config.scrolltop;if(scrolltoforce){if(scrolltoforce==='bottom'){if(container){self.scrollbottom(0);scrolltoforce=null}}else{self.scrolltop(0);scrolltoforce=null}}setTimeout(self.resize,config.delay,scrolltoforce)}});

COMPONENT('notify','timeout:3000;position:top-right',function(self,config,cls){var cls2='.'+cls,istop=false,autoclosing;self.singleton();self.readonly();self.nocompile();self.template=Tangular.compile('<div class="{0} {0}-{{ type}} {0}-hidden" data-id="{{ id}}"><figure><div class="{0}-dot"></div><div class="{0}-icon"><i class="ti {{ icon}}"></i></div><div class="{0}-message">{{ message | raw}}</div></figure></div>'.format(cls));self.items={};self.make=function(){self.aclass(cls+'-container');self.event('click',cls2,function(){var el=$(this);self.close(el.attrd('id'));clearTimeout(autoclosing);autoclosing=null;self.autoclose()})};self.configure=function(key,value){if(key==='position'){var c=cls+'-container-';self.rclass2(c).aclass(c+value.replace(/_|\s/,'-'));istop=value.indexOf('top')!==-1}};self.close=function(id){var obj=self.items[id];if(obj){delete self.items[id];var item=self.find('div[data-id="{0}"]'.format(id));item.find('figure').empty();item.animate({height:0},300,function(){item.remove()})}};self.response=function(message,callback,response){var fn;if(typeof(message)==='function'){response=callback;fn=message;message=null}else if(typeof(callback)==='function')fn=callback;else{response=callback;fn=null}if(response instanceof Array){var builder=[];for(var i=0;i<response.length;i++){var err=response[i].error;err&&builder.push(err)}self.append(builder.join('<br />'),2);SETTER('!loading/hide')}else if(typeof(response)==='string'){self.append(response,2);SETTER('!loading/hide')}else{if(message){if(message.length<40&&message.charAt(0)==='?')SET(message,response);else self.append(message,1)}if(typeof(fn)==='string')SET(fn,response);else if(fn)fn(response)}};self.warning=function(message){self.append(message,2)};self.success=function(message){self.append(message,1)};self.info=function(message){self.append(message,3)};self.append=function(message,type){if(!type)type=1;switch(type){case'success':type=1;break;case'warning':type=2;break;case'info':type=3;break}var icon;if(message.charAt(0)==='"'){var index=message.indexOf('"',1);icon=self.faicon(message.substring(1,index).trim());message=message.substring(index+1).trim()}var obj={id:Math.floor(Math.random()*100000).toString(36),message:message,type:type,icon:icon||(type===1?'ti-check-circle':type===2?'ti-times-circle':'ti-info-circle')};self.items[obj.id]=obj;var el=$(self.template(obj));if(istop)self.element.append(el);else self.element.prepend(el);self.autoclose();setTimeout(function(){el.rclass(cls+'-hidden')},20)};self.autoclose=function(){if(autoclosing)return;autoclosing=setTimeout(function(){clearTimeout(autoclosing);autoclosing=null;var el=self.find(cls2);el.length>1&&self.autoclose();el.length&&self.close(el.eq(istop?0:(el.length-1)).attrd('id'))},config.timeout)}});

COMPONENT('notifybar','timeout:5000',function(self,config,cls){self.singleton();self.readonly();self.nocompile&&self.nocompile();self.history=[];var cls2='.'+cls,body,buttons,prevtype,timeout,currentindex=0;self.make=function(){self.aclass(cls+' hidden');self.append('<div class="{0}-controls"><button name="prev" disabled><i class="ti ti-angle-left"></i></button><button name="next" disabled><i class="ti ti-angle-right"></i></button></div><div class="{0}-body">OK</div>'.format(cls));self.event('click',cls2+'-body',self.hide);self.event('click','button',function(){self[this.name]()});body=self.find(cls2+'-body');buttons=self.find('button')};self.hide=function(){self.aclass('hidden')};self.next=function(){currentindex++;self.draw(config.timeout*2)};self.prev=function(){currentindex--;self.draw(config.timeout*2)};self.show=function(){currentindex=self.history.length-1;if(currentindex>=0){self.draw(config.timeout);self.check()}};self.draw=function(delay){prevtype&&self.rclass(cls+'-'+prevtype);var msg=self.history[currentindex];if(msg.body.indexOf('ti-')===-1)msg.body='<i class="ti ti-'+(msg.type===1?'check-circle':msg.type===2?'warning':'info-circle')+'"></i>'+msg.body;body.html(msg.body);buttons[0].disabled=!self.history.length||currentindex===0;buttons[1].disabled=!self.history.length||currentindex>=(self.history.length-1);prevtype=msg.type;self.aclass(cls+'-'+prevtype);self.rclass('hidden');timeout&&clearTimeout(timeout);timeout=setTimeout(self.hide,delay)};self.success=function(body){currentindex=self.history.push({type:1,body:body})-1;self.draw(config.timeout);self.check()};self.warning=function(body){currentindex=self.history.push({type:2,body:body})-1;self.draw(config.timeout);self.check()};self.response=function(message,callback,response){var fn;if(typeof(message)==='function'){response=callback;fn=message;message=null}else if(typeof(callback)==='function')fn=callback;else{response=callback;fn=null}if(response instanceof Array){var builder=[];for(var i=0;i<response.length;i++){var err=response[i].error;err&&builder.push(err)}self.warning(builder.join('<br />'))}else if(typeof(response)==='string')self.warning(response);else{if(message){if(message.length<40&&message.charAt(0)==='?')SET(message,response);else self.success(message)}if(typeof(fn)==='string')SET(fn,response);else if(fn)fn(response)}};self.info=function(body){currentindex=self.history.push({type:3,body:body})-1;self.draw(config.timeout);self.check()};self.check=function(){if(self.history.length>20)self.history.unshift()}});

COMPONENT('objecttree','copydata:Copy data;copypath:Copy path',function(self,config,cls){var cls2='.'+cls,tmpl_expand='<i class="ti ti-chevron-down"></i>',tmpl_toolbox='<div class="toolbox"><i class="ti ti-copy" title="{copydata}"></i><i class="ti ti-link" title="{copypath}"></i></div>'.arg(config);var tmpl_beg='<div class="CLS-item" data-path="{0}" title="{0}"><div class="CLS-item-key"><span class="CLS-key {1}">{2}</span>{4}{3}<span class="dots hidden"> ...</span>{5}</div>'.replace(/CLS/g,cls);var tmpl_end='<div>{0}{1}</div></div>',tmpl_simple='<div class="CLS-item CLS-item-key" data-path="{0}" title="{0}"><span class="CLS-key mr5">"{1}":</span><span class="CLS-{2} mr5">{3}</span>{4}</div>'.replace(/CLS/g,cls);var data;const get=(obj,path)=>path.split(".").reduce((r,k)=>r?.[k],obj);self.readonly();self.make=function(){self.aclass(cls);self.event('click','i.ti-chevron-down',function(){var el=$(this);el.tclass('ti-rotate-270');el.parent().find('.dots').tclass('hidden');el.closest(cls2+'-item').find('> div'+cls2+'-item').tclass('hidden')});self.event('click','.toolbox i',function(){var el=$(this);var ispath=el.hclass('ti-link');var path=el.closest(cls2+'-item').attrd('path');var data2;data2=ispath?path:get(data,path);navigator.clipboard.writeText(ispath?data2:STRINGIFY(data2)).catch(e=>{});config.exec&&self.EXEC(config.exec,ispath?'path':'data',data2)})};self.setter=function(value){if(!value||typeof value!=='object'){self.html(value);return}data=value;var isArr=value instanceof Array,html=('<div class="" data-path="{0}" title="{0}"><div><span class="'+cls+'-key {1}"></span>{2}</div>').format('','',isArr?'[':'{');html+=isArr?self.treeArray(value,'',0):self.tree(value,'',0);html+=tmpl_end.format(isArr?']':'}');self.html(html)};self.tree=function(obj,path,indent){var isArr=obj instanceof Array,keys=Object.keys(obj);var kl=keys.length;if((isArr&&!obj.length)||!kl)return'';var temp='';indent++;for(var i=0;i<kl;i++){var isNum=!isNaN(keys[i]);var p=path+(path===''?path:'.')+keys[i];var item=obj[keys[i]],type=item instanceof Array?'array':item instanceof Date?'date':typeof(item);if(item==null)type='null';var length=type==='array'?item.length:type==='object'?Object.keys(item).length:0;var last=i===(kl-1);if(type==='array'&&length){temp+=tmpl_beg.format(p,'mr5','"{0}":'.format(keys[i]),'[',length>0?tmpl_expand:'',tmpl_toolbox);temp+=self.treeArray(item,p,indent+1);temp+=tmpl_end.format(']',last?'':',')}else if(type==='object'&&length){temp+=tmpl_beg.format(p,'mr5','"{0}":'.format(keys[i]),'{',length>0?tmpl_expand:'',tmpl_toolbox);temp+=self.tree(item,p,indent);temp+=tmpl_end.format('}',last?'':',')}else temp+=tmpl_simple.format(p,keys[i],type,simpleformat(type,item),tmpl_toolbox)}return temp};self.treeArray=function(arr,path,indent){var tmp='';for(let i=0;i<arr.length;i++){var item=arr[i],type=item instanceof Array?'array':item instanceof Date?'date':typeof(item);if(item==null)type='null';var value='',path2=path+(path===''?path:'.')+i;var last=i===(arr.length-1);switch(type){case'array':value+=tmpl_beg.format(path2,'mr5','','[',tmpl_expand,tmpl_toolbox);value+=self.treeArray(item,path2,indent);value+=tmpl_end.format(']',last?'':',');break;case'object':value+=tmpl_beg.format(path2,'mr5','','{',tmpl_expand,tmpl_toolbox);value+=self.tree(item,path2,indent);value+=tmpl_end.format('}',last?'':',');break;default:value='<div class="{5}-item {5}-item-key" data-path="{0}" title="{0}"><span class="{5}-key mr5"></span><span class="{5}-{1} mr5">{2}</span>{3}{4}</div>'.format(path2,type,simpleformat(type,item),last?'':',',tmpl_toolbox,cls)}tmp+=value}return tmp};function simpleformat(type,val){var value;switch(type){case'date':value=val;break;case'string':value='"'+val+'"';break;case'null':value='null';break;case'array':value='[]';break;case'object':value='{}';break;default:value=val}return value}});

COMPONENT('page','hide:1;loading:1;delay:500;delayloading:800',function(self,config,cls){var init=false,clid=null,downloading=false,isresizing=false,cache={};self.releasemode&&self.releasemode('true');self.readonly();self.make=function(){self.aclass(cls)};self.resize=function(){if(config.absolute){var pos=self.element.position();var obj={};obj.width=WW-pos.left;obj.height=WH-pos.top;self.css(obj)}};var replace=function(value){return value.replace(/\?/g,config.path||config.if)};self.setter=function(value){if(cache[value]){if(downloading)return;if(config.absolute&&!isresizing){self.on('resize2',self.resize);isresizing=true}if(self.dom.hasChildNodes()){if(clid){clearTimeout(clid);clid=null}self.release(false);var done=function(){config.hide&&self.rclass('hidden');config.reload&&EXEC(replace(config.reload));config.default&&DEFAULT(replace(config.default),true);var invisible=self.hclass('invisible');invisible&&self.rclass('invisible',config.delay);isresizing&&setTimeout(self.resize,50);setTimeout(self.emitresize,200);config.autofocus&&self.autofocus(config.autofocus)};if(config.check)EXEC(replace(config.check),done);else done()}else{config.loading&&SETTER('loading/show');downloading=true;setTimeout(function(){var preparator;if(config.replace)preparator=GET(replace(config.replace));else{preparator=function(content){var path=replace(config.path||config.if);return ADAPT(path,config.id,content)}}self.import(replace(config.url),function(){if(!init){config.init&&EXEC(replace(config.init));init=true}var done=function(){config.hide&&self.rclass('hidden');self.release(false);config.reload&&EXEC(replace(config.reload),true);config.default&&DEFAULT(replace(config.default),true);config.loading&&SETTER('loading/hide',config.delayloading);var invisible=self.hclass('invisible');invisible&&self.rclass('invisible',config.delay);isresizing&&setTimeout(self.resize,50);setTimeout(self.emitresize,200);downloading=false;config.autofocus&&self.autofocus(config.autofocus)};EMIT('pages.'+config.if,self.element,self);if(config.check)EXEC(replace(config.check),done);else done()},true,preparator)},200)}}else{if(!self.hclass('hidden')){config.hidden&&EXEC(replace(config.hidden));config.hide&&self.aclass('hidden'+(config.invisible?' invisible':''));self.release(true)}if(config.cleaner&&init&&!clid)clid=setTimeout(self.clean,config.cleaner*60000)}};self.emitresize=function(){self.element.SETTER('*','resize')};self.configure=function(key,value){switch(key){case'if':var tmp=(value+'').split(',').trim();cache={};for(var i=0;i<tmp.length;i++)cache[tmp[i]]=1;break;case'absolute':var is=!!value;self.tclass(cls+'-absolute',is);break}};self.clean=function(){if(self.hclass('hidden')){config.clean&&EXEC(replace(config.clean));setTimeout(function(){self.empty();init=false;clid=null;setTimeout(FREE,1000)},1000)}}});

COMPONENT('part','hide:1;loading:1;delay:500;delayloading:800',function(self,config,cls){var init=false,clid=null,downloading=false,isresizing=false,cache={};self.releasemode&&self.releasemode('true');self.readonly();self.make=function(){self.aclass(cls)};self.resize=function(){if(config.absolute){var pos=self.element.position();var obj={};obj.width=WW-pos.left;obj.height=WH-pos.top;self.css(obj)}};var replace=function(value){return value.replace(/\?/g,config.path||config.if)};self.setter=function(value){if(cache[value]){if(downloading)return;if(config.absolute&&!isresizing){self.on('resize2',self.resize);isresizing=true}if(self.dom.hasChildNodes()){if(clid){clearTimeout(clid);clid=null}self.release(false);var done=function(){config.hide&&self.rclass('hidden');config.reload&&EXEC(replace(config.reload));config.default&&DEFAULT(replace(config.default),true);var invisible=self.hclass('invisible');invisible&&self.rclass('invisible',config.delay);isresizing&&setTimeout(self.resize,50);setTimeout(self.emitresize,200);config.autofocus&&self.autofocus(config.autofocus)};if(config.check)EXEC(replace(config.check),done);else done()}else{config.loading&&SETTER('loading/show');downloading=true;setTimeout(function(){var preparator;if(config.replace)preparator=GET(replace(config.replace));else{preparator=function(content){var path=replace(config.path||config.if);return ADAPT(path,config.id,content.replace(/~PATH~/g,path))}}self.import(replace(config.url),function(){if(!init){config.init&&EXEC(replace(config.init));init=true}var done=function(){config.hide&&self.rclass('hidden');self.release(false);config.reload&&EXEC(replace(config.reload),true);config.default&&DEFAULT(replace(config.default),true);config.loading&&SETTER('loading/hide',config.delayloading);isresizing&&self.resize();self.hclass('invisible')&&self.rclass('invisible',config.delay);setTimeout(self.emitresize,200);downloading=false;config.autofocus&&self.autofocus(config.autofocus)};EMIT('parts.'+config.if,self.element,self);if(config.check)EXEC(replace(config.check),done);else done()},true,preparator)},200)}}else{if(!self.hclass('hidden')){config.hidden&&EXEC(replace(config.hidden));config.hide&&self.aclass('hidden'+(config.invisible?' invisible':''));self.release(true)}if(config.cleaner&&init&&!clid)clid=setTimeout(self.clean,config.cleaner*60000)}};self.emitresize=function(){self.element.SETTER('*','resize')};self.configure=function(key,value){switch(key){case'if':var tmp=(value+'').split(',').trim();cache={};for(var i=0;i<tmp.length;i++)cache[tmp[i]]=1;break;case'absolute':var is=!!value;self.tclass(cls+'-absolute',is);break}};self.clean=function(){if(self.hclass('hidden')){config.clean&&EXEC(replace(config.clean));setTimeout(function(){self.empty();init=false;clid=null;setTimeout(FREE,1000)},1000)}}});

COMPONENT('parts','parent:auto;margin:0',function(self,config,cls){var skip=false,partw,parth;self.make=function(){self.aclass(cls);self.on('resize + resize2',self.resize)};var itemreplace=function(item,content){return ADAPT(item.path,item.id,content)};var itempath=function(item,path){return path.replace(/\?/g,item.scope||item.path||item.id||'?')};self.focus=function(id,fromsetter){var is=false,model=self.get();var classname=cls+'-focused',selected=model.findItem('id',id);if(fromsetter&&selected){if(selected.element.hclass(classname))return}var item=model.findItem('focused',true);if(item&&item.id!==id){is=true;item.focused=false;item.element.rclass(classname);item.blur&&self.EXEC(itempath(item,item.blur),item.element,item)}item=selected;if(item){if(!item.element.hclass(classname)){item.focused=true;item.element.aclass(classname);is=true}item.reload&&self.EXEC(itempath(item,item.reload),item.element,item);item.focus&&self.EXEC(itempath(item,item.focus),item.element,item)}if(is){skip=true;self.update(true)}};self.rename=function(id,name,icon){var model=self.get();var item=model.findItem('id',id);if(item){if(name)item.name=name;if(icon)item.icon=icon;skip=true;self.update(true)}};self.close=function(id){var model=self.get();if(id==null){for(var item of model)self.close(item.id);return}var item=model.findItem('id',id);if(item){var index=model.indexOf(item);model.splice(index,1);if(item.focused){var next=model[index];if(!next)next=model[0];next&&setTimeout(self.focus,5,next.id)}skip=true;self.update(true);item.remove&&self.EXEC(itempath(item,item.remove),item.element,item);item.element.remove();setTimeout2(self.ID+'free',FREE,1000)}};self.create=function(item){if(item.processed)return;item.processed=true;var div=$('<div></div>');div.aclass(cls+'-item invisible');div.attrd('id',item.id);if(item.attr){for(var key in item.attr)div.attr(key,item.attr[key])}if(item.attrd){for(var key in item.attrd)div.attrd(key,item.attrd[key])}if(parth||partw)div.css({width:partw,height:parth});if(item.import){IMPORT(item.import,div,function(){item.init&&self.EXEC(itempath(item,item.init),div,item);setTimeout2(self.ID+'focus',self.focus,100,null,item.id);div.rclass('invisible',item.delay||10);item.import=null},true,function(content){return itemreplace(item,content)})}else if(div.html){div.append(itemreplace(item,item.html));item.html.COMPILABLE()&&setTimeout(COMPILE,1,div)}div[0].$part=item;item.element=div;config.create&&self.EXEC(config.create,item);self.append(div);if(!item.import){setTimeout2(self.ID+'focus',self.focus,100,null,item.id);div.rclass('invisible',item.delay||10);item.init&&self.EXEC(true,itempath(item,item.init),div,item)}};self.resize=function(){setTimeout2(self.ID,self.resizeforce,300)};self.resizeforce=function(){var parent=self.parent(config.parent);var w=parent.width();var h=parent.height()-config.margin;if(parth!==h||partw!==w){parth=h;partw=w;self.find('> div').css({width:w,height:h});self.element.SETTER('*/resize')}};self.setter=function(value){if(skip){skip=false;return}var model=value||EMPTYARRAY;for(var item of model){self.create(item);item.focused&&self.focus(item.id)}var div=self.find('> div').toArray();for(var i=0;i<div.length;i++){var el=$(div[i]);if(!model.findItem('id',el.attrd('id'))){var obj=div[i].$part;if(obj){obj.remove&&self.EXEC(itempath(obj,obj.remove),obj.element,obj);obj.element.remove()}}}self.resize()}});

COMPONENT('paste',function(self){self.readonly();self.singleton();self.blind();self.make=function(){$(W).on('paste',function(e){var text=(e.originalEvent.clipboardData||W.clipboardData).getData('text')||'';text&&EMIT('paste',text,e)})}});

COMPONENT('progress','animate:true',function(self,config,cls){var container,old=null;self.readonly();self.nocompile&&self.nocompile();self.make=function(){self.aclass(cls);self.append('<div style="width:10%">0%</div>');container=self.find('div')};self.setter=function(value){!value&&(value=0);if(old===value)return;if(value>100)value=100;else if(value<0)value=0;old=value>>0;if(config.animate)container.stop().animate({width:old+'%'},80).show();else container.css({width:old+'%'});container.html(old+'%')}});

COMPONENT('properties2','datetimeformat:yyyy-MM-dd HH:mm;dateformat:yyyy-MM-dd;timeformat:HH:mm;modalalign:center;style:1;validation:1;encodenotes:1;defaultgroup:Default',function(self,config,cls){var cls2='.'+cls,container,types={},paths={},skip=false,values,funcs,datasource,rendered=false;self.nocompile();self.validate=function(value){if(config.validation&&value){var arr=value instanceof Array?value:datasource;if(arr&&arr.length){for(var item of arr){if(item.invalid)return false}}}return true};self.make=function(){self.aclass(cls+(config.style===2?(' '+cls+'-2'):''));var scr=self.find('> script');datasource=scr.length?scr.html().trim():null;scr.remove();if(datasource){datasource=new Function('return '+datasource)();for(var i=0;i<datasource.length;i++)paths[datasource[i].name]=1}var elu=$('#properties2upload');if(!elu.length)$(document.body).append('<inp'+'ut type="file" id="prope'+'rties2upload" /'+'>');self.event('click',cls2+'-ricon',function(){var el=self.findel($(this));var index=+el.attrd('index');var arr=datasource||self.get();var item=index>=0?arr[index]:null;if(item&&item.riconclick){item.element=el;self.EXEC(item.riconclick,item,function(val){types[item.type].set(el,val,item)})}});self.append('<div><div class="{0}-container"></div></div>'.format(cls));container=self.find(cls2+'-container');for(var key in types)types[key].init&&types[key].init()};self.finditem=function(el){var index=+$(el).closest(cls2+'-item').attrd('index');var arr=datasource||self.get();return index>=0?arr[index]:null};self.findel=function(el){return $(el).closest(cls2+'-item')};self.modifyval=function(item){values[item.name]=item.value;var items=datasource||self.get();for(var i=0;i<items.length;i++){var m=items[i];if(m.show){var is=funcs[m.name+'_show'](values);self.find(cls2+'-item[data-index="{0}"]'.format(i)).tclass('hidden',!is)}}skip=true;if(datasource){self.get()[item.name]=item.value;UPD(self.path+'.'+item.name)}else UPD(self.path)};self.register=function(name,init,render){types[name]={};types[name].init=init;types[name].render=render;init(self)};types.string={};types.string.init=function(){self.event('click',cls2+'-tstring',function(){var el=$(this);if(!el.hclass('ui-disabled'))el.find('input').focus()});self.event('change','.pstring',function(){var t=this,item=self.finditem(t);var val=t.value.trim();switch(item.transform){case'uppercase':val=val.toUpperCase();t.value=val;break;case'lowercase':val=val.toLowerCase();t.value=val;break;case'capitalize':var tmp=val.split(' ');for(var i=0;i<tmp.length;i++)tmp[i]=tmp[i].substring(0,1).toUpperCase()+tmp[i].substring(1);t.value=tmp.join(' ');break;case'slug':val=val.slug();break}var isvalid=item.required?!!val:true;if(isvalid){if(typeof(item.validate)==='object'){isvalid=item.validate.test(val)}else{switch(item.validate){case'email':isvalid=val.isEmail();break;case'phone':isvalid=val.isPhone();break;case'url':isvalid=val.isURL();break}}}var el=self.findel(t);if(isvalid){item.value=val;item.changed=item.prev!==val;el.tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item);self.modifyval(item)}self.change(true);item.invalid=!isvalid;el.tclass(cls+'-invalid',item.invalid);t.$processed=true;item.required&&self.validate2()})};types.string.render=function(item,next){next('<div class="{0}-string{5}"><input type="text" maxlength="{1}" placeholder="{2}" value="{3}" class="pstring"{4} /></div>'.format(cls,item.maxlength,item.placeholder||'',Thelpers.encode(item.value),item.disabled?' disabled':'',item.camouflage?(' '+cls+'-camouflage'):''))};types.string.set=function(el,value){el.find('input').val(value==null?'':(value+''))};types.password={};types.password.init=function(){self.event('click',cls2+'-tpassword',function(){var el=$(this);if(!el.hclass('ui-disabled'))el.find('input').focus()});self.event('focus','.ppassword',function(){$(this).attr('type','text')});self.event('blur','.ppassword',function(){$(this).attr('type','password')});self.event('change','.ppassword',function(){var t=this,item=self.finditem(t);var val=t.value.trim();var isvalid=item.required?!!val:true;if(isvalid){if(typeof(item.validate)==='object')isvalid=item.validate.test(val)}var el=self.findel(t);if(isvalid){item.value=val;item.changed=item.prev!==val;el.tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item);self.modifyval(item)}item.invalid=!isvalid;el.tclass(cls+'-invalid',item.invalid);t.$processed=true;self.change(true);item.required&&self.validate2()})};types.password.render=function(item,next){next('<div class="{0}-string"><input type="password" maxlength="{1}" placeholder="{2}" value="{3}" class="ppassword"{4} /></div>'.format(cls,item.maxlength,item.placeholder||'',Thelpers.encode(item.value),item.disabled?' disabled':''))};types.password.set=function(el,value){el.find('input').val(value==null?'':(value+''))};types.number={};types.number.init=function(){self.event('click',cls2+'-tnumber',function(){var el=$(this);if(!el.hclass('ui-disabled'))el.find('input').focus()});self.event('blur change','.pnumber',function(){var t=this;if(t.$processed)return;var item=self.finditem(t);var val=t.value.trim();if(!val&&item.value==null)return;var el=self.findel(t);var isvalid=true;val=val.parseFloat();if(item.min!=null&&val<item.min)isvalid=false;else if(item.max!=null&&val>item.max)isvalid=false;item.invalid=!isvalid;if(isvalid){t.value=val+'';item.value=val;item.changed=item.prev!==val;el.tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item);self.modifyval(item)}el.tclass(cls+'-invalid',item.invalid);t.$processed=true;self.change(true);item.required&&self.validate2()});self.event('keydown','.pnumber',function(e){var t=this;t.$processed=false;if(e.which===38||e.which===40){var num=t.value.parseFloat();var item=self.finditem(t);if(e.which===38)num+=item.inc||1;else if(e.which===40)num-=item.inc||1;t.value=num;e.preventDefault()}})};types.number.render=function(item,next){next('<div class="{0}-number"><input type="text" maxlength="{1}" placeholder="{2}" value="{3}" class="pnumber"{4} /></div>'.format(cls,20,item.placeholder||'',Thelpers.encode((item.value==null?'':item.value)+''),item.disabled?' disabled':''))};types.number.set=function(el,value){el.find('input').val(value==null?'':(value+''))};types.date={};types.date.init=function(){self.event('click',cls2+'-tdate',function(){var el=$(this);if(!el.hclass('ui-disabled'))el.find('input').focus()});self.event('blur change','.pdate',function(e){var t=this;if(e.type==='change')SETTER('!datepicker','hide');if(t.$processed)return;var item=self.finditem(t);var val=t.value.parseDate(config.dateformat);item.value=val;item.changed=!item.prev||item.prev.format(config.dateformat)!==val.format(config.dateformat);self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){t.value=val});self.modifyval(item);self.change(true);item.required&&self.validate2();t.$processed=true});self.event('keydown','.pdate',function(e){var t=this;t.$processed=false;if((e.which===38||e.which===40)&&t.value){var val=t.value.parseDate(config.dateformat);var item=self.finditem(t);val=val.add((e.which===40?'-':'')+(item.inc||'1 day'));t.value=val.format(config.dateformat);e.preventDefault()}});self.event('click','.pdate',function(){var t=this,el=$(t);var opt={},item=self.finditem(t);opt.element=el.closest(cls2+'-date').find('input');opt.value=item.value;opt.callback=function(value){t.$processed=false;t.value=value.format(config.dateformat);el.trigger('change')};SETTER('datepicker','show',opt)})};types.date.render=function(item,next){next('<div class="{0}-date"><i class="ti ti-calendar pdate"></i><div><input type="text" maxlength="{1}" placeholder="{2}" value="{3}" class="pdate" /></div></div>'.format(cls,config.dateformat.length,item.placeholder||'',item.value?item.value.format(config.dateformat):''))};types.date.set=function(el,value){el.find('input').val(value==null?'':(value instanceof Date?value.format(config.dateformat):(value+'')))};types.bool={};types.bool.init=function(){if(config.style===2){self.event('click',cls2+'-tbool',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-booltoggle').trigger('click')})}self.event('click',cls2+'-booltoggle',function(e){e.preventDefault();e.stopPropagation();var t=this,el=$(t);var item=self.finditem(t);if(item.disabled)return;el.tclass('checked');item.value=el.hclass('checked');item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item);self.modifyval(item);self.change(true);item.required&&self.validate2()})};types.bool.render=function(item,next){next('<div class="{0}-bool"><span class="{0}-booltoggle{1}"><i></i></span></div>'.format(cls,item.value?' checked':''))};types.bool.set=function(el,value){el.find(cls2+'-booltoggle').tclass('checked',!!value)};types.exec={};types.exec.init=function(){self.event('click',cls2+'-'+(config.style===2?'t':'')+'exec',function(){var t=this,el=$(t);var item=self.finditem(t);if(!item.disabled&&item.exec)self.EXEC(item.exec,item,el)})};types.exec.render=function(item,next){next('<div class="{0}-exec">{1}<i class="ti ti-angle-right"></i></div>'.format(cls,item.value?Thelpers.encode(item.value):''))};types.exec.set=NOOP;types.text={};types.text.render=function(item,next){next('<div class="{0}-text">{1}</div>'.format(cls,item.value?Thelpers.encode(item.value):''))};types.text.set=function(el,value){el.find(cls2+'-text').html(value?Thelpers.encode(value):'')};types.list={};types.list.init=function(){if(config.style===2){self.event('click',cls2+'-tlist',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-list').trigger('click')})}self.event('click',cls2+'-list',function(e){e.preventDefault();e.stopPropagation();var t=this,item=self.finditem(t);if(item.disabled)return;var opt={};opt.offsetY=-5;opt.element=$(t);opt.items=typeof(item.items)==='string'?item.items.indexOf('/')===-1?GET(self.makepath(item.items)):item.items:item.items;opt.custom=item.dircustom;opt.minwidth=80;if(item.dirsearch)opt.placeholder=item.dirsearch;else if(item.dirsearch==false)opt.search=false;opt.callback=function(value){if(typeof(value)==='string'){opt.element.find('span').text(value);item.value=value}else{opt.element.find('span').html(value[item.dirkey||'name']);item.value=value[item.dirvalue||'id']}if(item.dircustom&&item.dirappend!==false){if(!opt.items)opt.items=[];if(opt.items.indexOf(item.value)===-1)opt.items.push(item.value)}item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){opt.element.find('span').text(val)});self.modifyval(item);self.change(true);item.required&&self.validate2()};SETTER('directory','show',opt)})};types.list.render=function(item,next){var template='<div class="{0}-list">'+(config.style===2?'':'<i class="ti ti-chevron-down"></i>')+'<span>{1}</span></div>';if(item.detail){AJAX('GET '+item.detail.format(encodeURIComponent(item.value)),function(response){next(template.format(cls,response[item.dirkey||'name']||item.placeholder||DEF.empty))})}else{var arr=typeof(item.items)==='string'?GET(item.items):item.items;var m=(arr||EMPTYARRAY).findValue(item.dirvalue||'id',item.value,item.dirkey||'name',item.placeholder||DEF.empty);next(template.format(cls,m))}};types.list.set=function(el,value,item){var items=typeof(item.items)==='string'?item.items.indexOf('/')===-1?GET(self.makepath(item.items)):item.items:item.items;var val=items instanceof Array?items.findValue(item.dirvalue||'id',value,item.dirkey||'name'):'';el.find('span').text(val||DEF.empty)};types.menu={};types.menu.init=function(){if(config.style===2){self.event('click',cls2+'-tmenu',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-menu').trigger('click')})}self.event('click',cls2+'-menu',function(){var t=this,item=self.finditem(t);if(item.disabled)return;var opt={};if(config.style===2)opt.align='right';opt.offsetY=-5;opt.element=$(t);opt.items=typeof(item.items)==='string'?item.items.indexOf('/')===-1?GET(self.makepath(item.items)):item.items:item.items;opt.callback=function(value){if(typeof(value)==='string'){opt.element.find('span').text(value);item.value=value}else{opt.element.find('span').html(value[item.dirkey||'name']);item.value=value[item.dirvalue||'id']}if(item.dircustom&&item.dirappend!==false){if(!opt.items)opt.items=[];if(opt.items.indexOf(item.value)===-1)opt.items.push(item.value)}item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){opt.element.find('span').text(val)});self.modifyval(item);self.change(true);item.required&&self.validate2()};SETTER('menu','show',opt)})};types.menu.render=function(item,next){var template='<div class="{0}-menu">'+(config.style===2?'':'<i class="ti ti-chevron-down"></i>')+'<span>{1}</span></div>';if(item.detail){AJAX('GET '+item.detail.format(encodeURIComponent(item.value)),function(response){next(template.format(cls,response[item.dirkey||'name']||item.placeholder||DEF.empty))})}else{var arr=typeof(item.items)==='string'?GET(item.items):item.items;var m=(arr||EMPTYARRAY).findValue(item.dirvalue||'id',item.value,item.dirkey||'name',item.placeholder||DEF.empty);next(template.format(cls,m))}};types.menu.set=function(el,value,item){var items=typeof(item.items)==='string'?item.items.indexOf('/')===-1?GET(self.makepath(item.items)):item.items:item.items;var val=items instanceof Array?items.findValue(item.dirvalue||'id',value,item.dirkey||'name'):'';el.find('span').text(val)};types.color={};types.color.init=function(){if(config.style===2){self.event('click',cls2+'-tcolor',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-colortoggle').trigger('click')})}self.event('click',cls2+'-colortoggle',function(e){e.preventDefault();e.stopPropagation();var t=this,item=self.finditem(t);if(item.disabled)return;var opt={};opt.align=config.modalalign;opt.element=$(t);opt.callback=function(value){opt.element.find('b').css('background-color',value);item.value=value;item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){opt.element.find('b').css('background-color',val)});self.modifyval(item);self.change(true);item.required&&self.validate2()};SETTER('colorpicker','show',opt)})};types.color.render=function(item,next){next('<div class="{0}-color"><span class="{0}-colortoggle"><b{1}>&nbsp;</b></span></div>'.format(cls,item.value?(' style="background-color:'+item.value+'"'):''))};types.color.set=function(el,value){el.find('b').css('background-color',value||'')};types.fontawesome={};types.fontawesome.init=function(){if(config.style===2){self.event('click',cls2+'-tfontawesome',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-fontawesometoggle').trigger('click')})}self.event('click',cls2+'-fontawesometoggle',function(e){e.preventDefault();e.stopPropagation();var t=this,item=self.finditem(t);if(item.disabled)return;var opt={};opt.align=config.modalalign;opt.element=$(t);opt.callback=function(value){opt.element.find('i').rclass().aclass(value);item.value=value;item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){opt.element.find('i').rclass().aclass(val)});self.modifyval(item);self.change(true);item.required&&self.validate2()};SETTER('faicons','show',opt)})};types.fontawesome.render=function(item,next){next('<div class="{0}-fontawesome"><span class="{0}-fontawesometoggle"><i class="{1}"></i></span></div>'.format(cls,item.value||''))};types.fontawesome.set=function(el,value){el.find('i').rclass2('ti').aclass(value||'')};types.emoji={};types.emoji.init=function(){if(config.style===2){self.event('click',cls2+'-temoji',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-emojitoggle').trigger('click')})}self.event('click',cls2+'-emojitoggle',function(e){e.preventDefault();e.stopPropagation();var t=this,item=self.finditem(t);if(item.disabled)return;var opt={};opt.align=config.modalalign;opt.element=$(t);opt.callback=function(value){opt.element.html(value);item.value=value;item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){opt.element.html(val)});self.modifyval(item);self.change(true);item.required&&self.validate2()};SETTER('emoji','show',opt)})};types.emoji.render=function(item,next){next('<div class="{0}-emoji"><span class="{0}-emojitoggle">{1}</span></div>'.format(cls,item.value||DEF.empty))};types.emoji.set=function(el,value){el.find('span').html(value||DEF.empty)};types.file={};types.file.init=function(){if(config.style===2){self.event('click',cls2+'-tfile',function(e){e.stopPropagation();e.preventDefault();$(this).find(cls2+'-file').trigger('click')})}self.event('click',cls2+'-file',function(e){e.preventDefault();e.stopPropagation();var t=this,item=self.finditem(t);if(item.disabled)return;var file=$('#propertiesupload');if(item.accept)file.attr('accept',item.accept);else file.removeAttr('accept');file.off('change').on('change',function(){var file=this,data=new FormData();data.append('file',file.files[0]);SETTER('loading','show');UPLOAD(item.url,data,function(response){item.value=response;item.changed=item.prev!==item.value;self.findel(t).tclass(cls+'-changed',item.changed);config.change&&self.EXEC(config.change,item,function(val){self.findel(t).find(cls2+'-filename').text(val)});SETTER('loading','hide',1000);file.value='';self.modifyval(item);self.change(true);item.required&&self.validate2()})}).trigger('click')})};types.file.render=function(item,next){next('<div class="{0}-file"><i class="ti ti-folder"></i><span class="{0}-filename">{1}</span></div>'.format(cls,item.filename||item.value||DEF.empty))};self.render=function(item,index){var typename=item.type==='boolean'?'bool':item.type,type=types[typename],c=cls;if(item.show){if(!funcs[item.name+'_show'](values))c='hidden '+c}var meta={label:item.label,type:item.type};if(item.icon){var tmp=item.icon,color;tmp=tmp.replace(/#[a-f0-9]+/gi,function(text){color=text;return''}).trim();tmp=self.faicon(tmp);meta.icon=Tangular.render('<i class="{{ icon}}"{{ if color}} style="{{ type}}color:{{ color}}"{{ fi}}></i>',{icon:tmp,color:color,type:config.style===2?'background-':''})}else meta.icon='';var plus='';if(item.ricon)plus='<div class="{0}-ricon">{1}</div>'.format(cls,item.ricon.charAt(0)==='!'?item.ricon.substring(1):'<i class="{0}"></i>'.format(item.ricon));var el=$(('<div class="{2}-item{3} {2}-t{type}'+(item.required?' {2}-required':'')+(item.icon?' {2}-isicon':'')+(item.note?' {2}-isnote':'')+'" data-index="{1}">'+(config.style===2?'{{ icon}}<div>':'')+'<div class="{0}-key">'+(config.style===2?'':'{{ icon}}')+'{{ label}}</div>'+(config.style===2?(plus+'<div class="{0}-value">&nbsp;</div><div class="{0}-note">{1}</div>').format(cls,config.encodenotes?Thelpers.encode(item.note):item.note):(plus+'<div class="{0}-value">&nbsp;</div>'))+'</div>'+(config.style===2?'</div>':'')).format(cls,index,c,item.required?(' '+cls+'-required'):'').arg(meta));if(plus)el.aclass(cls+'-isricon');if(item.align)el.find(cls2+'-value').aclass(item.align);type.render(item,function(html){if(item.note&&config.style!==2)html+='<div class="{0}-note">{1}</div>'.format(cls,item.note);el.find(cls2+'-value').html(html);item.disabled&&el.aclass('ui-disabled')},el);return el};self.setter=function(value,path){var p=path.substring(self.path.length+1);if(skip||(p&&!paths[p])){skip=false;return}if(!value)value=EMPTYARRAY;var groups={},items=datasource||value,is=!datasource||!rendered;if(is)container.empty();values={};funcs={};for(var i=0;i<items.length;i++){var item=items[i],g=item.group||config.defaultgroup,val=datasource?value[item.name]:item.value;item.invalid=false;if(!groups[g])groups[g]={html:[]};switch(item.type){case'fontawesome':case'string':item.prev=val||'';break;case'date':item.prev=val?val.format(config.dateformat):null;break;default:item.prev=val;break}if(item.show&&is)funcs[item.name+'_show']=typeof(item.show)==='string'?FN(item.show):item.show;values[item.name]=val;if(item.required)item.invalid=!val;if(is){item.value=val;groups[g].html.push(self.render(item,i))}else{if(!item.element)item.element=self.find(cls2+'-item[data-index="{0}"]'.format(i));var typename=item.type==='boolean'?'bool':item.type;types[typename].set(item.element,val,item)}}if(is){for(var key in groups){var group=groups[key],hash='g'+HASH(key,true);var el=$('<div class="{0}-group" data-id="{2}"><label>{1}</label><section></section></div>'.format(cls,key,hash));var section=el.find('section');for(var j=0;j<group.html.length;j++)section.append(group.html[j]);container.append(el)}}if(!is){self.find(cls2+'-item').rclass(cls+'-invalid '+cls+'-changed');for(var i=0;i<items.length;i++){var item=items[i];if(item.show){var can=funcs[item.name+'_show'](values);self.find(cls2+'-item[data-index="{0}"]'.format(i)).tclass('hidden',!can)}}}self.validate2();rendered=true}});

COMPONENT('ready','delay:800',function(self,config){self.readonly();self.blind();self.make=function(){config.rclass&&self.rclass(config.rclass,config.adelay||config.delay);config.aclass&&self.aclass(config.aclass,config.rdelay||config.delay);self.rclass('invisible',config.adelay||config.delay);config.focus&&setTimeout(function(){self.autofocus(config.focus===true||config.focus===1?null:config.focus).focus()},config.fdelay||(config.delay+5))}});

COMPONENT('search','class:hidden;delay:50;attribute:data-search;splitwords:1;delaydatasource:100',function(self,config,cls){self.readonly();self.make=function(){config.datasource&&self.datasource(config.datasource,function(){setTimeout(function(){self.refresh()},config.delaydatasource)})};self.search=function(){var value=self.get();var elements=self.find(config.selector);var length=elements.length;if(!value){elements.rclass(config.class);self.rclass2(cls+'-');config.exec&&self.SEEX(config.exec,{hidden:0,count:length,total:length,search:'',is:false});return}var raw=value.trim();var search=raw.toSearch();var count=0,hidden=0,custom=config.custom?GET(self.makepath(config.custom)):null;if(config.splitwords){search=search.split(' ');raw=raw.split(' ')}self.aclass(cls+'-used');for(var i=0;i<length;i++){var el=elements.eq(i);var is=false;if(custom){is=!custom(el,search);el.tclass(config.class,is);if(is)hidden++;else count++;continue}var val=(el.attr(config.attribute)||'').trim();var fuzzy=val.toSearch();if(search instanceof Array){for(var j=0;j<raw.length;j++){if(val.indexOf(raw[j])===-1){is=true;break}}if(is){is=false;for(var j=0;j<search.length;j++){if(fuzzy.indexOf(search[j])===-1){is=true;break}}}}else is=fuzzy.indexOf(search)===-1&&val.indexOf(raw)===-1;el.tclass(config.class,is);if(is)hidden++;else count++}self.tclass(cls+'-empty',!count);config.exec&&self.SEEX(config.exec,{total:length,hidden:hidden,count:count,search:search,is:true})};self.setter=function(value){if(!config.selector||!config.attribute||value==null)return;setTimeout2('search'+self.ID,self.search,config.delay)}});

COMPONENT('searchinput','searchicon:ti ti-search;cancelicon:ti ti-times;align:left',function(self,config,cls){var input,icon,prev,prev2;self.novalidate();self.make=function(){self.aclass(cls+' '+cls+'-'+config.align);self.html('<span><i class="{0}"></i></span><div><input type="text" autocomplete="new-password" maxlength="100" placeholder="{1}" data-jc-bind /></div>'.format(config.searchicon,config.placeholder));input=self.find('input')[0];icon=self.find('i');self.event('click','span',function(){prev&&self.set('');prev2=''});config.autofocus&&self.autofocus()};self.focus=function(){input&&input.focus()};self.check=function(){var is=!!input.value.trim();if(is!==prev){icon.rclass().aclass(is?config.cancelicon:config.searchicon);prev=is;self.tclass(cls+'-is',is)}};self.clear=function(){input.value='';config.exec&&self.SEEX(config.exec,input.value,self.element);self.check()};self.setter=function(value,path,type){input.value=value||'';if(prev2!==input.value){prev2=input.value;type&&config.exec&&self.SEEX(config.exec,input.value,self.element)}self.check()}});

COMPONENT('selected','class:selected;selector:a;attr:if;attror:or;delay:50',function(self,config){self.readonly();var highlight=function(){var cls=config.class,val=self.get()||'';self.find(config.selector).each(function(){var el=$(this);var or=el.attrd(config.attror)||'';if(el.attrd(config.attr)===val||(or&&val.indexOf(or)!==-1))el.aclass(cls);else if(el.hclass(cls))el.rclass(cls)})};self.configure=function(key,value){switch(key){case'datasource':self.datasource(value,function(){setTimeout2(self.ID,highlight,config.delay)});break}};self.setter=function(){setTimeout2(self.ID,highlight,config.delay)}});

COMPONENT('selection','remember:1;key:id;class:selected;click:.selection;selector:.selection;attr:id;event:click;dblclickselectall:1',function(self,config,cls){var skip=false;self.make=function(){self.aclass(cls);self.event(config.event,config.click,function(e){e.preventDefault();e.stopPropagation();var el=$(this);if(config.click!==config.selector)el=el.find(config.selector);self.toggle(el)});if(config.dblclickselectall){self.event('dblclick',config.click,function(){self.selecttoggle()})}config.cancel&&self.watch(self.makepath(config.cancel),self.selectnone)};self.selectall=function(){var arr=self.find(config.selector);var sel=[];for(var i=0;i<arr.length;i++){var el=$(arr[i]);sel.push(el.attrd(config.attr));el.aclass(config.class)}skip=true;self.set(sel)};self.selectnone=function(){var model=self.get();if(model&&model.length){var arr=self.find(config.selector);for(var i=0;i<arr.length;i++){var el=$(arr[i]);el.rclass(config.class)}skip=true;self.set([])}};self.selecttoggle=function(){var arr=self.find(config.selector);var sel=[];for(var i=0;i<arr.length;i++){var el=$(arr[i]);if(el.hclass(config.class)){el.rclass(config.class)}else{sel.push(el.attrd(config.attr));el.aclass(config.class)}}skip=true;self.set(sel);self.change()};self.toggle=function(id){if(id instanceof jQuery)id=id.attrd(config.attr);var model=self.get();var added=false;if(model==null){model=[id];added=true;self.rewrite(model)}else{var index=model.indexOf(id);if(index===-1){model.push(id);added=true}else model.splice(index,1)}var el=self.find(config.selector+'[data-{0}="{1}"]'.format(config.attr,id));skip=true;el.tclass(config.class,added);self.update(true);self.change()};self.recalc=function(){var arr=self.find(config.selector);var model=self.get()||EMPTYARRAY;for(var i=0;i<arr.length;i++){var el=$(arr[i]);el.tclass(config.class,model.indexOf(el.attrd(config.attr))!==-1)}};var datasource=function(path,value){if(!config.remember){self.set([]);return}if(!value)value=EMPTYARRAY;var model=self.get()||EMPTYARRAY;var rem=[];for(var i=0;i<model.length;i++){var item=value.findItem(config.key,model[i]);if(!item)rem.push(model[i])}for(var i=0;i<rem.length;i++)model.splice(model.indexOf(rem[i]),1);self.update()};self.configure=function(key,value){if(key==='datasource')self.datasource(value,datasource)};self.setter=function(){if(skip)skip=false;else setTimeout2(self.ID,self.recalc,10)}});

COMPONENT('shortcuts',function(self){var items=[],length=0,keys={},keys_session={},issession=false;self.singleton();self.readonly();self.blind();self.nocompile&&self.nocompile();var cb=function(o,e){o.callback(e,o.owner)};self.make=function(){$(W).on('keydown',function(e){var f=e.key||'',c=e.keyCode;if(f.length>1&&f.charAt(0)==='F')c=0;else f='-';var key=(e.ctrlKey?1:0)+''+(e.altKey?1:0)+''+(e.shiftKey?1:0)+''+(e.metaKey?1:0)+f+c;if(issession){if(!keys_session[key])return}else{if(!keys[key])return}if(length&&!e.isPropagationStopped()){for(var i=0;i<length;i++){var o=items[i];if(o.fn(e)){if(o.prepare&&!o.prepare(e,e.target))continue;if(o.prevent){e.preventDefault();e.stopPropagation()}setTimeout(cb,100,o,e);return}}}});ON('component + knockknock',self.refresh)};self.refreshforce=function(){var arr=document.querySelectorAll('.shortcut');var index=0;while(true){var item=items[index++];if(item==null)break;if(item.owner){index--;items.splice(index,1)}}for(var i=0;i<arr.length;i++){var shortcut=arr[i].getAttribute('data-shortcut');shortcut&&self.register(shortcut,self.execshortcut,true,null,arr[i])}};self.session=function(callback){issession=true;keys_session={};callback(self.register)};self.end=function(){issession=false};self.execshortcut=function(e,owner){var evt=$.Event('click');evt.shortcutEvent=evt.shortcut=e;$(owner).trigger(evt)};self.refresh=function(){setTimeout2(self.ID,self.refreshforce,500)};self.exec=function(shortcut){var item=items.findItem('shortcut',shortcut.toLowerCase().replace(/\s/g,''));item&&item.callback(null,$(item.owner))};self.register=function(shortcut,callback,prevent,prepare,owner){if(typeof(prevent)==='function'){var tmp=prepare;prepare=prevent;prevent=tmp}var currentkeys=issession?keys_session:keys,ismac=M.ua.os.toLowerCase()==='mac';var special=ismac?'metaKey':'ctrlKey',specialindex=ismac?3:0;shortcut.split(',').trim().forEach(function(shortcut){var builder=[],alias=[],cachekey=[0,0,0,0,'-',0];shortcut.split('+').trim().forEach(function(item){var lower=item.toLowerCase();alias.push(lower);switch(lower){case'ctrl':cachekey[0]=1;break;case'alt':cachekey[1]=1;break;case'shift':cachekey[2]=1;break;case'win':case'meta':case'cmd':cachekey[3]=1;break}switch(lower){case'ctrl':case'alt':case'shift':builder.push('e.{0}Key'.format(lower));return;case'win':case'meta':case'cmd':builder.push('e.metaKey');return;case'ins':builder.push('e.keyCode===45');cachekey[5]=45;return;case'space':builder.push('e.keyCode===32');cachekey[5]=32;return;case'tab':builder.push('e.keyCode===9');cachekey[5]=9;return;case'esc':builder.push('e.keyCode===27');cachekey[5]=27;return;case'enter':builder.push('e.keyCode===13');cachekey[5]=13;return;case'backspace':builder.push('e.keyCode===8');cachekey[5]=8;break;case'del':case'delete':builder.push('e.keyCode===46');cachekey[5]=46;return;case'save':builder.push('(e.{0}&&e.keyCode===83)'.format(special));cachekey[specialindex]=1;cachekey[5]=83;return;case'remove':builder.push('((e.{0}&&e.keyCode===8)||e.keyCode===46)'.format(special));cachekey[5]=-1;return;case'clone':builder.push('(e.{0}&&e.keyCode===68)'.format(special));cachekey[specialindex]=1;cachekey[5]=68;return;case'selectall':builder.push('(e.{0}&&e.keyCode===65)'.format(special));cachekey[specialindex]=1;cachekey[5]=65;return;case'copy':builder.push('(e.{0}&&e.keyCode===67)'.format(special));cachekey[specialindex]=1;cachekey[5]=67;return;case'undo':builder.push('(e.{0}&&e.keyCode===90)'.format(special));cachekey[specialindex]=1;cachekey[5]=90;return;case'redo':builder.push('(e.{0}&&e.shiftKey&&e.keyCode===90)'.format(special));cachekey[specialindex]=1;cachekey[5]=90;return;case'refresh':builder.push('e.key===\'F5\'');cachekey[5]=116;return;case'up':builder.push('e.keyCode===38');cachekey[5]=38;return;case'down':builder.push('e.keyCode===40');cachekey[5]=40;return;case'right':builder.push('e.keyCode===39');cachekey[5]=39;return;case'left':builder.push('e.keyCode===37');cachekey[5]=37;return;case'f1':case'f2':case'f3':case'f4':case'f5':case'f6':case'f7':case'f8':case'f9':case'f10':case'f11':case'f12':var a=item.toUpperCase();builder.push('e.key===\'{0}\''.format(a));cachekey[4]=a;return;case'capslock':builder.push('e.which===20');cachekey[5]=20;return}var num=item.parseInt();if(num){builder.push('e.which==='+num);cachekey[5]=num}else{num=item.toUpperCase().charCodeAt(0);cachekey[5]=num;builder.push('e.keyCode==={0}'.format(num))}});items.push({shortcut:alias.join('+'),fn:new Function('e','return '+builder.join('&&')),callback:callback,prevent:prevent,owner:owner,prepare:prepare});length=items.length;var k;if(cachekey[5]===-1){cachekey[5]=8;cachekey[3]=1;k=cachekey.join('');currentkeys[k]=1;cachekey[3]=0;cachekey[5]=46}k=cachekey.join('');currentkeys[k]=1});if(!owner)self.refresh();return self}});

COMPONENT('tabmenu','class:selected;selector:li',function(self,config,cls){var old,oldtab;self.readonly();self.nocompile();self.make=function(){self.aclass(cls);self.event('click',config.selector,function(){if(!config.disabled){var el=$(this);if(!el.hclass(config.class)){var val=el.attrd('value');if(config.exec)self.EXEC(config.exec,val);else self.set(val)}}});var scr=self.find('script');if(scr.length){self.template=Tangular.compile(scr.html());scr.remove()}};self.configure=function(key,value){switch(key){case'disabled':self.tclass('ui-disabled',!!value);break;case'datasource':self.datasource(value,function(path,value){if(value instanceof Array){var builder=[];for(var i=0;i<value.length;i++)builder.push(self.template(value[i]));old=null;self.html(builder.join(''));self.refresh()}},true);break}};self.setter=function(value){if(old===value)return;oldtab&&oldtab.rclass(config.class);oldtab=self.find(config.selector+'[data-value="'+value+'"]').aclass(config.class);old=value}});

Thelpers.counter=function(value,decimals){if(decimals==null)decimals=0;if(value>999999)return(value/1000000).format(decimals)+' M';if(value>9999)return(value/1000).format(decimals)+' K';return value.format(decimals)};

Thelpers.filesize=function(value,decimals,type){return value?value.filesize(decimals,type):'...'};Number.prototype.filesize=function(decimals,type){if(typeof(decimals)==='string'){var tmp=type;type=decimals;decimals=tmp}var value,t=this;switch(type){case'bytes':value=t;break;case'KB':value=t/1024;break;case'MB':value=filesizehelper(t,2);break;case'GB':value=filesizehelper(t,3);break;case'TB':value=filesizehelper(t,4);break;default:type='bytes';value=t;if(value>1023){value=value/1024;type='KB'}if(value>1023){value=value/1024;type='MB'}if(value>1023){value=value/1024;type='GB'}if(value>1023){value=value/1024;type='TB'}break}type=' '+type;return(decimals===undefined?value.format(2).replace('.00',''):value.format(decimals))+type};function filesizehelper(number,count){while(count--){number=number/1024;if(number.toFixed(3)==='0.000')return 0}return number}

Thelpers.jsonformat=function(json,format){var reguid2=/"{14,}[a-z]{3}[01]{1}|^\d{9,14}[a-z]{2}[01]{1}a|"\d{4,18}[a-z]{2}\d{1}[01]{1}b|"[0-9a-f]{4,18}[a-z]{2}\d{1}[01]{1}c|"[0-9a-z]{4,18}[a-z]{2}\d{1}[01]{1}d/;if(typeof(json)==='object')json=JSON.stringify(json,null,'\t');else if(json.indexOf('\t')===-1)json=JSON.stringify(JSON.parse(json),null,'\t');json=json.replace(/<|>/g,function(text){return text==='<'?'&lt;':'&gt;'});return json.replace(/\t.*?:\s/g,function(text){return'<span class="json-key">'+text.encode()+'</span>'}).replace(/\/span>(false|true)/g,function(val){val=val.substring(6).encode();return'/span><span class="json-boolean json-'+val+'">'+val+'</span>'}).replace(/\/span>[\d.]+/g,function(val){return'/span><span class="json-number">'+val.substring(6).encode()+'</span>'}).replace(/\/span>"[\d-]+T[\d:.]+Z"/g,function(val){return'/span><span class="json-date">'+new Date(val.substring(7,val.length-1)).format(format||'yyyy-MM-dd HH:mm:ss')+'</span>'}).replace(/\/span>null/g,function(){return'/span><span class="json-null">null</span>'}).replace(/\/span>"#[a-f0-9]{6}"/gi,function(val){val=val.substring(7,val.length-1).encode();return'/span>"<span class="json-color" style="color:'+val+'">'+val+'</span>"'}).replace(reguid2,function(text){return'<span class="json-uid">'+text.encode()+'</span>'})};

COMPONENT('textarea','scrollbar:true',function(self,config,cls){var cls2='.'+cls,input,placeholder,content=null;self.nocompile&&self.nocompile();self.validate=function(value){if(config.disabled||!config.required||config.readonly)return true;if(value==null)value='';else value=value.toString();return value.length>0};self.configure=function(key,value,init){if(init)return;var redraw=false;switch(key){case'readonly':self.find('textarea').prop('readonly',value);break;case'disabled':self.tclass('ui-disabled',value);self.find('textarea').prop('disabled',value);self.reset();break;case'required':self.noValid(!value);!value&&self.state(1,1);self.tclass(cls+'-required',value);break;case'placeholder':placeholder.html(value||'');break;case'maxlength':input.prop('maxlength',value||1000);break;case'label':redraw=true;break;case'autofocus':input.focus();break;case'monospace':self.tclass(cls+'-monospace',value);break;case'icon':redraw=true;break;case'format':self.format=value;self.refresh();break;case'height':self.find('textarea').css('height',(value>0?value+'px':value));break}redraw&&setTimeout2('redraw'+self.id,function(){self.redraw();self.refresh()},100)};self.redraw=function(){var attrs=[],builder=[],placeholderelement='';self.tclass('ui-disabled',!!config.disabled);self.tclass(cls+'-monospace',!!config.monospace);self.tclass(cls+'-required',!!config.required);config.placeholder&&(placeholderelement='<div class="{0}-placeholder">{1}</div>'.format(cls,config.placeholder));config.maxlength&&attrs.attr('maxlength',config.maxlength);config.error&&attrs.attr('error');attrs.attr('data-jc-bind','');config.height&&attrs.attr('style','height:{0}px'.format(config.height));config.autofocus==='true'&&attrs.attr('autofocus');config.disabled&&attrs.attr('disabled');config.readonly&&attrs.attr('readonly');builder.push('{1}<textarea {0}></textarea>'.format(attrs.join(' '),placeholderelement));var label=config.label||content;if(!label.length){config.error&&builder.push('<div class="{0}-helper"><i class="ti ti-warning" aria-hidden="true"></i> {1}</div>'.format(cls,config.error));self.aclass(cls+' '+cls+'-container');self.html(builder.join(''))}else{var html=builder.join('');builder=[];builder.push('<div class="'+cls+'-label">');config.icon&&builder.push('<i class="ti ti-{0}"></i>'.format(config.icon));builder.push(label);builder.push(':</div><div class="{0}">{1}</div>'.format(cls,html));config.error&&builder.push('<div class="{0}-helper"><i class="ti ti-warning" aria-hidden="true"></i> {1}</div>'.format(cls,config.error));self.html(builder.join(''));self.rclass(cls);self.aclass(cls+'-container')}input=self.find('textarea');placeholder=self.find(cls2+'-placeholder');if(!config.scrollbar)self.aclass(cls+'-noscrollbar')};self.make=function(){content=self.html();self.type=config.type;self.format=config.format;self.redraw();self.event('click',cls2+'-placeholder',function(){if(!config.disabled){placeholder.aclass('hidden');input.focus()}});self.event('focus','textarea',function(){placeholder.aclass('hidden')});self.event('blur','textarea',function(){if(!self.get()&&config.placeholder)placeholder.rclass('hidden')})};self.state=function(type){if(!type)return;var invalid=config.required?self.isInvalid():false;if(invalid===self.$oldstate)return;self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid);config.error&&self.find(cls2+'-helper').tclass(cls+'-helper-show',invalid)};self.setter2=function(value){if(!config.placeholder)return;if(value)placeholder.aclass('hidden');else placeholder.rclass('hidden')}});

COMPONENT('textboxlist','maxlength:100;required:false;error:You reach the maximum limit;movable:false',function(self,config,cls){var container,content,empty={},skip=false,cempty=cls+'-empty',crequired='required',helper=null,cls2='.'+cls;self.setter=null;self.getter=null;self.nocompile&&self.nocompile();self.template=Tangular.compile(('<div class="{0}-item"><div>'+(config.movable?'<i class="ti ti-angle-up {0}-up"></i><i class="ti ti-angle-down {0}-down"></i>':'')+'<i class="ti ti-trash {0}-remove"></i></div><div><input type="text" maxlength="{{ max}}" placeholder="{{ placeholder}}"{{ if disabled}} disabled="disabled"{{ fi}} value="{{ value}}" /></div></div>').format(cls));self.configure=function(key,value,init,prev){if(init)return;var redraw=false;switch(key){case'disabled':self.tclass(crequired,value);self.find('input').prop('disabled',true);empty.disabled=value;self.reset();break;case'maxlength':empty.max=value;self.find('input').prop(key,value);break;case'placeholder':empty.placeholder=value;self.find('input').prop(key,value);break;case'label':redraw=true;break;case'icon':if(value&&prev)self.find('i').rclass().aclass(value);else redraw=true;break}if(redraw){skip=false;self.redraw();self.refresh()}};self.redraw=function(){var icon='',html=config.label||content;if(config.icon)icon='<i class="{0}"></i>'.format(self.faicon(config.icon));empty.value='';self.tclass(cls+'-movable',!!config.movable);self.html((html?('<div class="'+cls+'-label{2}">{1}{0}:</div>').format(html,icon,config.required?(' '+cls+'-required'):''):'')+('<div class="'+cls+'-items"></div>'+self.template(empty).replace('-item"','-item '+cls+'-base"')));container=self.find(cls2+'-items')};self.make=function(){empty.max=config.max;empty.placeholder=config.placeholder;empty.value='';empty.disabled=config.disabled;if(config.disabled)self.aclass('ui-disabled');content=self.html();self.aclass(cls);self.redraw();self.move=function(offset,el){var arr=self.get();var index=el.index();var tmp;if(offset===1){if(arr[index]==null||arr[index+1]==null)return}else{if(arr[index]==null||arr[index-1]==null)return}tmp=arr[index];arr[index]=arr[index+offset];arr[index+offset]=tmp;var items=self.find(cls2+'-item');items.eq(index).find('input').val(arr[index]);items.eq(index+offset).find('input').val(arr[index+offset]);UPD(self.path,2);self.change(true)};self.event('click',cls2+'-up',function(){self.move(-1,$(this).closest(cls2+'-item'))});self.event('click',cls2+'-down',function(){self.move(1,$(this).closest(cls2+'-item'))});self.event('click',cls2+'-remove',function(){if(config.disabled)return;var el=$(this);var parent=el.closest(cls2+'-item');var value=parent.find('input').val();var arr=self.get();helper!=null&&helper.remove();helper=null;parent.remove();var index=arr.indexOf(value);if(index===-1)return;arr.splice(index,1);self.tclass(cempty,!arr.length);self.tclass(crequired,config.required&&!arr.length);skip=true;SET(self.path,arr,2);self.change(true)});self.event('change keypress blur','input',function(e){if((e.type==='keypress'&&e.which!==13)||config.disabled)return;var el=$(this);var value=this.value.trim();if(!value)return;var arr=[],base=el.closest(cls2+'-base');var len=base.length>0;if(len&&e.type==='change')return;var raw=self.get();if(config.limit&&len&&raw.length>=config.limit){if(!helper){base.after(('<div class="'+cls+'-helper"><i class="ti ti-warning" aria-hidden="true"></i> {0}</div>').format(config.error));helper=container.closest(cls2).find(cls2+'-helper')}return}if(len){if(!raw||raw.indexOf(value)===-1)self.push(value);this.value='';self.change(true);return}skip=true;container.find('input').each(function(){var temp=this.value.trim();switch(config.type){case'lower':temp=temp.toLowerCase();break;case'upper':temp=temp.toUpperCase();break;case'number':temp=temp.parseInt();break;case'date':temp=temp.parseDate();break;case'a-z':temp=temp.toLowerCase().replace(/[^a-z]/g,'');break}if(arr.indexOf(temp)===-1)arr.push(temp);else skip=false});self.set(arr,2);self.change(true)})};self.setter=function(value){if(skip){skip=false;return}if(!value||!value.length){self.aclass(cempty);config.required&&self.aclass(crequired);container.empty();return}self.rclass(cempty);self.rclass(crequired);var builder=[];for(var i=0;i<value.length;i++){empty.value=value[i];builder.push(self.template(empty))}container.empty().append(builder.join(''))};self.validate=function(value,init){if(init)return true;var valid=!config.required,items=container.children();if(!value||!value.length)return valid;for(var i=0;i<value.length;i++){var item=value[i];!item&&(item='');switch(config.type){case'email':valid=item.isEmail();break;case'url':valid=item.isURL();break;case'currency':case'number':valid=item>0;break;case'date':valid=item instanceof Date&&!isNaN(item.getTime());break;default:valid=item.length>0;break}items.eq(i).tclass(cls+'-item-invalid',!valid)}return valid}});

COMPONENT('timepicker',function(self,config,cls){var cls2='.'+cls,bindedevents=false,timeout=0,is;self.readonly();self.singleton();self.nocompile&&self.nocompile();self.make=function(){self.aclass(cls+' hidden');self.append('<div class="{0}-hours"><i class="ti ti-chevron-up"></i><input type="text" maxlength="2" /><i class="ti ti-chevron-down"></i></div><div class="{0}-minutes"><i class="ti ti-chevron-up"></i><input type="text" maxlength="2" /><i class="ti ti-chevron-down"></i></div><div class="{0}-seconds hidden"><i class="ti ti-chevron-up"></i><input type="text" maxlength="2" /><i class="ti ti-chevron-down"></i></div><div class="{0}-ampm hidden"><i class="ti ti-chevron-up"></i><span>AM</span><i class="ti ti-chevron-down"></i></div>'.format(cls));var fn=function(e){if(is&&(e.type!=='keydown'||e.which===27))self.hide(1)};self.on('reflow',fn);self.on('scroll',fn);self.on('resize',fn);self.event('keydown','input',function(e){var code=e.which;if(code===38||code===40){e.preventDefault();$(this).parent().find('.ti-chevron-'+(code===38?'up':'down')).trigger('click');return}if(code===13||code===27){self.hide(1);return}if((code===9||code===8||code===37||code===39||code===27||(code>47&&code<58))){if(code>47||code===8)self.update()}else e.preventDefault()});self.event('click','i',function(){var el=$(this);var parent=el.parent();var cls=parent.attr('class');var up=el.hclass('ti-chevron-up');var type=cls.substring(cls.lastIndexOf('-')+1);var val;switch(type){case'hours':case'minutes':case'seconds':var input=parent.find('input');val=+input.val();if(up)val++;else val--;if(val<0){if(type==='hours')val=self.opt.ampm?12:23;else val=59}else{if(type==='hours'){if(self.opt.ampm){if(val>12)val=0}else if(val>23)val=0}else{if(val>59)val=0}}val=val.toString();input.val(self.opt.ampm?val:(val.length>1?val:('0'+val)));break;case'ampm':var span=self.find('span');val=span.text().toLowerCase();if(val==='am')val='PM';else val='AM';span.html(val);break}self.update()});self.update=function(){setTimeout2(self.ID,function(){var current=self.opt.current,h=+(self.find(cls2+'-hours input').val()||'0');var m=+(self.find(cls2+'-minutes input').val()||'0');var s=+(self.find(cls2+'-seconds input').val()||'0');var ampm=+self.find(cls2+'-ampm span').html().toLowerCase();if(!self.opt.seconds)s=0;if(ampm==='pm')h+=12;current.setHours(h);current.setMinutes(m);current.setSeconds(s);if(self.opt.callback)self.opt.callback(current);else if(self.opt.path)SET(self.opt.path,current)},500)};self.event('click',function(e){e.preventDefault();e.stopPropagation()});self.bindevents=function(){if(!bindedevents){bindedevents=true;$(document).on('click',fn);$(W).on('scroll',fn).on('keydown',fn)}};self.unbindevents=function(){if(bindedevents){bindedevents=false;$(document).off('click',fn);$(W).off('scroll',fn).off('keydown',fn)}}};self.show=self.toggle=function(opt){var el=opt.element;if(el instanceof jQuery)el=el[0];if(self.target===el){self.hide(0);return}var value=opt.value||opt.date||opt.time||NOW;if(typeof(value)==='string'){opt.path=value;value=GET(value)}var count=0;if(opt.ampm==null)opt.ampm=!!config.ampm;if(opt.seconds==null)opt.seconds=!!config.seconds;self.find(cls2+'-seconds').tclass('hidden',!opt.seconds);self.find(cls2+'-ampm').tclass('hidden',!opt.ampm);if(opt.seconds)count++;if(opt.ampm)count++;var ampm=opt.ampm;self.find(cls2+'-hours input').val(value.format(ampm?'!H':'HH'));self.find(cls2+'-minutes input').val(value.format(ampm?'m':'mm'));self.find(cls2+'-seconds input').val(value.format(ampm?'s':'ss'));self.find(cls2+'-ampm span').html(value.format('a').toUpperCase());opt.current=value;self.target=el;self.opt=opt;self.bindevents();el=$(el);var off=el.offset();if(opt.offsetX)off.left+=opt.offsetX;if(opt.offsetY)off.top+=opt.offsetY;off.top+=el.innerHeight()+12;self.element.css(off);self.rclass2(cls+'-').tclass(cls+'-'+count).rclass('hidden').aclass(cls+'-visible',100);clearTimeout(timeout);setTimeout(function(){is=true},500)};self.hide=function(sleep){if(!is){self.target=null;return}clearTimeout(timeout);timeout=setTimeout(function(){self.unbindevents();if(self.opt){self.opt.close&&self.opt.close();self.opt.close=null}self.rclass(cls+'-visible').aclass('hidden');self.target=null;is=false},sleep?sleep:100)}});

COMPONENT('togglebutton',function(self,config,cls){var icon;self.nocompile();self.validate=function(value){return(config.disabled||!config.required)?true:value===true};self.configure=function(key,value,init){switch(key){case'disabled':!init&&self.tclass('ui-disabled',value);break;case'icontrue':case'iconfalse':if(value.indexOf(' ')===-1)config[key]='ti ti-'+value;break}};self.make=function(){self.aclass(cls);self.append('<button><i></i></button>');icon=self.find('i');self.event('click',function(){if(!config.disabled){self.dirty(false);self.getter(!self.get())}})};self.setter=function(value){self.tclass(cls+'-selected',value===true);icon.rclass();if(value===true){if(config.icontrue)icon.aclass(config.icontrue)}else{if(config.iconfalse)icon.aclass(config.iconfalse)}};self.state=function(type){if(!type)return;var invalid=config.required?self.isInvalid():false;if(invalid===self.$oldstate)return;self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid)}});

COMPONENT('uibuilder','css:1',function(self,config,cls){self.make=function(){self.aclass(cls);config.url&&AJAX('GET '+config.url,self.load)};self.load=function(data){if(!data||data instanceof Array||typeof(data)!=='object')return;if(self.app){self.app.remove();self.app=null;config.app&&self.SEEX(config.app,null)}data.id=config.id||self.ID;UIBuilder.build(self.element,data,function(response){if(!config.css)response.css='';response.component=self;self.app=response;config.app&&self.SEEX(config.app,response)})};self.setter=function(value){if(value){if(typeof(value)==='string')AJAX('GET '+value,self.load);else self.load(value)}else if(self.app){self.app.remove();self.app=null;config.app&&self.SEEX(config.app,null)}}},['https://cdn.componentator.com/uibuilder.min@1.js']);

COMPONENT('validate','delay:100;flags:visible;changes:0;strictchanges:0',function(self,config,cls){var elements=null,def='button[name="submit"]',flags=null,tracked=false,reset=0,old,track,currentvalue;self.readonly();self.make=function(){elements=self.find(config.selector||def)};self.configure=function(key,value,init){switch(key){case'selector':if(!init)elements=self.find(value||def);break;case'flags':if(value){flags=value.split(',');for(var i=0;i<flags.length;i++)flags[i]='@'+flags[i]}else flags=null;break;case'track':track=value.split(',').trim();break}};var settracked=function(){tracked=0};var backup=null,current=null;self.setter=function(value,path,type){currentvalue=value;var is=path===self.path||path.length<self.path.length;if(config.changes){current=STRINGIFY(value,config.strictchanges!=true);if(is)backup=current;else is=backup===current}if(reset!==is){reset=is;self.tclass(cls+'-modified',!reset)}if((type===1||type===2)&&track&&track.length){for(var i=0;i<track.length;i++){if(path.indexOf(track[i])!==-1){tracked=1;return}}if(tracked===1){tracked=2;setTimeout(settracked,config.delay*3)}}};var check=function(){var path=self.path.replace(/\.\*$/,'');var disabled=tracked||config.validonly?!VALID(path,flags):DISABLED(path,flags);if(!disabled&&config.if)disabled=!EVALUATE(path,config.if);if(!disabled&&config.changes&&backup===current)disabled=true;if(disabled!==old){elements.prop('disabled',disabled);self.tclass(cls+'-ok',!disabled);self.tclass(cls+'-no',disabled);old=disabled;if(!old&&config.exec)self.SEEX(config.exec,currentvalue);config.output&&self.SEEX(config.output,!disabled)}};self.state=function(type,what){if(type===3||what===3){self.rclass(cls+'-modified');tracked=0;backup=current}setTimeout2(self.ID,check,config.delay)}});

COMPONENT('validation','delay:100;flags:visible;changes:0;strictchanges:0',function(self,config,cls){var elements=null,def='button[name="submit"]',flags=null,tracked=false,reset=0,old,track,currentvalue;self.readonly();self.make=function(){elements=self.find(config.selector||def)};self.configure=function(key,value,init){switch(key){case'selector':if(!init)elements=self.find(value||def);break;case'flags':if(value){flags=value.split(',');for(var i=0;i<flags.length;i++)flags[i]='@'+flags[i]}else flags=null;break;case'track':track=value.split(',').trim();break}};var settracked=function(){tracked=0};var backup=null,current=null;self.setter=function(value,path,type){currentvalue=value;var is=path===self.path||path.length<self.path.length;if(config.changes){current=STRINGIFY(value,config.strictchanges!=true);if(is)backup=current;else is=backup===current}if(reset!==is){reset=is;self.tclass(cls+'-modified',!reset)}if((type===1||type===2)&&track&&track.length){for(var i=0;i<track.length;i++){if(path.indexOf(track[i])!==-1){tracked=1;return}}if(tracked===1){tracked=2;setTimeout(settracked,config.delay*3)}}};var check=function(){var path=self.path.replace(/\.\*$/,'');var disabled=tracked||config.validonly?!VALID(path,flags):DISABLED(path,flags);if(!disabled&&config.if)disabled=!EVALUATE(path,config.if);if(!disabled&&config.changes&&backup===current)disabled=true;if(disabled!==old){elements.prop('disabled',disabled);self.tclass(cls+'-ok',!disabled);self.tclass(cls+'-no',disabled);old=disabled;if(!old&&config.exec)self.SEEX(config.exec,currentvalue);config.output&&self.SEEX(config.output,!disabled)}};self.state=function(type,what){if(type===3||what===3){self.rclass(cls+'-modified');tracked=0;backup=current}setTimeout2(self.ID,check,config.delay)}});

COMPONENT('viewbox','margin:0;scroll:true;delay:100;resizedelay:200;initdelay:250;scrollbar:1;visibleY:1;height:100;invisible:1',function(self,config,cls){var eld,elb,scrollbar,cls2='.'+cls,init=false,cache,scrolltoforce;self.readonly();self.init=function(){var resize=function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='viewbox'&&com.dom.offsetParent&&com.$ready&&!com.$removed)com.resizeforce()}};ON('resize2',function(){setTimeout2('viewboxresize',resize,200)})};self.destroy=function(){scrollbar&&scrollbar.destroy()};self.configure=function(key,value,init){switch(key){case'disabled':eld.tclass('hidden',!value);break;case'minheight':case'margin':case'marginxs':case'marginsm':case'marginmd':case'marginlg':!init&&self.resizeforce();break;case'selector':config.parent=value;self.resize();break}};self.scrollbottom=function(val){if(val==null)return elb[0].scrollTop;elb[0].scrollTop=(elb[0].scrollHeight-self.dom.clientHeight)-(val||0);return elb[0].scrollTop};self.scrolltop=function(val){if(val==null)return elb[0].scrollTop;elb[0].scrollTop=(val||0);return elb[0].scrollTop};self.make=function(){var centered='';if(config.centered)centered='<div><div class="{0}-centered-table"><div class="{0}-centered-cell"></div></div></div>'.format(cls);config.invisible&&self.aclass('invisible');config.scroll&&MAIN.version>17&&self.element.wrapInner('<div class="'+cls+'-body">'+centered+'</div>');self.element.prepend('<div class="'+cls+'-disabled hidden"></div>');eld=self.find('> .{0}-disabled'.format(cls)).eq(0);elb=self.find('> .{0}-body'.format(cls)).eq(0);self.aclass('{0} {0}-hidden'.format(cls));if(config.scroll){if(config.scrollbar){if(MAIN.version>17){scrollbar=W.SCROLLBAR(self.find(cls2+'-body'),{shadow:config.scrollbarshadow,visibleY:config.visibleY,visibleX:config.visibleX,orientation:config.visibleX?null:'y',parent:self.element});self.scrollbar=scrollbar;self.scrolltop=scrollbar.scrollTop;self.scrollbottom=scrollbar.scrollBottom}else self.aclass(cls+'-scroll')}else{self.aclass(cls+'-scroll');if(M.version<19)self.find(cls2+'-body').aclass('noscrollbar')}}self.resize()};self.released=function(is){!is&&self.resize()};var css={};self.resize=function(){setTimeout2(self.ID,self.resizeforce,config.resizedelay)};self.resizeforce=function(){var el=self.parent(config.parent);var h=el.height();var w=el.width();var width=WIDTH();var mywidth=self.element.width();var key=width+'x'+mywidth+'x'+w+'x'+h+'x'+config.margin;if(cache===key){scrollbar&&scrollbar.resize();if(scrolltoforce){if(scrolltoforce==='bottom')self.scrollbottom(0);else self.scrolltop(0);scrolltoforce=null}return}cache=key;var margin=config.margin,responsivemargin=config['margin'+width];if(responsivemargin!=null)margin=responsivemargin;if(margin==='auto')margin=self.element.offset().top;if(h===0||w===0){self.$waiting&&clearTimeout(self.$waiting);self.$waiting=setTimeout(self.resize,234);return}h=((h/100)*config.height)-margin;if(config.minheight&&h<config.minheight)h=config.minheight;if(config.centered)elb.find(cls2+'-centered-table').css('min-height',h);css.height=h;css.width=mywidth;eld.css(css);css.width='';self.css(css);elb.length&&elb.css(css);self.element.SETTER('*','resize');var c=cls+'-hidden';self.hclass(c)&&self.rclass(c,100);scrollbar&&scrollbar.resize();if(scrolltoforce){if(scrolltoforce==='bottom')self.scrollbottom(0);else self.scrolltop(0);scrolltoforce=null}if(!init){self.rclass('invisible',config.initdelay);init=true}};self.resizescrollbar=function(){scrollbar&&scrollbar.resize()};self.setter=function(){scrolltoforce=config.scrollto||config.scrolltop;if(scrolltoforce){if(scrolltoforce==='bottom')self.scrollbottom(0);else self.scrolltop(0);scrolltoforce=null}setTimeout(self.resize,config.delay,scrolltoforce)}});

COMPONENT('virtualwire','selector:.virtualwire;max:50;repeat:100',function(self,config,cls){var old,waiter,div;self.make=function(){div=document.createElement('DIV');div.style='position:absolute;left:-1000px;top:-1000px;z-index:-1;visibility:hidden';document.body.appendChild(div);self.aclass(cls)};self.destroy=function(){div.parentNode.removeChild(div);div=null};self.restore=function(){if(old){div.appendChild(old[0]);var exec=old.attrd('out');exec&&self.EXEC(exec);old=null}};self.backup=function(el){if(!el||!el.length){self.restore();return}if(old&&old[0]===el[0])return;self.restore();el.rclass('hidden invisible');self.dom.appendChild(el[0]);old=el;var exec=el.attrd('in');exec&&self.EXEC(exec)};self.load=function(value,count){waiter&&clearTimeout(waiter);waiter=null;if(count>config.max)return;var el=$(config.selector+'[data-if="'+value+'"],'+config.selector+'[data-scope="'+value+'"]');if(el.length)self.backup(el);else waiter=setTimeout(self.load,config.repeat,value,(count||0)+1)};self.setter=function(value){self.restore();if(value){waiter&&clearTimeout(waiter);self.load(value)}}});

COMPONENT('watcher','delay:0',function(self,config){var fn=NOOP,delay=null,datasource=null,exec=function(path,type){delay=null;fn.call(self,self.get(),path,type,self.element,self,datasource)};self.readonly();self.make=function(){var scr=self.find('scri'+'pt').eq(0);var js=scr.html();if(js){if(self.scope){js=js.replace(/\?(.|\/)+/g,function(val){return val.replace(/\?/g,self.scope.path)})}fn=new Function('value','path','type','element','component','datasource',js);scr.remove()}config.datasource&&self.datasource(config.datasource,function(path,value){datasource=value;if(config.delay){delay&&clearTimeout(delay);delay=setTimeout(exec,config.delay,'',-1)}else exec('',-1)})};self.destroy=function(){fn=null;datasource=null};self.setter=function(value,path,type){if(config.delay){delay&&clearTimeout(delay);delay=setTimeout(exec,config.delay,value,path,type)}else fn.call(self,value,path,type,self.element,self,datasource)}});

COMPONENT('websocket','reconnect:3000;encoder:false',function(self,config){var ws,url,queue=[],sending=false,isidle=false;self.online=false;self.readonly();self.nocompile&&self.nocompile();self.make=function(){url=(config.url||'').env(true);if(!url.match(/^(ws|wss):\/\//))url=location.origin.replace('http','ws')+(url.charAt(0)!=='/'?'/':'')+url;setTimeout(self.connect,500);self.destroy=function(){isidle=true;self.close()}};self.send=function(obj){var data=JSON.stringify(obj);if(config.encoder)queue.push(encodeURIComponent(data));else queue.push(data);self.process();return self};self.idletime=function(is){if(isidle!==is){isidle=is;if(is){ws&&self.close()}else{if(!ws)self.connect()}}};self.process=function(callback){if(!ws||!ws.send||sending||!queue.length||ws.readyState!==1){callback&&callback();return}sending=true;var async=queue.splice(0,3);async.wait(function(item,next){if(ws){ws.send(item);setTimeout(next,5)}else{queue.unshift(item);next()}},function(){callback&&callback();sending=false;queue.length&&self.process()})};self.close=function(isClosed){if(ws){self.online=false;ws.onopen=ws.onclose=ws.onmessage=null;!isClosed&&ws.close();ws=null;EMIT('online',false)}return self};function onClose(e){if(e.code===4001){location.href=location.href+'';return}e.reason&&WARN('WebSocket:',config.encoder?decodeURIComponent(e.reason):e.reason);self.close(true);if(!isidle)setTimeout(self.connect,config.reconnect)}function onMessage(e){var data;try{data=PARSE(config.encoder?decodeURIComponent(e.data):e.data);self.path&&self.set(data)}catch(e){WARN('WebSocket "{0}": {1}'.format(url,e.toString()))}data&&EMIT('message',data)}function onOpen(){self.online=true;self.process(function(){EMIT('online',true)})}self.connect=function(){ws&&self.close();setTimeout2(self.id,function(){ws=new WebSocket(url.env(true));ws.onopen=onOpen;ws.onclose=onClose;ws.onmessage=onMessage;self.ws=ws},100);return self}});

COMPONENT('windows','menuicon:ti ti-navicon;reoffsetresize:0;zindex:5',function(self,config,cls){var cls2='.'+cls,cache={},services=[],events={},drag={},prevfocused,serviceid,data=[],lastWW=WW,lastWH=WH,resizer,position=[];self.make=function(){self.aclass(cls);self.append('<div class="{0}-resizer hidden"></div>'.format(cls));resizer=self.find(cls2+'-resizer');self.event('click',cls2+'-control',function(){var el=$(this);var name=el.attrd('name');var item=cache[el.closest(cls2+'-item').attrd('id')];switch(name){case'close':item.setcommand('close');break;case'minimize':item.setcommand('toggleminimize');break;case'maximize':item.setcommand('togglemaximize');break;case'menu':item.meta.menu&&item.meta.menu.call(item,el);break;default:item.setcommand(name);break}});self.event('mousedown touchstart',cls2+'-item',function(){if(prevfocused){if(prevfocused[0]==this)return;prevfocused.rclass(cls+'-focused')}var el=$(this);var id=el.attrd('id');prevfocused=el.aclass(cls+'-focused');var meta=cache[id];if(meta&&meta.meta.focus)meta.meta.focus();var index=position.indexOf(meta);position.push(position.splice(index,1)[0]);self.reorder()});self.event('mousedown touchstart',cls2+'-title,'+cls2+'-resize',events.down);self.on('resize2',self.resize2);serviceid=setInterval(events.service,5000)};self.finditem=function(id){return cache[id]};self.send=function(type,body){for(var i=0;i<data.length;i++)data[i].meta.data(type,body,data[i].element)};self.destroy=function(){clearInterval(serviceid)};self.resize2=function(){setTimeout2(self.ID,self.resize,200)};self.recompile=function(){setTimeout2(self.ID+'compile',COMPILE,50)};self.resizeforce=function(){self.element.find(cls2+'-maximized').each(function(){cache[$(this).attrd('id')].setcommand('maximize')});if(config.reoffsetresize){var diffWW=lastWW-WW,diffWH=lastWH-WH,keys=Object.keys(cache);for(var i=0;i<keys.length;i++){var win=cache[keys[i]];win.setoffset(win.x-diffWW,win.y-diffWH)}lastWW=WW;lastWH=WH}};self.resize=function(){setTimeout2(self.ID+'resize',self.resizeforce,300)};events.service=function(){for(var i=0;i<services.length;i++){var tmp=services[i];if(tmp.$service)tmp.$service++;else tmp.$service=1;tmp.meta.service&&tmp.meta.service.call(tmp,tmp.$service,tmp.element)}};events.down=function(e){var E=e;if(e.type==='touchstart'){drag.touch=true;e=e.touches[0]}else drag.touch=false;if(e.target.nodeName==='I')return;var el=$(this);var parent=el.closest(cls2+'-item');if(parent.hclass(cls+'-maximized'))return;drag.resize=el.hclass(cls+'-resize');drag.is=false;E.preventDefault();$('body').aclass(cls+'-prevent');self.aclass(cls+'-moving');var myoffset=self.element.position();var pos;if(drag.resize){var c=el.attr('class');drag.el=el.closest(cls2+'-item');drag.dir=c.match(/-(tl|tr|bl|br)/)[0].substring(1);pos=drag.el.position();var m=self.element.offset();drag.body=drag.el.find(cls2+'-body');drag.plus=m;drag.x=pos.left;drag.y=pos.top;drag.width=drag.el.width();drag.title=drag.el.find(cls2+'-title').height();drag.height=drag.body.height()+drag.title+2;resizer.css({left:drag.x,top:drag.y,width:drag.width,height:drag.height}).rclass('hidden')}else{drag.el=el.closest(cls2+'-item');pos=drag.el.position();drag.x=e.pageX-pos.left;drag.y=e.pageY-pos.top}$('body').aclass(cls+'-block');drag.offX=myoffset.left;drag.offY=myoffset.top;drag.item=cache[drag.el.attrd('id')];if(drag.item.meta.actions){if(drag.resize){if(drag.item.meta.actions.resize==false)return;drag.resize=true}else{if(drag.item.meta.actions.move==false)return}}drag.el.aclass(cls+'-dragged');$(W).on('mousemove touchmove',events.move).on('mouseup touchend',events.up)};events.move=function(e){var evt=e;if(drag.touch)evt=e.touches[0];var obj={};drag.is=true;if(drag.resize){var x=evt.pageX-drag.offX-drag.plus.left,y=evt.pageY-drag.offY-drag.plus.top,off=drag.item.meta.offset,w,h;switch(drag.dir){case'tl':obj.left=x;obj.top=y;w=drag.width-(x-drag.x);h=drag.height-(y-drag.y);if((off.minwidth&&w<off.minwidth)||(off.minheight&&h<off.minheight)||(off.maxwidth&&w>off.maxwidth)||(off.maxheight&&h>off.maxheight))break;if(drag.resize===true||drag.resize==='width'){obj.width=w;resizer.css(obj)}if(drag.resize===true||drag.resize==='height'){obj.height=h;delete obj.width;delete obj.top;resizer.css(obj)}break;case'tr':w=x-drag.x;h=drag.height-(y-drag.y);if((off.minwidth&&w<off.minwidth)||(off.minheight&&h<off.minheight)||(off.maxwidth&&w>off.maxwidth)||(off.maxheight&&h>off.maxheight))break;if(drag.resize===true||drag.resize==='width'){obj.width=w;obj.top=y;resizer.css(obj)}if(drag.resize===true||drag.resize==='height'){obj.height=h;delete obj.width;delete obj.top;resizer.css(obj)}break;case'bl':w=drag.width-(x-drag.x);h=y-drag.y;if((off.minwidth&&w<off.minwidth)||(off.minheight&&h<off.minheight)||(off.maxwidth&&w>off.maxwidth)||(off.maxheight&&h>off.maxheight))break;if(drag.resize===true||drag.resize==='width'){obj.left=x;obj.width=w;resizer.css(obj);delete obj.width}if(drag.resize===true||drag.resize==='height'){obj.height=h;resizer.css(obj)}break;case'br':w=x-drag.x;h=y-drag.y;if((off.minwidth&&w<off.minwidth)||(off.minheight&&h<off.minheight)||(off.maxwidth&&w>off.maxwidth)||(off.maxheight&&h>off.maxheight))break;if(drag.resize===true||drag.resize==='width'){obj.width=w;resizer.css(obj);delete obj.width}if(drag.resize===true||drag.resize==='height'){obj.height=h;resizer.css(obj)}break}drag.item.ert&&clearTimeout(drag.item.ert);drag.item.ert=setTimeout(drag.item.emitresize,100)}else{obj.left=evt.pageX-drag.x-drag.offX;obj.top=evt.pageY-drag.y-drag.offY;if(obj.top<0)obj.top=0;drag.el.css(obj)}if(!drag.touch)e.preventDefault()};events.up=function(){self.rclass(cls+'-moving');drag.el.rclass(cls+'-dragged');$('body').rclass(cls+'-block');$(W).off('mousemove touchmove',events.move).off('mouseup touchend',events.up);resizer.aclass('hidden',1);if(!drag.is)return;var item=drag.item,meta=item.meta,pos=drag.resize?resizer.position():drag.el.position();drag.is=false;drag.x=meta.offset.x=item.x=pos.left;drag.y=meta.offset.y=item.y=pos.top;if(drag.resize){item.width=meta.offset.width=resizer.width();item.height=meta.offset.height=resizer.height()-drag.title;drag.el.css({left:drag.x,top:drag.y,width:item.width});drag.body.css({height:item.height});meta.resize&&meta.resize.call(item,item.width,item.height,drag.body,item.x,item.y);self.element.SETTER('*','resize')}meta.move&&meta.move.call(item,item.x,item.y,drag.body);self.wsave(item);self.change(true)};var wsavecallback=function(item){var key='win_'+item.meta.cachekey,obj={};obj.x=item.x;obj.y=item.y;obj.width=item.width;obj.height=item.height;obj.ww=WW;obj.wh=WH;obj.hidden=item.meta.hidden;PREF.set(key,obj,'1 month')};self.wsave=function(obj){if(obj.meta.actions&&obj.meta.actions.autosave)setTimeout2(self.ID+'_win_'+obj.meta.cachekey,wsavecallback,500,null,obj)};self.reorder=function(){for(var index=0;index<position.length;index++)position[index].container.css('z-index',config.zindex+index)};self.wadd=function(item){var hidden='',ishidden=false;if(!item.cachekey)item.cachekey=item.id;if(item.cachekey)item.cachekey+=''+item.offset.width+'x'+item.offset.height;if(item.actions&&item.actions.autosave){pos=PREF['win_'+item.cachekey];if(pos){var mx=0,my=0,keys=Object.keys(cache);var plus=0;for(var i=0;i<keys.length;i++){if(cache[keys[i]].meta.cachekey===item.cachekey)plus+=50}if(config.reoffsetresize&&pos.ww!=null&&pos.wh!=null){mx=pos.ww-WW;my=pos.wh-WH}item.offset.x=(pos.x-mx)+plus;item.offset.y=(pos.y-my)+plus;item.offset.width=pos.width;item.offset.height=pos.height;if(pos.hidden&&(item.hidden==null||item.hidden)){ishidden=true;item.hidden=true}}}if(!ishidden)ishidden=item.hidden;hidden=ishidden?' hidden':'';var el=$('<div class="{0}-item{2}" data-id="{id}" style="left:{x}px;top:{y}px;width:{width}px"><span class="{0}-resize {0}-resize-tl"></span><span class="{0}-resize {0}-resize-tr"></span><span class="{0}-resize {0}-resize-bl"></span><span class="{0}-resize {0}-resize-br"></span><div class="{0}-title"><i class="ti ti-times {0}-control" data-name="close"></i><i class="ti ti-maximize {0}-control" data-name="maximize"></i><i class="ti ti-underscore {0}-control" data-name="minimize"></i><i class="{1} {0}-control {0}-lastbutton" data-name="menu"></i><span>{{ title}}</span></div><div class="{0}-body" style="height:{height}px"></div></div>'.format(cls,config.menuicon,hidden).arg(item.offset).arg(item));var body=el.find(cls2+'-body');var pos;body.append(item.html);if(typeof(item.html)==='string'&&item.html.COMPILABLE())self.recompile();if(item.actions){if(item.actions.resize==false)el.aclass(cls+'-noresize');if(item.actions.move==false)el.aclass(cls+'-nomove');var noclose=item.actions.close==false;if(item.actions.hide)noclose=false;if(noclose)el.aclass(cls+'-noclose');if(item.actions.maximize==false)el.aclass(cls+'-nomaximize');if(item.actions.minimize==false)el.aclass(cls+'-nominimize');if(!item.actions.menu)el.aclass(cls+'-nomenu')}var obj=cache[item.id]={};obj.main=self;obj.meta=item;obj.element=body;obj.container=el;obj.x=item.offset.x;obj.y=item.offset.y;obj.width=item.offset.width;obj.height=item.offset.height;item.element=el;if(item.buttons){var builder=[];for(var i=0;i<item.buttons.length;i++){var btn=item.buttons[i],icon=self.faicon(btn.icon);builder.push('<i class="ti ti-{1} {0}-control" data-name="{2}"></i>'.format(cls,icon,btn.name))}builder.length&&el.find(cls2+'-lastbutton').before(builder.join(''))}item.make&&item.make.call(cache[item.id],body);obj.emitresize=function(){obj.ert=null;obj.element.SETTER('*','resize')};obj.setsize=function(w,h){var t=this,obj={};if(w){obj.width=t.width=t.meta.offset.width=w;t.element.parent().css('width',w)}if(h){t.element.css('height',h);t.height=t.meta.offset.height=h}t.ert&&clearTimeout(t.ert);t.ert=setTimeout(t.emitresize,100);self.wsave(t)};obj.setcommand=function(type){var el=obj.element.parent();var c;switch(type){case'toggle':obj.setcommand(obj.meta.hidden?'show':'hide');break;case'show':if(obj.meta.hidden){obj.meta.hidden=false;obj.element.parent().rclass('hidden');self.wsave(obj);self.resize2()}break;case'close':case'hide':if(type==='hide'&&obj.meta.hidden)return;if(obj.meta.close){obj.meta.close(function(){self.wrem(obj.meta,true);self.resize2()})}else{self.wrem(obj.meta,true);self.resize2()}break;case'maximize':if(obj.meta.maximize){obj.meta.maximize()}else{c=cls+'-maximized';if(!el.hclass(c)){obj.prevwidth=obj.width;obj.prevheight=obj.height;obj.prevx=obj.x;obj.prevy=obj.y;el.aclass(c);obj.setcommand('resetminimize')}var ww=self.element.width()||WW;var wh=self.element.height()||WH;obj.setoffset(0,0);obj.setsize(ww,wh-obj.element.position().top)}break;case'resetmaximize':if(obj.meta.maximize){obj.meta.maximize('reset')}else{c=cls+'-maximized';if(el.hclass(c)){obj.setoffset(obj.prevx,obj.prevy);obj.setsize(obj.prevwidth,obj.prevheight);el.rclass(c)}}break;case'togglemaximize':if(obj.meta.maximize){obj.meta.maximize('toggle')}else{c=cls+'-maximized';obj.setcommand(el.hclass(c)?'resetmaximize':'maximize')}break;case'minimize':if(obj.meta.minimize){obj.meta.minimize()}else{c=cls+'-minimized';if(!el.hclass(c))el.aclass(c)}break;case'resetminimize':if(obj.meta.minimize){obj.meta.minimize('reset')}else{c=cls+'-minimized';el.hclass(c)&&el.rclass(c)}break;case'toggleminimize':if(obj.meta.minimize){obj.meta.minimize('toggle')}else{c=cls+'-minimized';obj.setcommand(el.hclass(c)?'resetminimize':'minimize')}break;case'resize':obj.setsize(obj.width,obj.height);break;case'move':obj.setoffset(obj.x,obj.y);break;case'focus':obj.setcommand('resetminimize');prevfocused&&prevfocused.rclass(cls+'-focused');prevfocused=obj.element.parent().aclass(cls+'-focused');if(obj.meta.focus)obj.meta.focus();var index=position.indexOf(obj);var item=position.splice(index,1)[0];position.push(item);self.reorder();break;default:if(obj.meta.buttons){var btn=obj.meta.buttons.findItem('name',type);if(btn&&btn.exec)btn.exec.call(obj,obj)}break}};obj.setoffset=function(x,y){var t=this,obj={};if(x!=null)obj.left=t.x=t.meta.offset.x=x;if(y!=null)obj.top=t.y=t.meta.offset.y=y;t.element.parent().css(obj);self.wsave(t)};obj.meta.service&&services.push(obj);obj.meta.data&&data.push(obj);self.append(el);position.push(obj);setTimeout(function(obj){obj.setcommand('focus')},100,obj);return obj};self.wrem=function(item,notify){var obj=cache[item.id];if(obj){var main=obj.element.closest(cls2+'-item');if(obj.meta.actions.hide){obj.meta.hidden=true;main.aclass('hidden');self.wsave(obj)}else{var index=position.indexOf(obj);if(index!==-1)position.splice(index,1);obj.meta.destroy&&obj.meta.destroy.call(obj);main.off('*');main.find('*').off('*');main.remove();delete cache[item.id];var index=services.indexOf(obj);if(index!==-1)services.splice(index,1);index=data.indexOf(obj);if(index!==-1)data.splice(index,1);var arr=self.get();arr.splice(arr.findIndex('id',item.id),1);notify&&self.update()}}};self.setter=function(value){if(!value)value=EMPTYARRAY;var updated={};for(var i=0;i<value.length;i++){var item=value[i];if(!cache[item.id])cache[item.id]=self.wadd(item);updated[item.id]=1}var keys=Object.keys(cache);for(var i=0;i<keys.length;i++){var key=keys[i];if(!updated[key])self.wrem(cache[key].meta)}};self.toggle=function(id){var item=cache[id];item&&item.setcommand('toggle')};self.show=function(id){var item=cache[id];item&&item.setcommand('show')};self.focus=function(id){var item=cache[id];item&&item.setcommand('focus')};self.hide=function(id){var item=cache[id];item&&item.setcommand('hide')};self.close=function(id){var item=cache[id];item&&item.setcommand('close')}});

COMPONENT('wysiwyg','required:0;links:false;ul:true;code:true;ul:true',function(self,config,cls){var cls2='.'+cls,timers={},buttons={},D=document,skip=false,placeholder,editor;function selectall(el){var doc=W.document,sel,range;if(W.getSelection&&doc.createRange){sel=W.getSelection();range=doc.createRange();range.selectNodeContents(el);sel.removeAllRanges();sel.addRange(range)}else if(doc.body.createTextRange){range=doc.body.createTextRange();range.moveToElementText(el);range.select()}}var findparent=function(node){while(node){if(node===editor[0])return;if(node.parentNode===editor[0])return node;node=node.parentNode}};var check=function(node,tag){while(node){if(node===editor[0])return;if(node.tagName===tag)return node;node=node.parentNode}};var clean=function(node){var tag=D.createTextNode($(node).text());editor[0].replaceChild(tag,node);selectall(tag)};self.validate=function(value){if(!config.required)return true;var type=typeof(value);if(type==='undefined'||type==='object')value='';else value=value.toString();EMIT('reflow',self.name);return value.length>0};self.make=function(){self.aclass(cls);self.attr('wysiwyg','true');var buttons=[];buttons.push('<button name="bold"><i class="ti ti-bold"></i></button><button name="italic"><i class="ti ti-italic"></i></button><button name="underline"><i class="ti ti-underline"></i></button></button>');if(config.ul)buttons.push('<button name="ul"><i class="ti ti-list"></i></button>');if(config.code)buttons.push('<button name="code"><i class="ti ti-highlighter"></i></button>');if(config.links)buttons.push('<button name="link"><i class="ti ti-link"></i></button>');self.append('<div class="{0}-toolbar">{2}</div><div class="{0}-placeholder">{1}</div><div class="{0}-body" contenteditable="true"></div>'.format(cls,config.placeholder,buttons.join('')));editor=self.find(cls2+'-body');placeholder=self.find(cls2+'-placeholder');placeholder.on('click',function(){placeholder.aclass('hidden');editor.focus()});self.find('button').on('click',function(){editor.focus();switch(this.name){case'bold':D.execCommand('Bold',false,null);break;case'italic':D.execCommand('Italic',false,null);break;case'underline':D.execCommand('Underline',false,null);break;case'ul':var node=self.getNode();var selection=self.getSelection();D.execCommand('insertHtml',false,'<ul><li>{0}</li></ul>'.format((node===editor[0]?selection:node.innerHTML)||''));break;case'mark':var node=self.getNode();var tag=check(node,'SPAN');if(tag){clean(tag)}else{var selection=self.getSelection();selection&&D.execCommand('insertHtml',false,'<span class="marked">{0}</span>'.format(node===editor[0]?selection:node.innerHTML))}break;case'code':var node=self.getNode();var tag=check(node,'CODE');if(tag){clean(tag)}else{var selection=self.getSelection();selection&&D.execCommand('insertHtml',false,'<code>{0}</code>'.format(node===editor[0]?selection:node.innerHTML))}break;case'clean':var selection=self.getSelection();if(selection){node=self.getSelection(true)}else{node=findparent(self.getNode());node&&clean(node)}break;case'link':var node=self.getNode();var tag=check(node,'A');if(tag){clean(tag)}else{var id='#URL'+Date.now();var html=self.getSelection();if(html){D.execCommand('CreateLink',false,id);var a=self.find('a[href="{0}"]'.format(id)).attr('target','_blank').attr('href',html);self.event('link',a)}}break}}).each(function(){buttons[this.name]=this});var el=self.element;el.on('selectstart',function(){clearTimeout(timers.selection);timers.selection=setTimeout(function(){self.event('select',self.getSelection())},500)});editor.on('focus',function(){clearTimeout(timers.focused);clearInterval(timers.changes);timers.changes=null;self.focused=true;self.event('focus',self);placeholder.aclass('hidden')});self.save=function(){skip=true;self.getter(editor.html())};editor.on('click',function(e){e.target&&self.event('click',e.target)});editor.on('blur',function(){var t=editor.text().trim();placeholder.tclass('hidden',!!t||editor.find('li').length>0);clearTimeout(timers.focused);clearInterval(timers.changes);timers.changes=null;self.save();timers.focused=setTimeout(function(){self.event('blur',self)},200)});editor.on('paste',function(e){e.preventDefault();e.stopPropagation();var text=e.originalEvent.clipboardData.getData(self.attrd('clipboard')||'text/plain');self.event('paste',text)});editor.on('keydown',function(e){if(!timers.changes)timers.changes=setInterval(self.save,1000);if(!e.metaKey&&!e.ctrlKey)return;if(e.which===66){D.execCommand('Bold',false,null);e.preventDefault();e.stopPropagation();return}if(e.which===76){e.preventDefault();e.stopPropagation();var html=self.getSelection();if(html){var id='#URL'+Date.now();D.execCommand('CreateLink',false,id);var a=self.find('a[href="{0}"]'.format(id)).attr('target','_blank').attr('href',html);self.event('link',a)}return}if(e.which===73){D.execCommand('Italic',false,null);e.preventDefault();e.stopPropagation();return}if(e.which===85){D.execCommand('Underline',false,null);e.preventDefault();e.stopPropagation();return}});var notify=function(e){timers.notify=null;self.event('cursor',e.target)};el.on('keydown',function(e){timers.notify&&clearTimeout(timers.notify);timers.notify=setTimeout(notify,100,e)})};self.exec=function(){D.execCommand.apply(D,arguments);return self};self.insert=function(value,encoded){D.execCommand(encoded?'insertText':'insertHtml',false,value);return self};var loadformat=function(){var node=self.getNode();var toolbar={};while(node){if(node===editor[0])return toolbar;switch(node.tagName){case'B':toolbar.bold=1;break;case'I':toolbar.italic=1;break;case'A':toolbar.link=1;break;case'SPAN':toolbar.mark=1;break;case'CODE':toolbar.code=1;break;case'S':toolbar.strike=1;break;case'U':toolbar.underline=1;break}node=node.parentNode}return toolbar};self.event=function(type,value){if(type==='click'||type==='cursor'){var format=loadformat();var keys=Object.keys(buttons);for(var i=0;i<keys.length;i++){var key=keys[i],btn=buttons[key],is=format[key]===1;if(btn.prevstate!==is){if(is)btn.classList.add('selected');else btn.classList.remove('selected');btn.prevstate=is}}}if(type==='paste')self.insert(value,true)};self.getNode=function(){var node=D.getSelection().anchorNode;if(node)return(node.nodeType===3?node.parentNode:node)};self.getSelection=function(node){if(D.selection&&D.selection.type==='Text')return D.selection.createRange().htmlText;else if(!W.getSelection)return;var sel=W.getSelection();if(!sel.rangeCount)return'';var container=D.createElement('div');for(var i=0,len=sel.rangeCount;i<len;++i)container.appendChild(sel.getRangeAt(i).cloneContents());return node?container:container.innerHTML};self.focus=function(){editor.focus()};self.setter=function(value,path,type){if(skip&&type===2){skip=false;return}var val=value?(value+'').trim():'';self.reset();editor.html(val);placeholder.tclass('hidden',!!val)};self.state=function(type){if(!type)return;var invalid=self.isInvalid();if(invalid!==self.$oldstate){self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid)}}});